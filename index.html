<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NamChaOS - Modern Web Operating System</title>

    <style>
        /* Line 1: CSS Reset and Box Sizing */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Line 10: CSS Custom Properties (Variables) */
        :root {
            --primary-blue: #00AAFF;
            --secondary-blue: #AAC3FA;
            --background-light: #F1F1F7;
            --background-dark: #000000;
            --surface-light: #FFFFFF;
            --surface-dark: #1C1E2E; /* Changed for better contrast */
            --text-primary: #000000;
            --text-secondary: #8E8E93;

            /* Liquid Glass Effects */
            --glass-bg: rgba(255, 255, 255, 0.12);        /* base transparency for frosted effect */
            --glass-border: rgba(255, 255, 255, 0.25);    /* subtle glossy border */
            --liquid-glass: rgba(255, 255, 255, 0.12);    /* main glass color */
            --liquid-glass-hover: rgba(255, 255, 255, 0.18); /* slightly brighter on hover */
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.08); /* soft shadow for depth */
            --glass-blur: 18px;                            /* frosted blur for true glass effect */

            --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.04);
            --shadow-heavy: 0 8px 40px rgba(0, 0, 0, 0.08);

            --border-radius: 20px;
            --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);

            --user-background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --username: 'User';
        }

        /* Line 35: Body Styling */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
            background: var(--background-dark);
            user-select: none;
            color: var(--text-primary);
            height: 100vh;
            width: 100vw;
            -webkit-font-smoothing: antialiased;
        }

        /* Line 46: Device-specific CSS Variables */
        .device-phone {
            --app-icon-size: 60px;
            --dock-height: 75px;
            --status-bar-height: 44px;
        }

        .device-tablet {
            --app-icon-size: 80px;
            --dock-height: 85px;
            --status-bar-height: 50px;
        }

        .device-desktop {
            --app-icon-size: 48px;
            --dock-height: 50px;
            --status-bar-height: 28px;
        }

        /* Line 64: Boot Screen Styling */
        .boot-screen {
            background: linear-gradient(135deg, #007AFF 0%, #5AC8FA 100%);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
            position: relative;
        }

        /* Line 75: Boot Logo Animation */
        .boot-logo {
            font-size: clamp(3rem, 8vw, 6rem);
            font-weight: 200;
            margin-bottom: 3rem;
            animation: fadeInUp 1.5s ease-out;
            letter-spacing: -0.02em;
        }

        /* Line 84: Boot Spinner Animation */
        .boot-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }

        /* Line 95: Boot Text Styling */
        .boot-text {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        /* Line 102: Installation Screen Styling */
        .install-screen {
            background: linear-gradient(135deg, #007AFF 0%, #5AC8FA 100%);
            color: white;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        /* Line 114: Installation Container with Glass Effect */
        .install-container {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            padding: 3rem;
            max-width: 500px;
            width: 100%;
            text-align: center;
            box-shadow: var(--shadow-heavy);
        }

        /* Line 126: Installation Title Styling */
        .install-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 300;
            color: var(--text-primary);
        }

        /* Line 134: Installation Subtitle Styling */
        .install-subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.8;
            color: var(--text-secondary);
        }

        /* Line 142: Progress Bar Styling */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 2rem 0;
        }

        /* Line 152: Progress Fill Animation */
        .progress-fill {
            height: 100%;
            background: var(--primary-blue);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Line 160: Installation Button Styling */
        .install-button {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
        }

        /* Line 173: Installation Button Hover Effect */
        .install-button:hover {
            background: #0056CC;
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
        }

        /* Line 180: Desktop Layout */
        .desktop {
            height: 100vh;
            width: 100vw;
            background: var(--user-background);
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Line 190: Status Bar with Glass Effect */
        .status-bar {
            height: var(--status-bar-height);
            background: var(--liquid-glass);
            backdrop-filter: blur(30px) saturate(200%);
            -webkit-backdrop-filter: blur(30px) saturate(200%);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 1rem;
            color: white;
            font-size: 0.85rem;
            font-weight: 500;
            z-index: 1000;
            border-bottom: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
        }

        /* Line 207: Status Bar Left Section */
        .status-left {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Line 214: Status Bar Right Section */
        .status-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Line 221: Desktop Content Area */
        .desktop-content {
            flex: 1;
            position: relative;
            padding: 2rem;
            padding-bottom: calc(var(--dock-height) + 2rem);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Line 231: Home Screen Grid Layout */
        .home-screen {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 1.5rem;
            padding: 2rem;
            padding-bottom: calc(var(--dock-height) + 2rem);
            max-width: 100%;
            width: 100%;
            height: calc(100vh - var(--status-bar-height));
            align-content: start;
            justify-items: center;
            position: relative;
        }

        /* Line 246: App Icon Styling with Glass Effect */
        .app-icon {
            width: 70px;
            height: 70px;
            background: var(--liquid-glass);
            backdrop-filter: blur(20px) saturate(200%);
            -webkit-backdrop-filter: blur(20px) saturate(200%);
            border-radius: 18px;
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            cursor: grab;
            transition: var(--transition);
            box-shadow: var(--glass-shadow);
            position: relative;
            user-select: none;
            -webkit-user-select: none;
        }

        /* Line 265: App Icon Dragging State */
        .app-icon.dragging {
            cursor: grabbing;
            z-index: 1000;
            transform: scale(1.1);
            opacity: 0.8;
            position: fixed;
            pointer-events: none;
        }

        .app-icon.drag-placeholder {
            opacity: 0.3;
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.5);
        }

        .drop-zone {
            background: rgba(0, 170, 255, 0.2);
            border: 2px solid var(--primary-blue);
            border-radius: 18px;
        }

        /* Line 273: App Icon Hover Effect */
        .app-icon:hover {
            transform: scale(1.05) translateY(-2px);
            background: var(--liquid-glass-hover);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
        }

        /* Line 280: App Icon Active State */
        .app-icon:active {
            transform: scale(0.98);
        }

        /* Line 285: App Label Styling */
        .app-label {
            position: absolute;
            bottom: -2rem;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: white;
            text-align: center;
            white-space: nowrap;
            font-weight: 500;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        
        /* Line 298: Dock Styling with Glass Effect */
        .dock {
            height: var(--dock-height);
            background: var(--liquid-glass);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border-top: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 1.5rem;
            gap: 1rem;
            z-index: 1000;
            border-radius: 20px 20px 0 0;
            margin: 0 8px;
            box-shadow: var(--glass-shadow);
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
        }

        /* Line 318: Dock Icon Styling */
        .dock-icon {
            width: calc(var(--app-icon-size) * 0.75);
            height: calc(var(--app-icon-size) * 0.75);
            background: var(--liquid-glass);
            backdrop-filter: blur(20px) saturate(200%);
            -webkit-backdrop-filter: blur(20px) saturate(200%);
            border-radius: 22%;
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: calc(var(--app-icon-size) * 0.28);
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--glass-shadow);
            position: relative;
        }

        /* Line 336: Dock Icon Hover Effect */
        .dock-icon:hover {
            transform: translateY(-6px) scale(1.15);
            box-shadow: var(--shadow-heavy);
        }

        /* Line 342: Dock Icon Active Indicator */
        .dock-icon.active::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
        }

        /* Line 355: Window Styling with Glass Effect */
        .window {
            position: absolute;
            background: var(--liquid-glass);
            backdrop-filter: blur(30px) saturate(200%);
            -webkit-backdrop-filter: blur(30px) saturate(200%);
            border-radius: var(--border-radius);
            box-shadow: var(--glass-shadow);
            min-width: 400px;
            min-height: 300px;
            max-width: 95vw;
            max-height: 90vh;
            z-index: 100;
            overflow: hidden;
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }

        /* Line 371: Window Fullscreen Mode */
        .window.fullscreen {
            width: 100vw !important;
            height: calc(100vh - var(--status-bar-height) - var(--dock-height)) !important;
            top: var(--status-bar-height) !important;
            left: 0 !important;
            border-radius: 0 !important;
            max-width: 100vw !important;
            max-height: calc(100vh - var(--status-bar-height) - var(--dock-height)) !important;
        }

        /* Line 381: Hide Edit Mode Toggle in Fullscreen */
        .window.fullscreen ~ .edit-mode-toggle {
            display: none;
        }

        /* Line 386: Window Header Styling */
        .window-header {
            background: rgba(0, 0, 0, 0.03);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
            user-select: none;
        }

        /* Line 398: Window Title Styling */
        .window-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1rem;
        }

        /* Line 405: Window Controls Container */
        .window-controls {
            display: flex;
            gap: 0.5rem;
        }

        /* Line 411: Window Control Buttons */
        .window-control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: rgba(0, 0, 0, 0.4);
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        /* Line 424: Mobile/Tablet Window Controls */
        .device-phone .window-control,
        .device-tablet .window-control {
            width: 28px;
            height: 28px;
            font-size: 16px;
            min-width: 28px;
            min-height: 28px;
        }

        /* Line 432: Window Control Colors */
        .window-control.close { 
            background: #FF5F57; 
        }
        .window-control.minimize { 
            background: #FFBD2E; 
        }
        .window-control.maximize { 
            background: #28CA42; 
        }

        /* Line 442: Window Control Hover Effects */
        .window-control:hover {
            transform: scale(1.1);
            color: rgba(0, 0, 0, 0.8);
        }

        /* Line 448: Window Control Icons on Hover */
        .window-control.close:hover::after { content: 'Ã—'; }
        .window-control.minimize:hover::after { content: 'âˆ’'; }
        .window-control.maximize:hover::after { content: 'â¬œ'; }

        /* Line 453: Window Content Area */
        .window-content {
            height: calc(100% - 60px);
            overflow: auto;
        }

        /* Line 459: Update Modal Styling */
        .update-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        /* Line 472: Update Container Styling */
        .update-container {
            background: var(--surface-light);
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: var(--shadow-heavy);
            border: 1px solid var(--glass-border);
        }

        /* Line 483: Update Title Styling */
        .update-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        /* Line 491: Update Text Styling */
        .update-text {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        /* Line 499: Update Buttons Container */
        .update-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        /* Line 506: Update Button Base Styling */
        .update-button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        /* Line 516: Primary Update Button */
        .update-button.primary {
            background: var(--primary-blue);
            color: white;
        }

        /* Line 522: Secondary Update Button */
        .update-button.secondary {
            background: var(--background-light);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        /* Line 529: Update Button Hover Effect */
        .update-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        /* Line 535: Start Menu Styling */
        .start-menu {
            position: fixed;
            bottom: calc(var(--dock-height) + 20px);
            left: 50%;
            transform: translateX(-50%);
            width: clamp(320px, 85vw, 500px);
            height: clamp(450px, 75vh, 600px);
            background: var(--liquid-glass);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            color: white;
            z-index: 1001;
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            box-shadow: var(--glass-shadow);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
            max-width: calc(100vw - 40px);
            max-height: calc(100vh - var(--dock-height) - 60px);
        }

        /* Line 558: Start Menu Show State */
        .start-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        /* Line 565: Start Menu Header */
        .start-menu-header {
            margin-bottom: 1.5rem;
            text-align: center;
        }

        /* Line 571: Start Menu Header Title */
        .start-menu-header h3 {
            font-size: 1.6rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        /* Line 578: Start Menu Header Subtitle */
        .start-menu-header p {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Line 584: Start Menu Apps Grid */
        .start-menu-apps {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 1.5rem;
            overflow-y: auto;
            padding-right: 1rem;
        }

        /* Line 594: Start App Item Styling */
        .start-app {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            border-radius: 16px;
            cursor: pointer;
            transition: var(--transition);
        }

        /* Line 605: Start App Hover Effect */
        .start-app:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        /* Line 611: Start App Icon Styling */
        .start-app-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        /* Line 622: Start App Name Styling */
        .start-app-name {
            font-size: 0.8rem;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
        }

        /* Line 632: File Item Styling */
        .file-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            gap: 0.75rem;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            min-height: 60px;
        }

        /* Line 647: File Item Hover Effect */
        .file-item:hover {
            background: rgba(0, 0, 0, 0.08);
            transform: translateY(-1px);
        }

        /* Line 653: File Item Active State */
        .file-item:active {
            transform: translateY(0);
            background: rgba(0, 0, 0, 0.12);
        }

        /* Line 659: File Item Selected State */
        .file-item.selected {
            background: var(--primary-blue);
            color: white;
            box-shadow: var(--shadow-light);
        }

        /* Line 666: File Icon Styling */
        .file-icon {
            font-size: 1.2rem;
            width: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Line 675: File Info Container */
        .file-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        /* Line 683: File Name Styling */
        .file-name {
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Line 689: File Details Styling */
        .file-details {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Line 695: Button Base Styling */
        .btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Line 706: Button Hover Effect */
        .btn:hover {
            background: #f8f9fa;
            transform: translateY(-1px);
            box-shadow: var(--shadow-light);
        }

        /* Line 713: Primary Button Styling */
        .btn-primary {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        /* Line 720: Primary Button Hover Effect */
        .btn-primary:hover {
            background: #0056CC;
        }

        /* Line 725: Toolbar Styling */
        .toolbar {
            padding: 1rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            gap: 0.75rem;
            align-items: center;
            background: rgba(0, 0, 0, 0.02);
            flex-wrap: wrap;
        }

        /* Line 736: Path Display Styling */
        .path-display {
            flex: 1;
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.85rem;
            min-width: 200px;
        }

        /* Line 747: File Explorer Styling */
        .file-explorer {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        /* Line 756: Keyframe Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Line 781: Mobile Responsive Design */
        @media (max-width: 480px) {
            .device-phone {
                --dock-height: 75px;
                --status-bar-height: 44px;
            }

            .home-screen {
                grid-template-columns: repeat(4, 1fr);
                gap: 1.2rem;
                padding: 1.5rem;
                padding-bottom: calc(var(--dock-height) + 1.5rem);
            }

            .app-icon {
                width: 60px;
                height: 60px;
                font-size: 28px;
            }

            .window {
                min-width: 95vw;
                min-height: 80vh;
                top: 10vh !important;
                left: 2.5vw !important;
            }

            .start-menu {
                width: calc(100vw - 20px);
                height: calc(100vh - var(--dock-height) - 60px);
                bottom: calc(var(--dock-height) + 10px);
                left: 10px;
                transform: translateX(0);
                max-width: none;
            }

            .start-menu-apps {
                grid-template-columns: repeat(3, 1fr);
            }

            .dock {
                margin: 0 4px;
                border-radius: 15px 15px 0 0;
            }
        }

        /* Line 821: Tablet Responsive Design */
        @media (min-width: 481px) and (max-width: 1024px) {
            .device-tablet {
                --dock-height: 85px;
                --status-bar-height: 50px;
            }

            .home-screen {
                grid-template-columns: repeat(6, 1fr);
                gap: 2rem;
                padding: 2rem;
                padding-bottom: calc(var(--dock-height) + 2rem);
            }

            .app-icon {
                width: 80px;
                height: 80px;
                font-size: 36px;
            }

            .start-menu {
                width: clamp(400px, 85vw, 600px);
                height: clamp(500px, 75vh, 650px);
                max-width: calc(100vw - 40px);
            }

            .start-menu-apps {
                grid-template-columns: repeat(4, 1fr);
            }

            .dock {
                margin: 0 6px;
                border-radius: 18px 18px 0 0;
            }
        }

        /* Line 851: Desktop Responsive Design */
        @media (min-width: 1025px) {
            .device-desktop {
                --dock-height: 50px;
                --status-bar-height: 28px;
            }

            .home-screen {
                grid-template-columns: repeat(8, 1fr);
                gap: 2.5rem;
                padding: 2rem;
                padding-bottom: calc(var(--dock-height) + 2rem);
            }

            .app-icon {
                width: 70px;
                height: 70px;
                font-size: 32px;
            }

            .start-menu {
                width: clamp(350px, 25vw, 450px);
                height: clamp(450px, 70vh, 650px);
                left: 50%;
                transform: translateX(-50%);
                max-width: calc(100vw - 40px);
            }

            .start-menu-apps {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Line 879: Utility Classes */
        .hidden { display: none !important; }
        .blur { filter: blur(10px); }

        /* Line 883: Edit Mode Animation */
        .edit-mode .app-icon {
            animation: wiggle 0.5s ease-in-out infinite alternate;
        }

        /* Line 888: Edit Mode Toggle Button */
        .edit-mode-toggle {
            position: fixed;
            top: 0px;
            right: 20px;
            background: var(--liquid-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            z-index: 1000;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        /* Line 903: Edit Mode Toggle Hover */
        .edit-mode-toggle:hover {
            background: var(--liquid-glass-hover);
            transform: translateY(-1px);
        }

        /* Line 909: Edit Mode Toggle Active State */
        .edit-mode-toggle.active {
            background: var(--primary-blue);
        }

        /* Line 914: Wiggle Animation for Edit Mode */
        @keyframes wiggle {
            0% { transform: rotate(-2deg); }
            100% { transform: rotate(2deg); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        /* Line 920: Control Center Styling */
        .control-center {
            position: fixed;
            top: -100%;
            left: 50%;
            transform: translateX(-50%);
            width: clamp(300px, 85vw, 400px);
            height: auto;
            max-height: 60vh;
            background: var(--liquid-glass);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            color: white;
            z-index: 2000;
            padding: 1.5rem;
            box-shadow: var(--glass-shadow);
            transition: top 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            overflow-y: auto;
        }

        /* Line 938: Control Center Show State */
        .control-center.show {
            top: calc(var(--status-bar-height) + 20px);
        }

        /* Control Center - Hide Apps Section */
        .control-center .control-section:last-child {
            display: none; /* Hides the Apps section */
        }

        /* Line 943: Control Section Styling */
        .control-section {
            margin-bottom: 1.5rem;
        }

        /* Line 948: Control Section Last Child */
        .control-section:last-child {
            margin-bottom: 0;
        }

        /* Line 953: Control Section Headers */
        .control-section h4 {
            margin: 0 0 1rem 0;
            font-size: 0.9rem;
            font-weight: 600;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Line 963: Control Grid Layout */
        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 1rem;
        }

        /* Line 970: Control Item Styling */
        .control-item {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Line 981: Control Item Hover Effect */
        .control-item:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        /* Line 987: Control Item Active State */
        .control-item:active {
            transform: translateY(0);
        }

        /* Line 992: Control Item Active Class */
        .control-item.active {
            background: var(--primary-blue);
        }

        /* Line 997: Control Icon Styling */
        .control-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        /* Line 1004: Control Label Styling */
        .control-label {
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Line 1010: Brightness Slider Styling */
        .brightness-slider {
            width: 100%;
            margin: 0.5rem 0;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.3);
            outline: none;
        }

        /* Line 1022: Brightness Slider Webkit Thumb */
        .brightness-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        /* Line 1033: Brightness Slider Mozilla Thumb */
        .brightness-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        /* Line 1043: Power Button Hover Effect */
        .power-button:hover {
            background: rgba(255, 255, 255, 0.3) !important;
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        /* Line 1050: Shutdown Button Hover Effect */
        .power-button[data-action="shutdown"]:hover {
            background: rgba(255, 0, 0, 0.5) !important;
        }

        /* Line 1055: Glass Utility Class */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }

        /* Line 1062: Dark Mode Variables */
        .dark-mode {
            --background-light: #1C1C1E;
            --surface-light: #2C2E3A; /* Darker surface for dark mode */
            --surface-dark: #1C1E2E;
            --text-primary: #FFFFFF;
            --text-secondary: #AEAEB2; /* Lighter secondary text */
            --glass-bg: rgba(28, 28, 30, 0.8);
            --glass-border: rgba(40, 40, 44, 0.8);
            --shadow-heavy: 0 8px 40px rgba(0, 0, 0, 0.2);
        }

        /* Notification animations */
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Lock Screen Styles */
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: white;
        }

        .lock-container {
            text-align: center;
            padding: 2rem;
        }

        .lock-time {
            font-size: 4rem;
            font-weight: 200;
            margin-bottom: 0.5rem;
        }

        .lock-date {
            font-size: 1.2rem;
            opacity: 0.8;
            margin-bottom: 3rem;
        }

        .lock-user-avatar {
            font-size: 5rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.2);
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem auto;
        }

        .lock-username {
            font-size: 1.5rem;
            font-weight: 300;
            margin-bottom: 2rem;
        }

        .lock-input-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            margin-bottom: 1rem;
        }

        .lock-password-input {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1.1rem;
            outline: none;
            backdrop-filter: blur(10px);
            min-width: 250px;
            text-align: center;
        }

        .lock-password-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .lock-unlock-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .lock-unlock-button:hover {
            background: rgba(255, 255, 255, 0.4);
            transform: scale(1.05);
        }

        .lock-error {
            color: #ff4757;
            font-size: 0.9rem;
            font-weight: 500;
            background: rgba(255, 71, 87, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        /* Restart Screen Styles */
        .restart-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: white;
        }

        .restart-container {
            text-align: center;
            padding: 2rem;
        }

        .restart-logo {
            font-size: 6rem;
            margin-bottom: 2rem;
            animation: spin 2s linear infinite;
        }

        .restart-text {
            font-size: 1.5rem;
            font-weight: 300;
            margin-bottom: 2rem;
        }

        .restart-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        /* Shutdown Screen Styles */
        .shutdown-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            color: white;
            cursor: pointer;
        }

        .shutdown-container {
            text-align: center;
            padding: 2rem;
        }

        .shutdown-text {
            font-size: 1.5rem;
            font-weight: 300;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .boot-prompt {
            font-size: 1rem;
            opacity: 0.6;
            animation: fadeInOut 2s infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* Notification Center Styles */
        .notification-center {
            position: fixed;
            top: -100%;
            right: 20px;
            width: clamp(300px, 25vw, 400px);
            max-height: 70vh;
            background: var(--liquid-glass);
            backdrop-filter: blur(40px) saturate(200%);
            -webkit-backdrop-filter: blur(40px) saturate(200%);
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            color: white;
            z-index: 2001;
            box-shadow: var(--glass-shadow);
            transition: top 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            overflow: hidden;
        }

        .notification-center.show {
            top: calc(var(--status-bar-height) + 20px);
        }

        .notification-center-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notification-center-header h3 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .notification-list {
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
        }

        .no-notifications {
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            padding: 2rem;
            font-style: italic;
        }

        .notification-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid var(--primary-blue);
            transition: var(--transition);
        }

        .notification-item:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .notification-item:last-child {
            margin-bottom: 0;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }

        .notification-message {
            font-size: 0.8rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .notification-time {
            font-size: 0.7rem;
            opacity: 0.7;
        }

        .notification-toast {
            position: fixed;
            top: calc(var(--status-bar-height) + 20px);
            right: 20px;
            background: var(--liquid-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            z-index: 10000;
            min-width: 250px;
            animation: slideInRight 0.3s ease;
            box-shadow: var(--glass-shadow);
        }

        .notification-toast.success {
            border-left: 4px solid #2ed573;
        }

        .notification-toast.error {
            border-left: 4px solid #ff4757;
        }

        .notification-toast.warning {
            border-left: 4px solid #ffa502;
        }

        .notification-toast.info {
            border-left: 4px solid #5352ed;
        }

        /* Line 1071: Task Manager Specific Styles */
        .task-manager-container {
            padding: 1.5rem;
            height: 100%;
            overflow-y: auto;
            color: white;
        }

        .resource-monitor {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .resource-card {
            background: var(--liquid-glass);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
        }

        .resource-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: white;
        }

        .resource-value {
            font-size: 2rem;
            font-weight: 300;
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }

        .resource-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .resource-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .cpu-fill {
            background: linear-gradient(90deg, #4CAF50, #FFC107);
        }

        .memory-fill {
            background: linear-gradient(90deg, #2196F3, #9C27B0);
        }

        .disk-fill {
            background: linear-gradient(90deg, #FF5722, #E91E63);
        }

        .network-fill {
            background: linear-gradient(90deg, #00BCD4, #009688);
        }

        .process-list {
            background: var(--liquid-glass);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            overflow: hidden;
        }

        .process-header {
            padding: 1rem 1.5rem;
            background: rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid var(--glass-border);
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 100px;
            gap: 1rem;
            font-weight: 600;
            color: white;
        }

        .process-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 100px;
            gap: 1rem;
            align-items: center;
            transition: var(--transition);
        }

        .process-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .process-item:last-child {
            border-bottom: none;
        }

        .process-name {
            font-weight: 500;
            color: white;
        }

        .process-cpu, .process-memory, .process-disk {
            color: #ccc;
            font-family: 'SF Mono', Monaco, monospace;
        }

        .end-process-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
        }

        .end-process-btn:hover {
            background: #ff3838;
            transform: translateY(-1px);
        }

        .memory-settings-section {
            background: var(--liquid-glass);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            margin-top: 1.5rem;
        }

        .memory-setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .memory-setting-item:last-child {
            margin-bottom: 0;
        }

        .memory-setting-label {
            color: white;
            font-weight: 500;
        }

        .memory-setting-value {
            color: var(--primary-blue);
            font-family: 'SF Mono', Monaco, monospace;
        }

        .memory-slider {
            width: 200px;
            margin-left: 1rem;
        }
    </style>
</head>
<body>
    <!-- Line 1200: Boot Screen -->
    <div id="bootScreen" class="boot-screen">
        <div class="boot-logo">NamChaOS</div>
        <div class="boot-spinner"></div>
        <div class="boot-text">Starting up...</div>
    </div>

    <!-- Line 1207: Installation Screen -->
    <div id="installScreen" class="install-screen hidden">
        <div class="install-container">
            <h1 class="install-title">Welcome to NamChaOS</h1>
            <p class="install-subtitle">The best OS!!!!!!</p>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
            </div>
            <p id="installStatus">Ready to install</p>
            <button id="installButton" class="install-button">Install NamChaOS</button>
        </div>
    </div>

    <!-- Line 1220: Desktop Environment -->
    <div id="desktop" class="desktop hidden">
        <!-- Line 1222: Status Bar -->
        <div class="status-bar">
            <div class="status-left">
                <span id="usernameDisplay">User</span>
                <span>-</span>
                <span>NamChaOS</span>
            </div>
            <div class="status-right">
                <button id="notificationToggle" class="status-button" style="background: none; border: none; color: white; cursor: pointer; padding: 0.25rem;">ðŸ””</button>
                <span id="batteryLevel">ðŸ”‹100%</span>
                <span id="currentTime"></span>
            </div>
        </div>

        <!-- Line 1236: Desktop Content -->
        <div class="desktop-content">
            <!-- Line 1238: Home Screen with App Icons -->
            <div class="home-screen" id="homeScreen">
                <div class="app-icon" data-app="files">
                    <img src="appicons/files.jpeg" alt="Files Icon" style="width: 50px; max-width: 100%; height: auto; display: block;">
                    <div class="app-label">Files</div>
                </div>
                <div class="app-icon" data-app="notes">
                    <img src="appicons/notes.png" alt="Notes Icon" style="width: 50px; max-width: 100%; height: auto; display: block;">
                    <div class="app-label">Notes</div>
                </div>
                <div class="app-icon" data-app="calculator">
                    <img src="appicons/calculator.png" alt="Calculator Icon" style="width: 50px; max-width: 100%; height: auto; display: block;">
                    <div class="app-label">Calculator</div>
                </div>
                <div class="app-icon" data-app="browser">
                    <img src="appicons/browser.png" alt="Browser Icon" style="width: 50px; max-width: 100%; height: auto; display: block;">
                    <div class="app-label">Browser</div>
                </div>
                <div class="app-icon" data-app="settings">
                    <img src="appicons/settings.png" alt="Settings Icon" style="width: 50px; max-width: 100%; height: auto; display: block;">
                    <div class="app-label">Settings</div>
                </div>
                <div class="app-icon" data-app="photos">
                    <span>ðŸ–¼ï¸</span>
                    <div class="app-label">Photos</div>
                </div>
                <div class="app-icon" data-app="music">
                    <span>ðŸŽµ</span>
                    <div class="app-label">Music</div>
                </div>
                <div class="app-icon" data-app="camera">
                    <span>ðŸ“·</span>
                    <div class="app-label">Camera</div>
                </div>
                <div class="app-icon" data-app="appstore">
                    <span>ðŸ›ï¸</span>
                    <div class="app-label">App Store</div>
                </div>
                <div class="app-icon" data-app="downloader">
                    <span>â¬‡ï¸</span>
                    <div class="app-label">Downloader</div>
                </div>
                <div class="app-icon" data-app="clock">
                    <span>ðŸ•</span>
                    <div class="app-label">Clock</div>
                </div>
                <div class="app-icon" data-app="contacts">
                    <span>ðŸ‘¥</span>
                    <div class="app-label">Contacts</div>
                </div>
                <div class="app-icon" data-app="voice-recorder">
                    <span>ðŸŽ™ï¸</span>
                    <div class="app-label">Voice Recorder</div>
                </div>
                <div class="app-icon" data-app="maps">
                    <span>ðŸ—ºï¸</span>
                    <div class="app-label">Maps</div>
                </div>
                <div class="app-icon" data-app="mail">
                    <span>ðŸ“§</span>
                    <div class="app-label">Mail</div>
                </div>
                <div class="app-icon" data-app="terminal">
                    <span>ðŸ’»</span>
                    <div class="app-label">Terminal</div>
                </div>
                <div class="app-icon" data-app="paint">
                    <span>ðŸŽ¨</span>
                    <div class="app-label">Paint</div>
                </div>
                <div class="app-icon" data-app="nam-interpreter">
                    <span>ðŸ’»</span>
                    <div class="app-label">NAM Interpreter</div>
                </div>
                <div class="app-icon" data-app="mytube">
                    <span>ðŸ’»</span>
                    <div class="app-label">MyTube</div>
                </div>
                <div class="app-icon" data-app="admin">
                    <span>ðŸ’»</span>
                    <div class="app-label">Admin</div>
                </div>
            </div>
        </div>

        <!-- Line 1286: Dock -->
        <div class="dock">
            <div class="dock-icon" data-app="start-menu" id="startButton">
                <span>ðŸªŸ</span>
            </div>
            <div class="dock-icon" data-app="files">
                <img src="appicons/files.jpeg" alt="Files Icon" style="width: 50px; max-width: 100%; height: auto; display: block;">
            </div>
            <div class="dock-icon" data-app="browser">
                <span><img src="appicons/browser.png" alt="Browser Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></span>
            </div>
            <div class="dock-icon" data-app="notes">
                <span><img src="appicons/notes.png" alt="Notes Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></span>
            </div>
            <div class="dock-icon" data-app="calculator">
                <span><img src="appicons/calculator.png" alt="Calculator Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></span>
            </div>
            <div class="dock-icon" data-app="taskmanager">
                <span>ðŸ“ˆ</span>
            </div>
            <div class="dock-icon" data-app="settings">
                <span><img src="appicons/settings.png" alt="Settings Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></span>
            </div>
            <button class="edit-mode-toggle" id="editModeToggle">Edit</button>
        </div>

        <!-- Line 1310: Control Center -->
        <div id="controlCenter" class="control-center">
            <div class="control-section">
                <h4>Connectivity</h4>
                <div class="control-grid">
                    <div class="control-item" onclick="namchaos.toggleWiFi()">
                        <span class="control-icon">ðŸ“¶</span>
                        <span class="control-label">WiFi</span>
                    </div>
                    <div class="control-item" onclick="namchaos.toggleBluetooth()">
                        <span class="control-icon">ðŸ”µ</span>
                        <span class="control-label">Bluetooth</span>
                    </div>
                    <div class="control-item" onclick="namchaos.toggleAirplaneMode()">
                        <span class="control-icon">âœˆï¸</span>
                        <span class="control-label">Airplane</span>
                    </div>
                </div>
            </div>
            <div class="control-section">
                <h4>Display & Sound</h4>
                <div class="control-grid">
                    <div class="control-item" onclick="namchaos.toggleDarkMode()">
                        <span class="control-icon">ðŸŒ™</span>
                        <span class="control-label">Dark Mode</span>
                    </div>
                    <div class="control-item" onclick="namchaos.toggleAutoRotate()">
                        <span class="control-icon">ðŸ”„</span>
                        <span class="control-label">Auto-Rotate</span>
                    </div>
                    <div class="control-item" onclick="namchaos.toggleDoNotDisturb()">
                        <span class="control-icon">ðŸ”•</span>
                        <span class="control-label">Do Not Disturb</span>
                    </div>
                </div>
            </div>
            <div class="control-section">
                <h4>Brightness</h4>
                <input type="range" class="brightness-slider" min="20" max="100" value="80" onchange="namchaos.adjustBrightness(this.value)">
            </div>
            <div class="control-section">
                <h4>Volume</h4>
                <input type="range" class="brightness-slider" min="0" max="100" value="75" onchange="namchaos.adjustVolume(this.value)">
            </div>
            <!-- Removed the 'Apps' section from the control center -->
        </div>

        <!-- Line 1352: Start Menu -->
        <div id="startMenu" class="start-menu">
            <div class="start-menu-header">
                <h3>NamChaOS</h3>
                <p>All Applications</p>
            </div>
            <div class="start-menu-apps">
                <div class="start-app" data-app="files">
                    <div class="start-app-icon"><img src="appicons/files.jpeg" alt="Files Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></div>
                    <div class="start-app-name">Files</div>
                </div>
                <div class="start-app" data-app="notes">
                    <div class="start-app-icon"><img src="appicons/notes.png" alt="Notes Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></div>
                    <div class="start-app-name">Notes</div>
                </div>
                <div class="start-app" data-app="calculator">
                    <div class="start-app-icon"><img src="appicons/calculator.png" alt="Calculator Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></div>
                    <div class="start-app-name">Calculator</div>
                </div>
                <div class="start-app" data-app="browser">
                    <div class="start-app-icon"><img src="appicons/browser.png" alt="Browser Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></div>
                    <div class="start-app-name">Browser</div>
                </div>
                <div class="start-app" data-app="settings">
                    <div class="start-app-icon"><img src="appicons/settings.png" alt="Settings Icon" style="width: 50px; max-width: 100%; height: auto; display: block;"></div>
                    <div class="start-app-name">Settings</div>
                </div>
                <div class="start-app" data-app="photos">
                    <div class="start-app-icon">ðŸ–¼ï¸</div>
                    <div class="start-app-name">Photos</div>
                </div>
                <div class="start-app" data-app="music">
                    <div class="start-app-icon">ðŸŽµ</div>
                    <div class="start-app-name">Music</div>
                </div>
                <div class="start-app" data-app="camera">
                    <div class="start-app-icon">ðŸ“·</div>
                    <div class="start-app-name">Camera</div>
                </div>
                <div class="start-app" data-app="terminal">
                    <div class="start-app-icon">ðŸ’»</div>
                    <div class="start-app-name">Terminal</div>
                </div>
                <div class="start-app" data-app="paint">
                    <div class="start-app-icon">ðŸŽ¨</div>
                    <div class="start-app-name">Paint</div>
                </div>
                <div class="start-app" data-app="appstore">
                    <div class="start-app-icon">ðŸ›ï¸</div>
                    <div class="start-app-name">App Store</div>
                </div>
                <div class="start-app" data-app="downloader">
                    <div class="start-app-icon">â¬‡ï¸</div>
                    <div class="start-app-name">Downloader</div>
                </div>
                <div class="start-app" data-app="clock">
                    <div class="start-app-icon">ðŸ•</div>
                    <div class="start-app-name">Clock</div>
                </div>
                <div class="start-app" data-app="contacts">
                    <div class="start-app-icon">ðŸ‘¥</div>
                    <div class="start-app-name">Contacts</div>
                </div>
                <div class="start-app" data-app="voice-recorder">
                    <div class="start-app-icon">ðŸŽ™ï¸</div>
                    <div class="start-app-name">Voice Recorder</div>
                </div>
                <div class="start-app" data-app="maps">
                    <div class="start-app-icon">ðŸ—ºï¸</div>
                    <div class="start-app-name">Maps</div>
                </div>
                <div class="start-app" data-app="mail">
                    <div class="start-app-icon">ðŸ“§</div>
                    <div class="start-app-name">Mail</div>
                </div>
                <div class="start-app" data-app="taskmanager">
                    <div class="start-app-icon">ðŸ“ˆ</div>
                    <div class="start-app-name">Task Manager</div>
                </div>
                <div class="start-app" data-app="nam-interpreter">
                    <div class="start-app-icon">ðŸ’»</div>
                    <div class="start-app-name">NAM Interpreter</div>
                </div>
                <div class="start-app" data-app="mytube">
                    <div class="start-app-icon">ðŸ’»</div>
                    <div class="start-app-name">MyTube</div>
                </div>
                <div class="start-app" data-app="admin">
                    <div class="start-app-icon">ðŸ’»</div>
                    <div class="start-app-name">Admin</div>
                </div>
            </div>
            <div style="margin-top: auto; padding-top: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.2);">
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button class="power-button" data-action="restart" style="background: rgba(255, 255, 255, 0.2); border: none; color: white; padding: 0.75rem 1.5rem; border-radius: 12px; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; transition: var(--transition);">
                        ðŸ”„ Restart
                    </button>
                    <button class="power-button" data-action="shutdown" style="background: rgba(255, 0, 0, 0.3); border: none; color: white; padding: 0.75rem 1.5rem; border-radius: 12px; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; transition: var(--transition);">
                        â» Shut Down
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Lock Screen -->
    <div id="lockScreen" class="lock-screen hidden">
        <div class="lock-container">
            <div class="lock-time" id="lockTime"></div>
            <div class="lock-date" id="lockDate"></div>
            <div class="lock-user-avatar">ðŸ‘¤</div>
            <div class="lock-username" id="lockUsername">User</div>
            <div class="lock-input-container">
                <input type="password" id="lockPasswordInput" class="lock-password-input" placeholder="Enter password">
                <button id="lockUnlockButton" class="lock-unlock-button">â†’</button>
            </div>
            <div id="lockError" class="lock-error hidden">Incorrect password</div>
        </div>
    </div>

    <!-- Restart Screen -->
    <div id="restartScreen" class="restart-screen hidden">
        <div class="restart-container">
            <div class="restart-logo">ðŸ”„</div>
            <div class="restart-text">Restarting NamChaOS...</div>
            <div class="restart-spinner"></div>
        </div>
    </div>

    <!-- Shutdown Screen -->
    <div id="shutdownScreen" class="shutdown-screen hidden">
        <div class="shutdown-container">
            <div class="shutdown-text">System has been shut down safely</div>
            <div class="boot-prompt">Touch screen to boot</div>
        </div>
    </div>

    <!-- Notification Center -->
    <div id="notificationCenter" class="notification-center">
        <div class="notification-center-header">
            <h3>Notifications</h3>
            <button id="clearAllNotifications" class="btn">Clear All</button>
        </div>
        <div id="notificationList" class="notification-list">
            <div class="no-notifications">No notifications</div>
        </div>
    </div>

    <!-- Line 1442: Update Modal -->
    <div id="updateModal" class="update-modal hidden">
        <div class="update-container">
            <h2 class="update-title">Software Update Available</h2>
            <p class="update-text">
                NamChaOS 1 Beta 2 is now available! with Lorem ipsum dolor sit amet consectetur adipiscing elit. Consectetur adipiscing elit quisque faucibus ex sapien vitae. Ex sapien vitae pellentesque sem placerat in id. Placerat in id cursus mi pretium tellus duis. Pretium tellus duis convallis tempus leo eu aenean.
            </p>
            <div class="update-buttons">
                <button class="update-button secondary" onclick="namchaos.dismissUpdate()">Later</button>
                <button class="update-button primary" onclick="namchaos.installUpdate()">Update Now</button>
            </div>
        </div>
    </div>

    <script>
        // Line 1456: NamChaOS Main Class Definition
        class NamChaOS {
            // Line 1458: Constructor - Initialize the operating system
            constructor() {
                this.currentState = 'boot';                    // Current system state
                this.isInstalled = localStorage.getItem('namchaos-installed') === 'true';  // Installation status
                this.openWindows = new Map();                  // Track open application windows
                this.windowZIndex = 100;                       // Window layering index
                this.deviceType = this.detectDevice();         // Detect device type (phone/tablet/desktop)
                this.updateAvailable = false;                  // Software update availability
                this.fileSystem = this.initFileSystem();       // Initialize virtual file system
                this.installedApps = this.loadInstalledApps(); // Load installed applications
                this.currentDirectory = '/';                   // Current file system directory
                this.selectedFiles = new Set();               // Selected files in file manager
                this.currentNote = { content: '', filename: 'Untitled' };  // Current note data
                this.calculatorDisplay = '0';                 // Calculator display value
                this.calculatorOperand = null;                // Calculator operand storage
                this.calculatorOperator = null;               // Calculator operator storage
                this.calculatorWaitingForOperand = false;     // Calculator input state
                this.calculatorSecondFunction = false;        // State for calculator's secondary functions
                this.browserHistory = [];                     // Browser navigation history
                this.browserCurrentIndex = -1;                // Browser history index
                this.downloads = this.loadDownloads();        // Download manager data
                this.isDragging = false;                      // Window dragging state
                this.dragElement = null;                      // Currently dragged element
                this.dragOffset = { x: 0, y: 0 };            // Drag offset coordinates
                this.audioRecorder = null;                    // Audio recorder instance
                this.audioChunks = [];                        // Audio recording chunks
                this.audioBlob = null;                        // Audio blob data
                this.currentRecordingMimeType = null;         // Mime type for current recording
                this.currentRecordingExtension = null;        // File extension for current recording
                this.recordings = this.loadRecordings();      // Load existing recordings
                this.contactList = this.loadContacts();       // Contact list data
                this.customSettings = this.loadCustomSettings(); // Custom user settings
                this.appPositions = this.loadAppPositions();  // App icon positions
                this.draggedApp = null;                       // Currently dragged app
                this.isEditMode = false;                      // Edit mode state
                this.systemResources = {                      // System resource monitoring
                    cpu: { usage: 0, processes: [] },
                    memory: { used: 0, total: 3072, available: 3072 },
                    disk: { used: 0, total: 512000, available: 512000 },
                    network: { download: 0, upload: 0 }
                };
                this.allowedMemory = parseInt(localStorage.getItem('namchaos-allowed-memory')) || 3072; // Allowed memory limit
                this.notifications = [];                      // Notification system
                this.runningProcesses = this.initializeProcesses(); // Initialize running processes after other properties
                this.lockScreenEnabled = localStorage.getItem('namchaos-lock-enabled') === 'true';
                this.systemPassword = localStorage.getItem('namchaos-password') || 'password';
                this.isLocked = false;                        // Don't start locked during boot
                this.init();                                  // Initialize the system
            }

            // Line 1492: Device Detection Method
            detectDevice() {
                const width = window.innerWidth;
                const userAgent = navigator.userAgent;

                if (width <= 480 || /iPhone/.test(userAgent)) {
                    document.body.classList.add('device-phone');
                    return 'iPhone';
                } else if (width <= 1024 || /iPad/.test(userAgent)) {
                    document.body.classList.add('device-tablet');
                    return 'Tablet';
                } else {
                    document.body.classList.add('device-desktop');
                    return 'Desktop';
                }
            }

            // Line 1507: System Initialization Method
            init() {
                this.updateClock();                           // Start clock updates
                setInterval(() => this.updateClock(), 500);  // Update clock every second
                this.updateDeviceInfo();                      // Update device information
                this.applyCustomSettings();                   // Apply user settings
                this.startResourceMonitoring();               // Start system resource monitoring
                this.initializeLockScreen();                  // Initialize lock screen
                this.initializeNotificationCenter();          // Initialize notification center

                if (this.isInstalled) {
                    if (this.lockScreenEnabled) {
                        setTimeout(() => this.showLockScreen(), 1000); // Show lock screen after boot if enabled
                    } else {
                        setTimeout(() => this.showDesktop(), 1000); // Show desktop after boot
                    }
                } else {
                    setTimeout(() => this.showInstallation(), 1500); // Show installation screen
                }

                this.setupEventListeners();                   // Setup UI event handlers
                this.checkForUpdates();                       // Check for system updates
            }

            // Line 1522: Initialize System Processes Method
            initializeProcesses() {
                return [
                    {
                        pid: 1,
                        name: 'NamChaOS Kernel',
                        icon: 'ðŸ”§',
                        cpu: 2.5,
                        memory: 256,
                        disk: 5,
                        network: 10,
                        priority: 'High',
                        status: 'Running',
                        startTime: Date.now() - 300000, // Started 5 minutes ago
                        critical: true,
                        appId: null
                    },
                    {
                        pid: 2,
                        name: 'Window Manager',
                        icon: 'ðŸªŸ',
                        cpu: 1.2,
                        memory: 128,
                        disk: 2,
                        network: 5,
                        priority: 'High',
                        status: 'Running',
                        startTime: Date.now() - 280000,
                        critical: true,
                        appId: null
                    },
                    {
                        pid: 3,
                        name: 'Desktop Environment',
                        icon: 'ðŸ–¥ï¸',
                        cpu: 3.1,
                        memory: 192,
                        disk: 8,
                        network: 15,
                        priority: 'Normal',
                        status: 'Running',
                        startTime: Date.now() - 260000,
                        critical: true,
                        appId: null
                    },
                    {
                        pid: 4,
                        name: 'File System Driver',
                        icon: 'ðŸ“',
                        cpu: 0.8,
                        memory: 64,
                        disk: 25,
                        network: 3,
                        priority: 'High',
                        status: 'Running',
                        startTime: Date.now() - 290000,
                        critical: true,
                        appId: null
                    },
                    {
                        pid: 5,
                        name: 'Resource Monitor',
                        icon: 'ðŸ“Š',
                        cpu: 1.5,
                        memory: 48,
                        disk: 1,
                        network: 0,
                        priority: 'Normal',
                        status: 'Running',
                        startTime: Date.now() - 250000,
                        critical: true,
                        appId: null
                    },
                    {
                        pid: 6,
                        name: 'Graphics Compositor',
                        icon: 'ðŸŽ¨',
                        cpu: 4.2,
                        memory: 186,
                        disk: 3,
                        network: 0,
                        priority: 'High',
                        status: 'Running',
                        startTime: Date.now() - 240000,
                        critical: true,
                        appId: null
                    }
                ];
            }

            // Line 1555: Resource Monitoring Initialization
            startResourceMonitoring() {
                // Initialize boot time
                this.initBootTime();

                // High-frequency updates for real-time monitoring
                setInterval(() => {
                    this.updateSystemResources();
                    this.updateAllAppsResourceInfo();
                }, 50); // Update every 100ms for smooth real-time display

                // Less frequent updates for UI elements to prevent flicker
                setInterval(() => {
                    this.updateTaskManagerDisplay();
                }, 500); // Update UI every 500ms

                // Update C: drive usage periodically
                setInterval(() => {
                    this.updateDriveUsage();
                }, 500); // Update drive usage every 2 seconds
            }

            // Line 1529: System Resource Update Method
            updateSystemResources() {
                // Simulate CPU usage (10-80%)
                this.systemResources.cpu.usage = Math.floor(Math.random() * 70) + 10;

                // Simulate memory usage based on open windows
                const baseMemoryUsage = 1024; // Base OS memory usage
                const windowMemoryUsage = this.openWindows.size * 256; // Each window uses ~256MB
                this.systemResources.memory.used = Math.min(
                    baseMemoryUsage + windowMemoryUsage + Math.floor(Math.random() * 512),
                    this.allowedMemory
                );
                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;

                // Simulate disk usage
                this.systemResources.disk.used = 45000 + Math.floor(Math.random() * 5000);
                this.systemResources.disk.available = this.systemResources.disk.total - this.systemResources.disk.used;

                // Simulate network activity
                this.systemResources.network.download = Math.floor(Math.random() * 1000);
                this.systemResources.network.upload = Math.floor(Math.random() * 500);

                // Update processes list
                this.updateProcessList();

                // Update task manager if open
                const taskManagerWindow = this.openWindows.get('taskmanager');
                if (taskManagerWindow) {
                    const content = taskManagerWindow.querySelector('.window-content');
                    if (content) {
                        this.updateTaskManagerDisplay(content);
                    }
                }
            }

            // Line 1553: Process List Update Method
            updateProcessList() {
                // Update system process CPU usage realistically
                this.runningProcesses.forEach(process => {
                    if (process.critical) {
                        // System processes have more stable CPU usage
                        process.cpu = Math.max(1, process.cpu + (Math.random() - 0.5) * 2);
                        process.cpu = Math.min(15, process.cpu); // Cap system processes at 15%
                    } else {
                        // App processes have more variable CPU usage
                        const variation = (Math.random() - 0.5) * 8;
                        process.cpu = Math.max(0.5, process.cpu + variation);
                        process.cpu = Math.min(80, process.cpu); // Cap apps at 80%

                        // Memory usage can fluctuate slightly
                        const memVariation = (Math.random() - 0.5) * 10;
                        process.memory = Math.max(32, process.memory + memVariation);
                        process.memory = Math.min(512, process.memory);
                    }

                    // Add disk I/O activity
                    process.disk = Math.floor(Math.random() * 50);
                    process.network = Math.floor(Math.random() * 100);
                });

                // Calculate total CPU usage from all processes
                this.systemResources.cpu.usage = Math.min(100, 
                    this.runningProcesses.reduce((total, process) => total + process.cpu, 0)
                );

                // Update memory usage based on processes
                this.systemResources.memory.used = Math.min(this.allowedMemory,
                    this.runningProcesses.reduce((total, process) => total + process.memory, 0)
                );
                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;
            }

            // Line 1573: Task Manager Display Update Method
            updateTaskManagerDisplay(content) {
                // If no content passed, try to get it from open Task Manager window
                if (!content) {
                    const taskManagerWindow = this.openWindows.get('taskmanager');
                    if (!taskManagerWindow) return;
                    content = taskManagerWindow.querySelector('.window-content');
                    if (!content) return;
                }

                // Calculate total disk and network I/O from all processes
                const totalDiskIO = this.runningProcesses.reduce((sum, p) => sum + (p.disk || 0), 0);
                const totalNetworkIO = this.runningProcesses.reduce((sum, p) => sum + (p.network || 0), 0);

                // Update resource values with more detailed information
                const cpuValue = content.querySelector('#cpuUsageValue');
                const memoryValue = content.querySelector('#memoryUsageValue');
                const diskValue = content.querySelector('#diskUsageValue');
                const networkValue = content.querySelector('#networkUsageValue');

                // Update detailed information
                const cpuDetails = content.querySelector('#cpuDetails');
                const memoryDetails = content.querySelector('#memoryDetails');
                const diskDetails = content.querySelector('#diskDetails');
                const networkDetails = content.querySelector('#networkDetails');

                if (cpuValue) cpuValue.textContent = `${this.systemResources.cpu.usage.toFixed(1)}%`;
                if (memoryValue) memoryValue.textContent = `${Math.round((this.systemResources.memory.used / this.allowedMemory) * 100)}%`;
                if (diskValue) diskValue.textContent = `${totalDiskIO} KB/s`;
                if (networkValue) networkValue.textContent = `${totalNetworkIO} KB/s`;

                if (cpuDetails) cpuDetails.textContent = `${this.runningProcesses.length} processes â€¢ ${this.runningProcesses.filter(p => !p.critical).length} apps`;
                if (memoryDetails) memoryDetails.textContent = `${this.systemResources.memory.used.toFixed(0)} MB / ${this.allowedMemory} MB (${this.systemResources.memory.available.toFixed(0)} MB free)`;
                if (diskDetails) diskDetails.textContent = `${this.runningProcesses.filter(p => (p.disk || 0) > 0).length} active processes`;
                if (networkDetails) networkDetails.textContent = `â†“${Math.floor(totalNetworkIO * 0.6)} KB/s â†‘${Math.floor(totalNetworkIO * 0.4)} KB/s`;

                // Update resource bars with smooth animations
                const cpuBar = content.querySelector('.cpu-fill');
                const memoryBar = content.querySelector('.memory-fill');
                const diskBar = content.querySelector('.disk-fill');
                const networkBar = content.querySelector('.network-fill');

                if (cpuBar) cpuBar.style.width = `${this.systemResources.cpu.usage}%`;
                if (memoryBar) memoryBar.style.width = `${Math.round((this.systemResources.memory.used / this.allowedMemory) * 100)}%`;
                if (diskBar) diskBar.style.width = `${Math.min((totalDiskIO / 500) * 100, 100)}%`;
                if (networkBar) networkBar.style.width = `${Math.min((totalNetworkIO / 200) * 100, 100)}%`;

                // Update system information
                const systemUptime = content.querySelector('#systemUptime');
                const totalProcesses = content.querySelector('#totalProcesses');
                const activeWindows = content.querySelector('#activeWindows');
                const memoryLimit = content.querySelector('#memoryLimit');

                if (systemUptime) systemUptime.textContent = this.formatUptime(Date.now() - (this.bootTime || Date.now()));
                if (totalProcesses) totalProcesses.textContent = this.runningProcesses.length;
                if (activeWindows) activeWindows.textContent = this.openWindows.size;
                if (memoryLimit) memoryLimit.textContent = `${this.allowedMemory} MB`;

                // Update process list
                this.updateProcessListDisplay(content);
            }

            // Line 1601: Process List Display Update Method
            updateProcessListDisplay(content) {
                const processList = content.querySelector('#processList');
                if (!processList) return;

                // Ensure we have processes to display
                if (!this.runningProcesses || this.runningProcesses.length === 0) {
                    this.runningProcesses = this.initializeProcesses();
                }

                // Sort processes by CPU usage (highest first)
                const sortedProcesses = [...this.runningProcesses].sort((a, b) => b.cpu - a.cpu);

                let html = '';
                sortedProcesses.forEach((process, index) => {
                    const uptime = this.formatUptime(Date.now() - process.startTime);
                    const cpuColor = process.cpu > 50 ? '#ff4757' : process.cpu > 25 ? '#ffa502' : '#2ed573';
                    const memoryColor = process.memory > 300 ? '#ff4757' : process.memory > 150 ? '#ffa502' : '#2ed573';

                    html += `
                        <div class="process-item" style="border-left: 3px solid ${process.critical ? '#007AFF' : '#4CAF50'};">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <span style="font-size: 1.2rem;">${process.icon}</span>
                                <div>
                                    <div class="process-name">${process.name}</div>
                                    <div style="font-size: 0.7rem; opacity: 0.6;">${process.pid} â€¢ ${uptime}</div>
                                </div>
                            </div>
                            <div style="color: ${cpuColor}; font-weight: 600;">${process.cpu.toFixed(1)}%</div>
                            <div style="color: ${memoryColor}; font-weight: 600;">${process.memory.toFixed(0)} MB</div>
                            <div class="process-disk">${process.disk || 0} KB/s</div>
                            <div class="process-network">${process.network || 0} KB/s</div>
                            <div style="font-size: 0.8rem;">
                                <span style="color: ${process.status === 'Running' ? '#2ed573' : '#ffa502'};">â—</span>
                                ${process.status || 'Running'}
                            </div>
                            <div>
                                ${process.critical ? 
                                    '<span style="color: #999; font-size: 0.8rem;">System</span>' : 
                                    `<button class="end-process-btn" onclick="namchaos.endProcess(${process.pid})" style="padding: 0.4rem 0.8rem; font-size: 0.8rem;">End Task</button>`
                                }
                            </div>
                        </div>
                    `;
                });
                processList.innerHTML = html;
            }

            // Update C: drive usage calculation
            updateDriveUsage() {
                const cDrive = this.getDirectoryContents('/C:');
                if (cDrive && cDrive.type === 'drive') {
                    let totalUsed = 0;

                    // Calculate total size of all files recursively
                    const calculateFolderSize = (folder) => {
                        let size = 0;
                        if (folder.children) {
                            for (const [name, item] of Object.entries(folder.children)) {
                                if (item.type === 'file') {
                                    size += item.size || 0;
                                } else if (item.type === 'folder') {
                                    size += calculateFolderSize(item);
                                }
                            }
                        }
                        return size;
                    };

                    totalUsed = calculateFolderSize(cDrive);

                    // Add some base OS files size
                    totalUsed += 2 * 1024 * 1024 * 1024; // 2GB base OS

                    // Update drive info
                    cDrive.used = totalUsed;
                    cDrive.available = cDrive.capacity - totalUsed;

                    this.saveFileSystem();
                }
            }

            // Line 1619: End Process Method
            endProcess(processIndex) {
                const process = this.systemResources.cpu.processes[processIndex];
                if (!process) return;

                // Don't allow ending system processes
                if (process.name.includes('System') || process.name.includes('Manager')) {
                    alert('Cannot end system process');
                    return;
                }

                // Close corresponding window if it's an app process
                for (const [appName, window] of this.openWindows) {
                    if (this.getAppTitle(appName) === process.name) {
                        this.closeWindow(appName);
                        break;
                    }
                }

                // Remove process from list
                this.systemResources.cpu.processes.splice(processIndex, 1);
            }

            // Line 1640: Memory Settings Update Method
            updateAllowedMemory(newMemory) {
                this.allowedMemory = parseInt(newMemory);
                localStorage.setItem('namchaos-allowed-memory', this.allowedMemory.toString());

                // Update memory totals
                this.systemResources.memory.total = this.allowedMemory;
                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;

                // If current usage exceeds new limit, adjust it
                if (this.systemResources.memory.used > this.allowedMemory) {
                    this.systemResources.memory.used = this.allowedMemory * 0.8; // Use 80% of new limit
                    this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;
                }

                // Update task manager display if open
                this.updateTaskManagerDisplay();
            }

            // Line 1650: Format Uptime Method
            formatUptime(milliseconds) {
                const seconds = Math.floor(milliseconds / 1000);
                const minutes = Math.floor(seconds / 60);
                const hours = Math.floor(minutes / 60);
                const days = Math.floor(hours / 24);

                if (days > 0) {
                    return `${days}d ${hours % 24}h ${minutes % 60}m`;
                } else if (hours > 0) {
                    return `${hours}h ${minutes % 60}m ${seconds % 60}s`;
                } else if (minutes > 0) {
                    return `${minutes}m ${seconds % 60}s`;
                } else {
                    return `${seconds}s`;
                }
            }

            // Line 1665: Update All Apps Resource Info Method
            updateAllAppsResourceInfo() {
                // Broadcast resource updates to all open applications
                this.openWindows.forEach((window, appName) => {
                    const titleElement = window.querySelector('.window-title');
                    if (titleElement && appName !== 'taskmanager') {
                        const process = this.runningProcesses.find(p => p.appId === appName);
                        if (process) {
                            // Update window title with resource info (subtle indication)
                            const baseTitle = this.getAppTitle(appName);
                            const cpuIndicator = process.cpu > 25 ? ' ðŸ”¥' : process.cpu > 10 ? ' âš¡' : '';
                            titleElement.textContent = baseTitle + cpuIndicator;
                        }
                    }
                });
            }

            // Line 1685: Enhanced End Process Method
            endProcess(pid) {
                const processIndex = this.runningProcesses.findIndex(p => p.pid === pid);
                if (processIndex === -1) return;

                const process = this.runningProcesses[processIndex];

                if (process.critical) {
                    this.showNotification('Cannot terminate system process', 'error');
                    return;
                }

                if (confirm(`Are you sure you want to end "${process.name}"?\n\nThis will close the application and may cause data loss.`)) {
                    // Close the app window if it's open
                    if (process.appId && this.openWindows.has(process.appId)) {
                        this.closeWindow(process.appId);
                    }

                    // Remove process from list
                    this.runningProcesses.splice(processIndex, 1);

                    // Free up memory
                    this.systemResources.memory.used -= process.memory;
                    this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;

                    this.showNotification(`Process "${process.name}" terminated`, 'success');
                    this.updateAllAppsResourceInfo();
                }
            }

            // Line 1710: Boot Time Initialization
            initBootTime() {
                if (!this.bootTime) {
                    this.bootTime = Date.now();
                }
            }

            // Line 1717: File System Initialization Method
            initFileSystem() {
                const saved = localStorage.getItem('namchaos-filesystem');
                if (saved) {
                    return JSON.parse(saved);
                }

                // Default file system structure with C: drive
                return {
                    '/': {
                        type: 'folder',
                        name: '',
                        created: new Date().toISOString(),
                        modified: new Date().toISOString(),
                        children: {
                            'C:': {
                                type: 'drive',
                                name: 'C:',
                                created: new Date().toISOString(),
                                modified: new Date().toISOString(),
                                capacity: 20 * 1024 * 1024 * 1024, // 20 GB in bytes
                                used: 0,
                                children: {
                                    'Users': {
                                        type: 'folder',
                                        name: 'Users',
                                        created: new Date().toISOString(),
                                        modified: new Date().toISOString(),
                                        children: {
                                            'User': {
                                                type: 'folder',
                                                name: 'User',
                                                created: new Date().toISOString(),
                                                modified: new Date().toISOString(),
                                                children: {
                                                    'Documents': {
                                                        type: 'folder',
                                                        name: 'Documents',
                                                        created: new Date().toISOString(),
                                                        modified: new Date().toISOString(),
                                                        children: {
                                                            'Welcome.txt': {
                                                                type: 'file',
                                                                name: 'Welcome.txt',
                                                                size: 1024,
                                                                created: new Date().toISOString(),
                                                                modified: new Date().toISOString(),
                                                                content: `
        Welcome to NamChaOS 1 Beta 2 Developer Release!

        Features:
        â€¢ Complete file system
        â€¢ Working text editor
        â€¢ Functional calculator
        â€¢ Web browser
        â€¢ Camera access
        â€¢ App Store with real installations
        â€¢ Download manager
        â€¢ Terminal commands
        â€¢ Task Manager with real resource monitoring
        â€¢ Memory management settings

        Updates:
        â€¢ Updated the browser app ui to look more safari
        â€¢ Support .ncapp which is an application file
        â€¢ Added ncAPP builder which is a program that lets you build a .ncapp file using nam programming language (.nam)
        â€¢ Enhanced Task Manager with real-time resource monitoring
        â€¢ Added memory allocation settings in System preferences
    `
                                                            },
                                                            'Notes.txt': {
                                                                type: 'file',
                                                                name: 'Notes.txt',
                                                                size: 512,
                                                                created: new Date().toISOString(),
                                                                modified: new Date().toISOString(),
                                                                content: 'This is a sample note file.\n\nYou can edit this content and save it.\nThe file system is fully functional!'
                                                            },
                                                            'SampleApp.ncapp': {
                                                                type: 'file',
                                                                name: 'SampleApp.ncapp',
                                                                size: 512,
                                                                created: new Date().toISOString(),
                                                                modified: new Date().toISOString(),
                                                                content: JSON.stringify({
                                                                    appId: 'sample-ncapp-demo',
                                                                    name: 'Sample NcApp',
                                                                    title: 'Sample NcApp Demo',
                                                                    version: '1.0',
                                                                    icon: 'ðŸš€',
                                                                    type: 'text',
                                                                    description: 'A sample .ncapp application demonstrating the NamChaOS app format',
                                                                    content: 'Welcome to NamChaOS .ncapp format!\n\nThis is a sample application packaged as a .ncapp file.\n\n.ncapp files can contain:\nâ€¢ Text-based applications\nâ€¢ Web applications (with URLs)\nâ€¢ HTML content\nâ€¢ Custom app configurations\n\nDouble-click .ncapp files in the Files app to launch them as applications!\n\nThis demonstrates how you can create custom applications for NamChaOS.'
                                                                }, null, 2)
                                                            }
                                                        }
                                                    },
                                                    'Pictures': { 
                                                        type: 'folder', 
                                                        name: 'Pictures',
                                                        created: new Date().toISOString(),
                                                        modified: new Date().toISOString(),
                                                        children: {} 
                                                    },
                                                    'Music': { 
                                                        type: 'folder', 
                                                        name: 'Music',
                                                        created: new Date().toISOString(),
                                                        modified: new Date().toISOString(),
                                                        children: {} 
                                                    },
                                                    'Downloads': { 
                                                        type: 'folder', 
                                                        name: 'Downloads',
                                                        created: new Date().toISOString(),
                                                        modified: new Date().toISOString(),
                                                        children: {} 
                                                    },
                                                    'Desktop': { 
                                                        type: 'folder', 
                                                        name: 'Desktop',
                                                        created: new Date().toISOString(),
                                                        modified: new Date().toISOString(),
                                                        children: {} 
                                                    }
                                                }
                                            },
                                            'Program Files': {
                                                type: 'folder',
                                                name: 'Program Files',
                                                created: new Date().toISOString(),
                                                modified: new Date().toISOString(),
                                                children: {}
                                            },
                                            'NamChaOS': {
                                                type: 'folder',
                                                name: 'NamChaOS',
                                                created: new Date().toISOString(),
                                                modified: new Date().toISOString(),
                                                children: {

                                                    'Configuration': {
                                                        type: 'folder',
                                                        name: 'Configuration',
                                                        created: new Date().toISOString(),
                                                        modified: new Date().toISOString(),
                                                        children: {}
                                                    },


                                                    'System': {
                                                        type: 'folder',
                                                        name: 'System',
                                                        created: new Date().toISOString(),
                                                        modified: new Date().toISOString(),
                                                        children: {}
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                };
            }

            // Line 1734: Load Installed Apps Method
            loadInstalledApps() {
                const apps = localStorage.getItem('namchaos-installed-apps');
                return apps ? JSON.parse(apps) : [];
            }

            // Line 1740: Save Installed Apps Method
            saveInstalledApps() {
                localStorage.setItem('namchaos-installed-apps', JSON.stringify(this.installedApps));
            }

            // Line 1745: Load Downloads Method
            loadDownloads() {
                const downloads = localStorage.getItem('namchaos-downloads');
                return downloads ? JSON.parse(downloads) : [];
            }

            // Line 1751: Save Downloads Method
            saveDownloads() {
                localStorage.setItem('namchaos-downloads', JSON.stringify(this.downloads));
            }

            // Line 1756: Load Contacts Method
            loadContacts() {
                const contacts = localStorage.getItem('namchaos-contacts');
                return contacts ? JSON.parse(contacts) : [];
            }

            // Line 1762: Save Contacts Method
            saveContacts() {
                localStorage.setItem('namchaos-contacts', JSON.stringify(this.contactList));
            }

            // Line 1767: Load Custom Settings Method
            loadCustomSettings() {
                const settings = localStorage.getItem('namchaos-custom-settings');
                return settings ? JSON.parse(settings) : {};
            }

            // Line 1773: Save Custom Settings Method
            saveCustomSettings() {
                localStorage.setItem('namchaos-custom-settings', JSON.stringify(this.customSettings));
            }

            // Line 1778: Load App Positions Method
            loadAppPositions() {
                const positions = localStorage.getItem('namchaos-app-positions');
                return positions ? JSON.parse(positions) : {};
            }

            // Line 1784: Save App Positions Method
            saveAppPositions() {
                localStorage.setItem('namchaos-app-positions', JSON.stringify(this.appPositions));
            }

            // Line 1789: Save File System Method
            saveFileSystem() {
                localStorage.setItem('namchaos-filesystem', JSON.stringify(this.fileSystem));
            }

            // Line 1794: Apply Custom Settings Method
            applyCustomSettings() {
                if (this.customSettings.username) {
                    document.getElementById('usernameDisplay').textContent = this.customSettings.username;
                }
                if (this.customSettings.background) {
                    this.applyBackground(this.customSettings.background);
                }
            }

            // Line 1803: Check for Updates Method
            checkForUpdates() {
                // Simulate update check
                setTimeout(() => {
                    if (Math.random() > 0.7) { // 30% chance of update
                        this.updateAvailable = true;
                    }
                }, 5000);
            }

            // Line 1812: Event Listeners Setup Method
            setupEventListeners() {
                // Install button event listener
                document.getElementById('installButton').addEventListener('click', () => {
                    this.startInstallation();
                });

                // App icon click event listeners
                document.querySelectorAll('.app-icon, .dock-icon, .start-app').forEach(icon => {
                    icon.addEventListener('click', (event) => {
                        const appName = icon.getAttribute('data-app');

                        // Don't open apps in edit mode (except start menu and dock icons)
                        if (this.isEditMode && icon.classList.contains('app-icon')) {
                            event.preventDefault();
                            event.stopPropagation();
                            return;
                        }

                        if (appName === 'start-menu') {
                            this.toggleStartMenu();
                        } else {
                            this.openApp(appName);
                            this.hideStartMenu();
                        }
                        event.stopPropagation();
                    });
                });

                // Setup gesture and interaction handlers
                this.setupSwipeGestures();
                this.setupAppDragging();
                this.setupEditMode();

                // Window resize handler
                window.addEventListener('resize', () => {
                    this.deviceType = this.detectDevice();
                    this.updateDeviceInfo();
                    // Recalculate window positions if needed
                    this.openWindows.forEach(window => {
                        const rect = window.getBoundingClientRect();
                        const maxX = window.offsetWidth;
                        const maxY = window.offsetHeight;
                        if (rect.left + maxX > window.innerWidth) {
                            window.style.left = `${window.innerWidth - maxX}px`;
                        }
                        if (rect.top + maxY > window.innerHeight) {
                            window.style.top = `${window.innerHeight - maxY}px`;
                        }
                    });
                });

                // Global click handler for menus and modals
                document.addEventListener('click', (event) => {
                    const startMenu = document.getElementById('startMenu');
                    const startButton = document.getElementById('startButton');
                    const controlCenter = document.getElementById('controlCenter');

                    if (event.target.classList.contains('power-button')) {
                        const action = event.target.dataset.action;
                        this.handlePowerAction(action);
                        return;
                    }

                    if (startMenu && !startMenu.contains(event.target) && !startButton.contains(event.target)) {
                        this.hideStartMenu();
                    }

                    if (controlCenter && !controlCenter.contains(event.target)) {
                        this.hideControlCenter();
                    }
                });

                // Enhanced drag system for windows and apps
                document.addEventListener('mousemove', (e) => {
                    if (this.isDragging && this.dragElement) {
                        e.preventDefault();
                        const x = e.clientX - this.dragOffset.x;
                        const y = e.clientY - this.dragOffset.y;

                        // Constrain to screen bounds
                        const maxX = window.innerWidth - this.dragElement.offsetWidth;
                        const maxY = window.innerHeight - this.dragElement.offsetHeight;

                        this.dragElement.style.left = Math.max(0, Math.min(maxX, x)) + 'px';
                        this.dragElement.style.top = Math.max(0, Math.min(maxY, y)) + 'px';
                    }

                    if (this.draggedApp) {
                        e.preventDefault();
                        this.draggedApp.style.left = (e.clientX - 35) + 'px';
                        this.draggedApp.style.top = (e.clientY - 35) + 'px';
                    }
                });

                // Touch move handler for mobile devices
                document.addEventListener('touchmove', (e) => {
                    if (this.isDragging && this.dragElement) {
                        e.preventDefault();
                        const touch = e.touches[0];
                        const x = touch.clientX - this.dragOffset.x;
                        const y = touch.clientY - this.dragOffset.y;

                        // Constrain to screen bounds
                        const maxX = window.innerWidth - this.dragElement.offsetWidth;
                        const maxY = window.innerHeight - this.dragElement.offsetHeight;

                        this.dragElement.style.left = Math.max(0, Math.min(maxX, x)) + 'px';
                        this.dragElement.style.top = Math.max(0, Math.min(maxY, y)) + 'px';
                    }

                    if (this.draggedApp) {
                        e.preventDefault();
                        const touch = e.touches[0];
                        this.draggedApp.style.left = (touch.clientX - 35) + 'px';
                        this.draggedApp.style.top = (touch.clientY - 35) + 'px';
                    }
                });

                // Mouse up handler for drag operations
                document.addEventListener('mouseup', (e) => {
                    if (this.isDragging) {
                        this.isDragging = false;
                        this.dragElement = null;
                        document.body.style.cursor = '';
                    }

                    if (this.draggedApp) {
                        this.dropApp(e);
                    }
                });

                // Touch end handler for mobile devices
                document.addEventListener('touchend', (e) => {
                    if (this.isDragging) {
                        this.isDragging = false;
                        this.dragElement = null;
                        document.body.style.cursor = '';
                    }

                    if (this.draggedApp) {
                        const touch = e.changedTouches[0];
                        this.dropApp({ clientX: touch.clientX, clientY: touch.clientY });
                    }
                });
            }

            // Line 1924: Clock Update Method
            updateClock() {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                const timeElement = document.getElementById('currentTime');
                if (timeElement) {
                    timeElement.textContent = timeString;
                }
            }

            // Line 1936: Device Info Update Method
            updateDeviceInfo() {
                const deviceElement = document.getElementById('deviceType');
                if (deviceElement) {
                    deviceElement.textContent = this.deviceType;
                }
            }

            // Line 1944: Show Installation Screen Method
            showInstallation() {
                document.getElementById('bootScreen').classList.add('hidden');
                document.getElementById('installScreen').classList.remove('hidden');
                this.currentState = 'install';
            }

            // Line 1951: Start Installation Process Method
            startInstallation() {
                const button = document.getElementById('installButton');
                const status = document.getElementById('installStatus');
                const progressFill = document.getElementById('progressFill');

                button.disabled = true;
                button.textContent = 'Installing...';

                const steps = [
                    'Preparing installation...',
                    'Copying system files...',
                    'Expanding system files...',
                    'Creating system directories...',
                    'Setting up system components...',
                    'Installing system components...',
                    'Setting up user environment...',
                    'Configuring system settings...',
                    'Installing applications...',
                    'Optimizing for ' + this.deviceType + '...',
                    'Finalizing installation...',
                    'Installation complete!'
                ];

                let currentStep = 0;
                const interval = setInterval(() => {
                    if (currentStep < steps.length) {
                        status.textContent = steps[currentStep];
                        progressFill.style.width = `${((currentStep + 1) / steps.length) * 100}%`;
                        currentStep++;
                    } else {
                        clearInterval(interval);
                        setTimeout(() => {
                            localStorage.setItem('namchaos-installed', 'true');
                            this.isInstalled = true;
                            this.showDesktop();
                        }, 900);
                    }
                }, 1000);
            }

            // Line 1985: Show Desktop Method
            showDesktop() {
                document.getElementById('bootScreen').classList.add('hidden');
                document.getElementById('installScreen').classList.add('hidden');
                document.getElementById('desktop').classList.remove('hidden');
                this.currentState = 'desktop';
            }

            // Line 1993: Open Application Method
            openApp(appName, title, content) {
                if (this.openWindows.has(appName)) {
                    const window = this.openWindows.get(appName);
                    window.style.zIndex = ++this.windowZIndex;
                    window.style.display = 'block';
                    return;
                }

                const window = this.createWindow(appName, title, content);
                this.openWindows.set(appName, window);
                document.getElementById('desktop').appendChild(window);

                // Auto-fullscreen on mobile and tablet
                if (this.deviceType === 'iPhone' || this.deviceType === 'Tablet') {
                    window.classList.add('fullscreen');
                }

                const dockIcon = document.querySelector(`.dock-icon[data-app="${appName}"]`);
                if (dockIcon) {
                    dockIcon.classList.add('active');
                }

                this.initializeApp(appName, window);
            }

            // Line 2016: CreateWindow Method
            createWindow(appName, title, content) {
                const window = document.createElement('div');
                window.className = 'window';
                window.style.top = `${60 + this.openWindows.size * 30}px`;
                window.style.left = `${120 + this.openWindows.size * 30}px`;
                window.style.zIndex = ++this.windowZIndex;

                // Add process for this app
                this.addProcess(title || this.getAppTitle(appName), appName, this.getAppIcon(appName), 
                    Math.floor(Math.random() * 150) + 50);

                const header = document.createElement('div');
                header.className = 'window-header';

                const windowTitle = document.createElement('div');
                windowTitle.className = 'window-title';
                windowTitle.textContent = title || this.getAppTitle(appName);

                const controls = document.createElement('div');
                controls.className = 'window-controls';

                const minimize = document.createElement('div');
                minimize.className = 'window-control minimize';
                minimize.setAttribute('role', 'button');
                minimize.setAttribute('tabindex', '0');

                const maximize = document.createElement('div');
                maximize.className = 'window-control maximize';
                maximize.setAttribute('role', 'button');
                maximize.setAttribute('tabindex', '0');

                const close = document.createElement('div');
                close.className = 'window-control close';
                close.setAttribute('role', 'button');
                close.setAttribute('tabindex', '0');

                // Enhanced event handlers for better mobile support
                const addControlEvents = (control, action) => {
                    const handler = (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        action();
                    };

                    control.addEventListener('click', handler);
                    control.addEventListener('touchend', handler);
                    control.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            e.stopPropagation();
                            action();
                        }
                    });
                };

                addControlEvents(minimize, () => this.minimizeWindow(appName));
                addControlEvents(maximize, () => this.toggleFullscreen(window));
                addControlEvents(close, () => this.closeWindow(appName));

                controls.appendChild(minimize);
                controls.appendChild(maximize);
                controls.appendChild(close);
                header.appendChild(windowTitle);
                header.appendChild(controls);

                const windowContent = document.createElement('div');
                windowContent.className = 'window-content';
                windowContent.innerHTML = content || this.getAppContent(appName);

                window.appendChild(header);
                window.appendChild(windowContent);

                this.makeDraggable(window, header);

                return window;
            }

            // Line 2066: Get Application Title Method
            getAppTitle(appName) {
                const titles = {
                    'files': 'File Manager',
                    'notes': 'Notes',
                    'calculator': 'Calculator',
                    'browser': 'Safari',
                    'settings': 'System Preferences',
                    'photos': 'Photos',
                    'music': 'Music',
                    'camera': 'Camera',
                    'appstore': 'App Store',
                    'downloader': 'Download Manager',
                    'terminal': 'Terminal',
                    'paint': 'Paint',
                    'clock': 'Clock',
                    'contacts': 'Contacts',
                    'voice-recorder': 'Voice Recorder',
                    'maps': 'Maps',
                    'mail': 'Mail',
                    'taskmanager': 'Task Manager',
                    'nam-interpreter': 'NAM Interpreter',
                    'mytube': 'MyTube'
                };
                return titles[appName] || appName;
            }

            // Line 2089: Get Application Content Method
            getAppContent(appName) {
                switch (appName) {
                    case 'taskmanager':
                        return `
                            <div class="task-manager-container">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                    <h3 style="color: white; margin: 0;">Task Manager</h3>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button class="btn" id="refreshProcesses" style="padding: 0.5rem 1rem;">ðŸ”„ Refresh</button>
                                        <button class="btn" id="killAllApps" style="padding: 0.5rem 1rem; background: #ff4757; color: white;">âš ï¸ End All Apps</button>
                                    </div>
                                </div>

                                <div class="resource-monitor">
                                    <div class="resource-card">
                                        <div class="resource-title">CPU Usage</div>
                                        <div class="resource-value" id="cpuUsageValue">0%</div>
                                        <div class="resource-bar">
                                            <div class="resource-fill cpu-fill" style="width: 0%"></div>
                                        </div>
                                        <div style="font-size: 0.8rem; color: #ccc;" id="cpuDetails">0 processes running</div>
                                    </div>

                                    <div class="resource-card">
                                        <div class="resource-title">Memory Usage</div>
                                        <div class="resource-value" id="memoryUsageValue">0%</div>
                                        <div class="resource-bar">
                                            <div class="resource-fill memory-fill" style="width: 0%"></div>
                                        </div>
                                        <div style="font-size: 0.8rem; color: #ccc;" id="memoryDetails">${this.systemResources.memory.used} MB / ${this.allowedMemory} MB</div>
                                    </div>

                                    <div class="resource-card">
                                        <div class="resource-title">Disk I/O</div>
                                        <div class="resource-value" id="diskUsageValue">0 KB/s</div>
                                        <div class="resource-bar">
                                            <div class="resource-fill disk-fill" style="width: 0%"></div>
                                        </div>
                                        <div style="font-size: 0.8rem; color: #ccc;" id="diskDetails">Read/Write activity</div>
                                    </div>

                                    <div class="resource-card">
                                        <div class="resource-title">Network I/O</div>
                                        <div class="resource-value" id="networkUsageValue">0 KB/s</div>
                                        <div class="resource-bar">
                                            <div class="resource-fill network-fill" style="width: 0%"></div>
                                        </div>
                                        <div style="font-size: 0.8rem; color: #ccc;" id="networkDetails">â†“0 KB/s â†‘0 KB/s</div>
                                    </div>
                                </div>

                                <div class="process-list">
                                    <div class="process-header">
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            <span>Process Name</span>
                                            <span style="font-size: 0.7rem; opacity: 0.7;">(PID)</span>
                                        </div>
                                        <div>CPU %</div>
                                        <div>Memory</div>
                                        <div>Disk I/O</div>
                                        <div>Network</div>
                                        <div>Status</div>
                                        <div>Action</div>
                                    </div>
                                    <div id="processList" style="max-height: 400px; overflow-y: auto;">
                                        <!-- Process list will be populated dynamically -->
                                    </div>
                                </div>

                                <div style="margin-top: 1rem; padding: 1rem; background: var(--liquid-glass); border-radius: 16px; border: 1px solid var(--glass-border);">
                                    <h4 style="color: white; margin-bottom: 0.5rem;">System Information</h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; font-size: 0.85rem; color: #ccc;">
                                        <div>Uptime: <span id="systemUptime">0:00:00</span></div>
                                        <div>Total Processes: <span id="totalProcesses">0</span></div>
                                        <div>Active Windows: <span id="activeWindows">0</span></div>
                                        <div>Memory Limit: <span id="memoryLimit">${this.allowedMemory} MB</span></div>
                                    </div>
                                </div>
                            </div>
                        `;

                    case 'files':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <button class="btn" data-action="back">â† Back</button>
                                    <div class="path-display" id="currentPath">/</div>
                                    <button class="btn" data-action="newfolder">New Folder</button>
                                    <button class="btn" data-action="delete">Delete</button>
                                </div>
                                <div class="file-explorer" id="fileExplorer">
                                    <!-- File list will be populated here -->
                                </div>
                            </div>
                        `;

                    case 'notes':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <button class="btn" data-action="new">New</button>
                                    <button class="btn btn-primary" data-action="save">Save</button>
                                    <button class="btn" data-action="open">Open</button>
                                    <input type="text" id="noteFilename" placeholder="Filename" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 8px; margin-left: 1rem;">
                                </div>
                                <textarea id="noteTextarea" style="width: 100%; flex: 1; border: none; padding: 15px; font-family: 'Monaco', 'Menlo', 'Consolas', monospace; font-size: 1rem; resize: none; outline: none;" placeholder="Start typing your note..."></textarea>
                            </div>
                        `;

                    case 'calculator':
                        return `
                            <div style="padding: 1.5rem; background: #000; color: white; height: 100%; display: flex; flex-direction: column;">
                                <input type="text" id="calcDisplay" readonly style="width: 100%; padding: 1rem; font-size: 2rem; text-align: right; background: #333; color: white; border: none; border-radius: 8px; margin-bottom: 1rem;">
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; flex: 1;">
                                    <button class="calc-btn" style="background: #666; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">Clear</button>
                                    <button class="calc-btn" style="background: #666; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">Â±</button>
                                    <button class="calc-btn" style="background: #666; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">%</button>
                                    <button class="calc-btn" style="background: #ff9500; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">Ã·</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">7</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">8</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">9</button>
                                    <button class="calc-btn" style="background: #ff9500; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">Ã—</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">4</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">5</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">6</button>
                                    <button class="calc-btn" style="background: #ff9500; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">âˆ’</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">1</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">2</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">3</button>
                                    <button class="calc-btn" style="background: #ff9500; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">+</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer; grid-column: span 2;">0</button>
                                    <button class="calc-btn" style="background: #333; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">.</button>
                                    <button class="calc-btn" style="background: #ff9500; color: white; border: none; border-radius: 8px; font-size: 1.2rem; cursor: pointer;">=</button>
                                </div>
                            </div>
                        `;

                    case 'browser':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <button class="btn" id="browserBack">â†</button>
                                    <button class="btn" id="browserForward">â†’</button>
                                    <input type="text" id="browserUrl" placeholder="Enter URL or search..." style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 20px; margin: 0 1rem;">
                                    <button class="btn btn-primary" id="browserGo">Go</button>
                                </div>
                                <iframe id="browserFrame" style="flex: 1; border: none; width: 100%;" src="about:blank"></iframe>
                            </div>
                        `;

                    case 'camera':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column; background: #000;">
                                <video id="cameraVideo" autoplay style="flex: 1; width: 100%; object-fit: cover;"></video>
                                <canvas id="cameraCanvas" style="display: none;"></canvas>
                                <div style="padding: 1rem; display: flex; justify-content: center; gap: 1rem; background: rgba(0,0,0,0.8);">
                                    <button id="capturePhoto" class="btn btn-primary" style="border-radius: 50%; width: 60px; height: 60px; font-size: 1.5rem;">ðŸ“·</button>
                                </div>
                                <div id="photoGallery" style="display: flex; gap: 0.5rem; padding: 1rem; overflow-x: auto; background: rgba(0,0,0,0.8);">
                                    <!-- Captured photos will appear here -->
                                </div>
                            </div>
                        `;

                    case 'photos':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <h3 style="margin: 0; color: var(--text-primary);">Photos</h3>
                                    <input type="file" id="musicFileInput" accept="audio/*" multiple style="display: none;">
                                    <button class="btn btn-primary" onclick="namchaos.openApp('camera')">Take Photo</button>
                                </div>
                                <div id="photosGallery" style="flex: 1; padding: 1rem; overflow-y: auto;">
                                    <!-- Photos will be loaded here -->
                                </div>
                            </div>
                        `;

                    case 'music':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <h3 style="margin: 0; color: var(--text-primary);">Music</h3>
                                    <input type="file" id="musicFileInput" accept="audio/*" multiple style="display: none;">
                                    <button class="btn btn-primary" id="importMusicBtn">Import Music</button>
                                    <button class="btn" id="clearMusicBtn">Clear Library</button>
                                </div>
                                <div id="musicLibrary" style="flex: 1; padding: 1rem; overflow-y: auto;">
                                    <div id="musicList" style="display: flex; flex-direction: column; gap: 1rem;">
                                        <div style="text-align: center; color: white; padding: 2rem;">
                                            <div style="font-size: 4rem; margin-bottom: 1rem;">ðŸŽµ</div>
                                            <h3 style="color: white;">Music Library</h3>
                                            <p style="color: #ccc;">No music in your library</p>
                                            <p style="color: #999; font-size: 0.9rem;">Click "Import Music" to add audio files</p>
                                        </div>
                                    </div>
                                </div>
                                <div id="musicPlayer" style="display: none; background: var(--liquid-glass); backdrop-filter: blur(20px); padding: 1rem; border-top: 1px solid var(--glass-border);">
                                    <div style="display: flex; align-items: center; gap: 1rem; color: white;">
                                        <div style="flex: 1;">
                                            <div id="currentSongTitle" style="font-weight: 600; margin-bottom: 0.25rem;">No song selected</div>
                                            <div id="currentSongTime" style="font-size: 0.8rem; opacity: 0.8;">00:00 / 00:00</div>
                                        </div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button id="prevBtn" class="btn">â®ï¸</button>
                                            <button id="playPauseBtn" class="btn btn-primary">â–¶ï¸</button>
                                            <button id="nextBtn" class="btn">â­ï¸</button>
                                        </div>
                                        <input type="range" id="volumeSlider" min="0" max="100" value="50" style="width: 100px;">
                                    </div>
                                    <input type="range" id="progressSlider" min="0" max="100" value="0" style="width: 100%; margin-top: 0.5rem;">
                                </div>
                            </div>
                        `;

                    case 'appstore':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <h3 style="margin: 0; color: var(--text-primary);">App Store</h3>
                                    <input type="text" placeholder="Search apps..." style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 8px; margin-left: 1rem;">
                                </div>
                                <div id="appStoreContent" style="flex: 1; padding: 1rem; overflow-y: auto;">
                                    <!-- App store content will be rendered here -->
                                </div>
                            </div>
                        `;

                    case 'downloader':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <input type="text" id="downloadUrl" placeholder="Enter URL to download..." style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 8px;">
                                    <button id="startDownloadBtn" class="btn btn-primary">Download</button>
                                </div>
                                <div id="downloadContent" style="flex: 1; padding: 1rem; overflow-y: auto;">
                                    <!-- Download manager content will be rendered here -->
                                </div>
                            </div>
                        `;

                    case 'terminal':
                        return `
                            <div style="height: 100%; background: #000; color: #00ff00; font-family: 'Courier New', monospace; padding: 1rem; overflow-y: auto;">
                                <div id="terminalOutput">NamChaOS Terminal v1.0 Beta 2<br>Type 'help' for available commands.<br><br></div>
                                <div style="display: flex;">
                                    <span>user@namchaos:~$ </span>
                                    <input id="terminalInput" type="text" style="flex: 1; background: transparent; border: none; outline: none; color: #00ff00; font-family: inherit;">
                                </div>
                            </div>
                        `;

                    case 'paint':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar" style="flex-wrap: wrap; gap: 0.5rem;">
                                    <button id="paintBrush" class="btn btn-primary">ðŸ–Œï¸ Brush</button>
                                    <button id="paintEraser" class="btn">ðŸ§½ Eraser</button>
                                    <button id="paintLine" class="btn">ðŸ“ Line</button>
                                    <button id="paintRect" class="btn">â¬œ Rectangle</button>
                                    <button id="paintCircle" class="btn">â­• Circle</button>
                                    <input type="color" id="paintColor" value="#000000" style="width: 40px; height: 30px; border: 1px solid #ddd; cursor: pointer; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span>Size:</span>
                                        <input type="range" id="brushSize" min="1" max="50" value="5" style="width: 100px;">
                                        <span id="brushSizeDisplay">5</span>
                                    </div>
                                    <button id="clearCanvas" class="btn">Clear</button>
                                    <button id="saveCanvas" class="btn btn-primary">Save</button>
                                </div>
                                <canvas id="paintCanvas" style="flex: 1; cursor: crosshair; background: white; border-radius: 0 0 16px 16px; touch-action: none;"></canvas>
                            </div>
                        `;

                    case 'clock':
                        return `
                            <div style="padding: 2rem; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center;">
                                <div id="digitalClock" style="font-size: 3rem; font-weight: 200; margin-bottom: 1rem; color: var(--primary-blue);"></div>
                                <div id="dateDisplay" style="font-size: 1.2rem; color: var(--text-secondary); margin-bottom: 2rem;"></div>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem;">
                                    <div style="background: #f9f9f9; padding: 1rem; border-radius: 12px;">
                                        <div style="font-size: 1.5rem; font-weight: 600;">ðŸŒ</div>
                                        <div style="font-size: 0.9rem; color: #666;">UTC</div>
                                        <div id="utcTime" style="font-weight: 500;"></div>
                                    </div>
                                    <div style="background: #f9f9f9; padding: 1rem; border-radius: 12px;">
                                        <div style="font-size: 1.5rem; font-weight: 600;">â°</div>
                                        <div style="font-size: 0.9rem; color: #666;">Stopwatch</div>
                                        <div id="stopwatch" style="font-weight: 500;">00:00:00</div>
                                    </div>
                                </div>
                            </div>
                        `;

                    case 'contacts':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <button class="btn btn-primary" id="addContact">Add Contact</button>
                                    <input type="text" placeholder="Search contacts..." style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 8px;">
                                </div>
                                <div style="flex: 1; padding: 1rem;">
                                    <div id="contactsList" style="display: flex; flex-direction: column; gap: 1rem;">
                                        <div style="text-align: center; color: #999; padding: 2rem;">No contacts yet. Click "Add Contact" to get started.</div>
                                    </div>
                                </div>
                            </div>
                        `;

                    case 'voice-recorder':
                        return `
                            <div style="height: 100%; padding: 2rem; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                <div style="margin-bottom: 2rem; text-align: center;">
                                    <div style="font-size: 4rem; margin-bottom: 1rem;">ðŸŽ™ï¸</div>
                                    <h3>Voice Recorder</h3>
                                    <p style="color: #666;">Record high-quality audio</p>
                                </div>
                                <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
                                    <button id="startRecord" class="btn btn-primary">ðŸ”´ Record</button>
                                    <button id="stopRecord" class="btn" disabled>â¹ï¸ Stop</button>
                                    <button id="playRecord" class="btn" disabled>â–¶ï¸ Play</button>
                                </div>
                                <div id="recordingsList" style="width: 100%; max-width: 400px;">
                                    <h4>Recordings</h4>
                                    <div style="text-align: center; color: #999; padding: 1rem;">No recordings yet</div>
                                </div>
                            </div>
                        `;

                    case 'maps':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <input type="text" placeholder="Search for a place..." style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 8px;">
                                    <button class="btn btn-primary">Search</button>
                                    <button class="btn" id="myLocation">ðŸ“ My Location</button>
                                </div>
                                <div style="flex: 1; background: #e8f4f8; display: flex; align-items: center; justify-content: center; position: relative;">
                                    <div style="text-align: center; color: #666;">
                                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸ—ºï¸</div>
                                        <h3>Interactive Map</h3>
                                        <p>Location services would be available here</p>
                                    </div>
                                </div>
                            </div>
                        `;

                    case 'mail':
                        return `
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <div class="toolbar">
                                    <button class="btn btn-primary" onclick="alert('Compose mail functionality not implemented')">ðŸ“ Compose</button>
                                    <button class="btn" onclick="alert('Inbox loading not implemented')">ðŸ“¥ Inbox</button>
                                    <button class="btn" onclick="alert('Sent items loading not implemented')">ðŸ“¤ Sent</button>
                                    <button class="btn" onclick="alert('Trash loading not implemented')">ðŸ—‘ï¸ Trash</button>
                                </div>
                                <div style="flex: 1; padding: 1rem;">
                                    <div style="text-align: center; color: white; padding: 3rem;">
                                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸ“§</div>
                                        <h3 style="color: white;">Mail</h3>
                                        <p style="color: #ccc;">Your inbox is empty</p>
                                        <button class="btn btn-primary" style="margin-top: 1rem;" onclick="alert('Account setup not implemented')">Set up account</button>
                                    </div>
                                </div>
                            </div>
                        `;

                    case 'mytube':
                        return `
                            <h1>MyTube</h1>
                            <div>
                                <div>Longs</div>
                                <div>Quicks</div>
                            </div>
                        `;

                    case 'admin':
                        return `
                            <div>Enter admin password to access</div>
                            <input type="text" placeholder="Enter admin password" id="adminPassword">
                            <button>Login</button>
                            
                        `;

                    case 'settings':
                        return `
                            <div style="padding: 1.5rem; height: 100%; overflow-y: auto;">
                                <h3 style="margin-bottom: 1.5rem; color: white;">System Settings</h3>
                                <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                                    <div style="padding: 1.5rem; background: var(--liquid-glass); border-radius: 16px; border: 1px solid var(--glass-border); backdrop-filter: blur(20px);">
                                        <h4 style="margin-bottom: 1rem; color: white;">Personalization</h4>
                                        <div style="margin-bottom: 1rem;">
                                            <label style="display: block; margin-bottom: 0.5rem; color: white;">Username:</label>
                                            <input type="text" id="usernameInput" placeholder="Enter username" style="width: 100%; padding: 8px; border: 1px solid var(--glass-border); border-radius: 8px; background: var(--liquid-glass); color: white; backdrop-filter: blur(10px);">
                                            <button onclick="namchaos.changeUsername()" class="btn btn-primary" style="margin-top: 0.5rem;">Save Username</button>
                                        </div>
                                        <div style="margin-bottom: 1rem;">
                                            <label style="display: block; margin-bottom: 0.5rem; color: white;">Background:</label>
                                            <select id="backgroundSelect" style="width: 100%; padding: 8px; border: 1px solid var(--glass-border); border-radius: 8px; background: var(--liquid-glass); color: white; backdrop-filter: blur(10px);">
                                                <option value="gradient1">Ocean Blue</option>
                                                <option value="gradient2">Sunset Orange</option>
                                                <option value="gradient3">Forest Green</option>
                                                <option value="gradient4">Purple Haze</option>
                                                <option value="gradient5">Rose Gold</option>
                                                <option value="solid1">Deep Space</option>
                                                <option value="solid2">Midnight Blue</option>
                                            </select>
                                            <button onclick="namchaos.changeBackground()" class="btn btn-primary" style="margin-top: 0.5rem;">Apply Background</button>
                                        </div>
                                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: white;">
                                            <input type="checkbox" style="cursor: pointer;" onchange="document.body.classList.toggle('dark-mode')">
                                            <span>Dark Mode</span>
                                        </label>
                                    </div>
                                    <div style="padding: 1.5rem; background: var(--liquid-glass); border-radius: 16px; border: 1px solid var(--glass-border); backdrop-filter: blur(20px);">
                                        <h4 style="margin-bottom: 1rem; color: white;">Glass Effects</h4>
                                        <div style="margin-bottom: 1rem;">
                                            <label style="display: block; margin-bottom: 0.5rem; color: white;">Blur Intensity:</label>
                                            <input type="range" id="blurRange" min="10" max="50" value="30" style="width: 100%;" onchange="namchaos.updateBlurIntensity(this.value)">
                                            <span id="blurValue" style="color: white;">30px</span>
                                        </div>
                                        <div style="margin-bottom: 1rem;">
                                            <label style="display: block; margin-bottom: 0.5rem; color: white;">Glass Opacity:</label>
                                            <input type="range" id="opacityRange" min="5" max="25" value="8" style="width: 100%;" onchange="namchaos.updateGlassOpacity(this.value)">
                                            <span id="opacityValue" style="color: white;">8%</span>
                                        </div>
                                    </div>
                                    <div style="padding: 1.5rem; background: var(--liquid-glass); border-radius: 16px; border: 1px solid var(--glass-border); backdrop-filter: blur(20px);">
                                        <h4 style="margin-bottom: 1rem; color: white;">Device Information</h4>
                                        <p style="margin: 0.5rem 0; color: #ccc;">User: <span id="currentUsername">${localStorage.getItem('namchaos-username') || 'User'}</span></p>
                                        <p style="margin: 0.5rem 0; color: #ccc;">Device: ${this.deviceType}</p>
                                        <p style="margin: 0.5rem 0; color: #ccc;">OS: NamChaOS 1 Beta 2</p>
                                        <p style="margin: 0.5rem 0; color: #ccc;">Build: NCO1.0Beta2-DR</p>
                                    </div>
                                    <div style="padding: 1.5rem; background: var(--liquid-glass); border-radius: 16px; border: 1px solid var(--glass-border); backdrop-filter: blur(20px);">
                                        <h4 style="margin-bottom: 1rem; color: white;">System</h4>
                                        <div class="memory-settings-section">
                                            <h5 style="color: white; margin-bottom: 1rem;">Memory Management</h5>
                                            <div class="memory-setting-item">
                                                <span class="memory-setting-label">Allowed Memory:</span>
                                                <span class="memory-setting-value">${this.allowedMemory} MB</span>
                                            </div>
                                            <div class="memory-setting-item">
                                                <span class="memory-setting-label">Memory Limit:</span>
                                                <input type="range" class="memory-slider" min="512" max="3072" step="512" value="${this.allowedMemory}" onchange="namchaos.updateAllowedMemory(this.value)">
                                            </div>
                                            <div class="memory-setting-item">
                                                <span class="memory-setting-label">Current Usage:</span>
                                                <span class="memory-setting-value">${this.systemResources.memory.used} MB</span>
                                            </div>
                                            <button onclick="namchaos.openApp('taskmanager')" class="btn btn-primary" style="margin-top: 1rem;">Open Task Manager</button>
                                        </div>
                                        <div style="margin-top: 1.5rem;">
                                            <h5 style="color: white; margin-bottom: 1rem;">Security</h5>
                                            <div style="margin-bottom: 1rem;">
                                                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: white; margin-bottom: 0.5rem;">
                                                    <input type="checkbox" id="lockScreenToggle" style="cursor: pointer;" onchange="namchaos.toggleLockScreen(this.checked)">
                                                    <span>Enable Lock Screen</span>
                                                </label>
                                                <div style="margin-bottom: 0.5rem;">
                                                    <input type="password" id="newPasswordInput" placeholder="New password (leave empty to keep current)" style="width: 70%; padding: 8px; border: 1px solid var(--glass-border); border-radius: 8px; background: var(--liquid-glass); color: white; backdrop-filter: blur(10px);">
                                                    <button onclick="namchaos.changePassword()" class="btn btn-primary" style="margin-left: 0.5rem;">Change Password</button>
                                                </div>
                                            </div>
                                            <button onclick="namchaos.lockNow()" class="btn" style="margin-right: 0.5rem;">Lock Now</button>
                                            <button onclick="namchaos.triggerUpdate()" class="btn btn-primary" style="margin-right: 0.5rem;">Check for Updates</button>
                                            <button onclick="namchaos.resetSystem()" class="btn" style="background: #ff6b6b; color: white;">Reset System</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;

                    default:
                        return `
                            <div style="padding: 20px; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center;">
                                <div style="font-size: 4rem; margin-bottom: 20px;">ðŸ“±</div>
                                <h2>Application</h2>
                                <p>This app is under development</p>
                            </div>
                        `;
                }
            }

            // Line 2456: Initialize Application Method
            initializeApp(appName, window) {
                const content = window.querySelector('.window-content');

                switch (appName) {
                    case 'taskmanager':
                        this.initializeTaskManagerApp(content);
                        break;
                    case 'files':
                        this.initializeFilesApp(content);
                        break;
                    case 'notes':
                        this.initializeNotesApp(content);
                        break;
                    case 'calculator':
                        this.initializeCalculatorApp(content);
                        break;
                    case 'browser':
                        this.initializeBrowserApp(content);
                        break;
                    case 'camera':
                        this.initializeCameraApp(content);
                        break;
                    case 'appstore':
                        this.initializeAppStoreApp(content);
                        break;
                    case 'downloader':
                        this.initializeDownloaderApp(content);
                        break;
                    case 'terminal':
                        this.initializeTerminalApp(content);
                        break;
                    case 'paint':
                        this.initializePaintApp(content);
                        break;
                    case 'clock':
                        this.initializeClockApp(content);
                        break;
                    case 'contacts':
                        this.initializeContactsApp(content);
                        break;
                    case 'voice-recorder':
                        this.initializeVoiceRecorderApp(content);
                        break;
                    case 'maps':
                        this.initializeMapsApp(content);
                        break;
                    case 'music':
                        this.initializeMusicApp(content);
                        break;
                    case 'photos':
                        this.initializePhotosApp(content);
                        break;
                    case 'settings':
                        this.initializeSettingsApp(content);
                        break;
                    case 'nam-interpreter':
                        this.initializeNamInterpreterApp(content);
                        break;
                }
            }

            // Line 2497: Initialize Task Manager App Method
            initializeTaskManagerApp(content) {
                // Ensure we have running processes
                if (!this.runningProcesses || this.runningProcesses.length === 0) {
                    this.runningProcesses = this.initializeProcesses();
                }

                // Task manager is automatically updated by the resource monitoring system
                // Initial update to populate the display
                this.updateTaskManagerDisplay(content);

                // Set up event handlers for task manager controls
                const refreshBtn = content.querySelector('#refreshProcesses');
                const killAllBtn = content.querySelector('#killAllApps');

                if (refreshBtn) {
                    refreshBtn.addEventListener('click', () => {
                        this.updateSystemResources();
                        this.updateTaskManagerDisplay(content);
                        this.showNotification('Process list refreshed', 'info');
                    });
                }

                if (killAllBtn) {
                    killAllBtn.addEventListener('click', () => {
                        if (confirm('This will close all running applications. Are you sure?')) {
                            this.killAllNonCriticalProcesses();
                        }
                    });
                }

                // Real-time updates specific to task manager
                this.taskManagerUpdateInterval = setInterval(() => {
                    if (this.openWindows.has('taskmanager')) {
                        const taskManagerWindow = this.openWindows.get('taskmanager');
                        const windowContent = taskManagerWindow.querySelector('.window-content');
                        if (windowContent) {
                            this.updateTaskManagerDisplay(windowContent);
                        }
                    }
                }, 250); // Update every 250ms when task manager is open
            }

            // Line 2530: Kill All Non-Critical Processes Method
            killAllNonCriticalProcesses() {
                const nonCriticalProcesses = this.runningProcesses.filter(p => !p.critical);
                let killedCount = 0;

                nonCriticalProcesses.forEach(process => {
                    if (process.appId && this.openWindows.has(process.appId)) {
                        this.closeWindow(process.appId);
                        killedCount++;
                    }
                });

                // Remove all non-critical processes
                this.runningProcesses = this.runningProcesses.filter(p => p.critical);

                // Recalculate memory usage
                this.systemResources.memory.used = this.runningProcesses.reduce((sum, p) => sum + p.memory, 0);
                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;

                this.showNotification(`Terminated ${killedCount} applications`, 'success');
                this.updateAllAppsResourceInfo();
            }

            // Line 2504: Initialize Files App Method
            initializeFilesApp(content) {
                // Ensure we start in the root directory
                this.currentDirectory = '/';
                this.selectedFiles.clear();
                this.renderFileExplorer(content);

                content.addEventListener('click', (e) => {
                    if (e.target.dataset.action) {
                        this.handleFileAction(e.target.dataset.action, content);
                    } else if (e.target.classList.contains('file-item')) {
                        const fileName = e.target.dataset.filename;
                        const fileType = e.target.dataset.filetype;

                        if (fileType === 'folder' || fileType === 'drive') {
                            this.navigateToFolder(fileName, content);
                        } else {
                            this.openFile(this.currentDirectory, fileName); // Pass currentDirectory
                        }
                    }
                });
            }

            // Line 2522: Initialize Settings App Method
            initializeSettingsApp(content) {
                // Settings app initialization is handled in the getAppContent method
                // All event handlers are set up inline in the HTML
            }

            // Line 2528: Render File Explorer Method
            renderFileExplorer(content) {
                const pathElement = content.querySelector('#currentPath');
                const explorerElement = content.querySelector('#fileExplorer');

                // Ensure we're showing the current directory path correctly
                if (pathElement) {
                    pathElement.textContent = this.currentDirectory || '/';
                }

                // Make sure we're in root if currentDirectory is undefined or empty
                if (!this.currentDirectory || this.currentDirectory === '') {
                    this.currentDirectory = '/';
                }

                const currentFolder = this.getDirectoryContents(this.currentDirectory);
                if (!currentFolder || !currentFolder.children) {
                    if (explorerElement) {
                        explorerElement.innerHTML = '<div style="text-align: center; color: #999; padding: 2rem;">Invalid directory</div>';
                    }
                    return;
                }

                let html = '';
                for (const [name, item] of Object.entries(currentFolder.children)) {
                    const isSelected = this.selectedFiles.has(name);
                    const icon = item.type === 'folder' ? 'ðŸ“' : this.getFileIcon(name);
                    const size = item.type === 'folder' ? 'Folder' : this.formatFileSize(item.size || 0);
                    const modified = new Date(item.modified).toLocaleDateString();

                    if (item.type === 'drive') {
                        const driveInfo = this.getDriveInfo(name);
                        html += `
                        <div class="file-item drive" data-filename="${name}" data-filetype="${item.type}" style="background: linear-gradient(45deg, #f0f8ff, #e6f3ff); border: 2px solid #007acc; margin-bottom: 0.5rem;">
                            <div class="file-icon" style="font-size: 2rem;">${this.getDriveIcon(name)}</div>
                            <div class="file-info">
                                <div class="file-name" style="font-weight: bold; color: #007acc;">${name}</div>
                                <div class="file-details">Local Disk â€¢ ${driveInfo ? driveInfo.used + ' / ' + driveInfo.total + ' (' + driveInfo.percentage + '% used)' : '20 GB capacity'}</div>
                            </div>
                        </div>
                    `;
                    } else if (item.type === 'folder') {
                        html += `
                        <div class="file-item folder ${isSelected ? 'selected' : ''}" data-filename="${name}" data-filetype="${item.type}">
                            <div class="file-icon">ðŸ“</div>
                            <div class="file-info">
                                <div class="file-name">${name}</div>
                                <div class="file-details">Folder â€¢ ${modified}</div>
                            </div>
                        </div>
                    `;
                    } else {
                        html += `
                        <div class="file-item ${isSelected ? 'selected' : ''}" data-filename="${name}" data-filetype="${item.type}">
                            <div class="file-icon">${this.getFileIcon(name)}</div>
                            <div class="file-info">
                                <div class="file-name">${name}</div>
                                <div class="file-details">${this.formatFileSize(item.size || 0)} â€¢ ${modified}</div>
                            </div>
                        </div>
                    `;
                    }
                }

                if (explorerElement) {
                    explorerElement.innerHTML = html || '<div style="text-align: center; color: #999; padding: 2rem;">This folder is empty</div>';
                }
            }

            // Line 2566: Get File Icon Method
            getFileIcon(filename) {
                const ext = filename.split('.').pop().toLowerCase();
                const icons = {
                    'txt': 'ðŸ“„', 'md': 'ðŸ“„', 'js': 'ðŸ’»', 'css': 'ðŸŽ¨', 'html': 'ðŸŒ', 'json': 'âš™ï¸', 'py': 'ðŸ', 'java': 'â˜•', 'cpp': 'âš™ï¸', 'c': 'âš™ï¸', 'h': 'âš™ï¸',
                    'pdf': 'ðŸ“•', 'jpg': 'ðŸ–¼ï¸', 'jpeg': 'ðŸ–¼ï¸', 'png': 'ðŸ–¼ï¸', 'gif': 'ðŸ–¼ï¸',
                    'mp3': 'ðŸŽµ', 'wav': 'ðŸŽµ', 'mp4': 'ðŸŽ¬', 'avi': 'ðŸŽ¬',
                    'zip': 'ðŸ—œï¸', 'rar': 'ðŸ—œï¸',
                    'nam': 'ðŸ’»', 'ncapp': 'ðŸ“¥'
                };
                return icons[ext] || 'ðŸ“„';
            }

            // Method to get drive icon
            getDriveIcon(driveName) {
                if (driveName === 'C:') return 'ðŸ’½'; // Example icon for C drive
                return 'ðŸ’¾'; // Default drive icon
            }

            // Method to get drive info
            getDriveInfo(driveName) {
                const drive = this.getDirectoryContents(driveName); // Navigate to the drive root
                if (!drive || drive.type !== 'drive') return null;

                const used = drive.used;
                const total = drive.capacity;
                const percentage = total > 0 ? Math.round((used / total) * 100) : 0;

                return {
                    used: this.formatFileSize(used),
                    total: this.formatFileSize(total),
                    percentage: percentage
                };
            }

            // Line 2577: Format File Size Method
            formatFileSize(bytes) {
                if (bytes === 0) return '0 B';
                const k = 1024;
                const sizes = ['B', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }

            // Line 2586: Get Directory Contents Method
            getDirectoryContents(path) {
                if (!path || path === '/') {
                    return this.fileSystem['/'];
                }

                const parts = path.split('/').filter(p => p);
                let current = this.fileSystem['/'];

                for (const part of parts) {
                    if (current.children && current.children[part]) {
                        current = current.children[part];
                    } else {
                        return null;
                    }
                }

                return current;
            }

            // Line 2604: Handle File Action Method
            handleFileAction(action, content) {
                switch (action) {
                    case 'back':
                        this.navigateBack(content);
                        break;
                    case 'newfolder':
                        this.createNewFolder(content);
                        break;
                    case 'delete':
                        this.deleteSelectedFiles(content);
                        break;
                }
            }

            // Line 2618: Navigate Back Method
            navigateBack(content) {
                if (this.currentDirectory !== '/') {
                    const parts = this.currentDirectory.split('/').filter(p => p);
                    parts.pop();
                    this.currentDirectory = parts.length > 0 ? '/' + parts.join('/') : '/';
                    this.selectedFiles.clear();
                    this.renderFileExplorer(content);
                }
            }

            // Line 2629: Navigate to Folder Method
            navigateToFolder(folderName, content) {
                if (this.currentDirectory === '/') {
                    this.currentDirectory = '/' + folderName;
                } else {
                    this.currentDirectory += '/' + folderName;
                }
                this.selectedFiles.clear();
                this.renderFileExplorer(content);
            }

            // Line 2640: Create New Folder Method
            createNewFolder(content) {
                const name = prompt('Enter folder name:');
                if (name && name.trim()) {
                    const currentFolder = this.getDirectoryContents(this.currentDirectory);
                    if (currentFolder && currentFolder.children) {
                        const now = new Date().toISOString();
                        currentFolder.children[name] = {
                            type: 'folder',
                            name: name,
                            created: now,
                            modified: now,
                            children: {}
                        };
                        this.saveFileSystem();
                        this.renderFileExplorer(content);
                    }
                }
            }

            // Line 2656: Delete Selected Files Method
            deleteSelectedFiles(content) {
                if (this.selectedFiles.size > 0 && confirm(`Delete ${this.selectedFiles.size} item(s)?`)) {
                    const currentFolder = this.getDirectoryContents(this.currentDirectory);
                    if (currentFolder && currentFolder.children) {
                        for (const fileName of this.selectedFiles) {
                            delete currentFolder.children[fileName];
                        }
                        currentFolder.modified = new Date().toISOString();
                        this.selectedFiles.clear();
                        this.saveFileSystem();
                        this.renderFileExplorer(content);
                    }
                }
            }

            // Line 2671: Open File Method
            openFile(filePath, fileName) {
                const fileExtension = fileName.split('.').pop().toLowerCase();

                // Get the full file path
                let fullPath = filePath;
                if (filePath === '/') {
                    fullPath = filePath + fileName;
                } else {
                    fullPath = filePath + '/' + fileName;
                }

                const fileContent = this.getFileContent(filePath, fileName);

                // Handle .ncapp files by launching them as applications
                if (fileExtension === 'ncapp') {
                    try {
                        if (!fileContent) {
                            this.showNotification(`Empty .ncapp file: ${fileName}`, 'error');
                            return;
                        }
                        const appConfig = JSON.parse(fileContent);
                        if (appConfig && (appConfig.appId || appConfig.name)) {
                            this.launchNcApp(appConfig);
                            return;
                        } else {
                            this.showNotification(`Invalid .ncapp file: ${fileName}`, 'error');
                            return;
                        }
                    } catch (error) {
                        this.showNotification(`Error parsing .ncapp file: ${fileName} - ${error.message}`, 'error');
                        return;
                    }
                }

                if (['txt', 'md', 'js', 'css', 'html', 'json', 'py', 'java', 'cpp', 'c', 'h', 'nam'].includes(fileExtension)) {
                    const escapedFilePath = filePath.replace(/'/g, "\\'");
                    const escapedFileName = fileName.replace(/'/g, "\\'");
                    this.openApp('notes', `${fileName} - Notes`, `
                        <div class="notes-app" style="height: 100%; display: flex; flex-direction: column;">
                            <div style="padding: 10px; border-bottom: 1px solid #ddd; background: #f5f5f5; flex-shrink: 0;">
                                <strong>ðŸ“„ ${fileName}</strong>
                                <button onclick="namchaos.saveFileContent('${escapedFilePath}', '${escapedFileName}', document.querySelector('.notes-app textarea').value)" 
                                        style="float: right; padding: 5px 10px; background: #007AFF; color: white; border: none; border-radius: 5px;">Save</button>
                            </div>
                            <textarea style="width: 100%; flex: 1; border: none; padding: 15px; font-family: 'Monaco', 'Menlo', 'Consolas', monospace; font-size: 14px; resize: none; outline: none;">${(fileContent || '').replace(/</g, '&lt;').replace(/>/g, '&gt;')}</textarea>
                        </div>
                    `);
                } else {
                    this.showNotification(`Cannot open ${fileName}. Unsupported file type.`, 'warning');
                }
            }

            // Line 2705: Get File Content Method
            getFileContent(filePath, fileName) {
                const currentFolder = this.getDirectoryContents(filePath);
                if (currentFolder && currentFolder.children && currentFolder.children[fileName]) {
                    return currentFolder.children[fileName].content || '';
                }
                return '';
            }

            // Line 2715: Save File Content Method
            saveFileContent(filePath, fileName, content) {
                const currentFolder = this.getDirectoryContents(filePath);
                if (currentFolder && currentFolder.children && currentFolder.children[fileName]) {
                    currentFolder.children[fileName].content = content;
                    currentFolder.children[fileName].modified = new Date().toISOString();
                    currentFolder.children[fileName].size = content.length;
                    this.saveFileSystem();
                    this.showNotification(`${fileName} saved successfully!`, 'success');
                } else {
                    this.showNotification(`Error: Could not save ${fileName}`, 'error');
                }
            }

            // Line 2730: Show Notification Method
            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'error' ? '#ff4757' : type === 'success' ? '#2ed573' : type === 'warning' ? '#ffa502' : '#5352ed'};
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    z-index: 10000;
                    font-weight: 500;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    animation: slideInRight 0.3s ease;
                `;
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.animation = 'slideOutRight 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            }

            // Line 2685: Initialize Notes App Method
            initializeNotesApp(content) {
                const textarea = content.querySelector('#noteTextarea');
                const filenameInput = content.querySelector('#noteFilename');

                if (textarea && filenameInput) {
                    textarea.value = this.currentNote.content;
                    filenameInput.value = this.currentNote.filename;

                    textarea.addEventListener('input', () => {
                        this.currentNote.content = textarea.value;
                    });

                    filenameInput.addEventListener('input', () => {
                        this.currentNote.filename = filenameInput.value;
                    });
                }

                content.addEventListener('click', (e) => {
                    if (e.target.dataset.action === 'new') {
                        this.newNote(textarea, filenameInput);
                    } else if (e.target.dataset.action === 'save') {
                        this.saveNote(textarea.value, filenameInput.value);
                    } else if (e.target.dataset.action === 'open') {
                        this.openNoteDialog();
                    }
                });
            }

            // Line 2711: New Note Method
            newNote(textarea, filenameInput) {
                this.currentNote = { content: '', filename: 'Untitled' };
                if (textarea) textarea.value = '';
                if (filenameInput) filenameInput.value = 'Untitled';
            }

            // Line 2718: Save Note Method
            saveNote(content, filename) {
                if (!filename || !filename.trim()) {
                    alert('Please enter a filename');
                    return;
                }

                const documentsFolder = this.getDirectoryContents('/Documents');
                if (documentsFolder && documentsFolder.children) {
                    const now = new Date().toISOString();
                    documentsFolder.children[filename] = {
                        type: 'file',
                        name: filename,
                        content: content,
                        size: content.length,
                        created: now,
                        modified: now
                    };
                    documentsFolder.modified = now;
                    this.saveFileSystem();
                    alert('Note saved successfully!');
                }
            }

            // Line 2740: Open Note Dialog Method
            openNoteDialog() {
                const currentFolder = this.getDirectoryContents('/Documents');
                if (currentFolder && currentFolder.children) {
                    const files = Object.keys(currentFolder.children).filter(name => 
                        currentFolder.children[name].type === 'file'
                    );

                    if (files.length === 0) {
                        alert('No files found in Documents folder');
                        return;
                    }

                    const fileName = prompt('Choose file to open:\n' + files.join('\n'));
                    if (fileName && files.includes(fileName)) {
                        const fileContent = this.getFileContent('/Documents', fileName);
                        const textarea = document.querySelector('#noteTextarea');
                        const filenameInput = document.querySelector('#noteFilename');

                        if (textarea && filenameInput) {
                            textarea.value = fileContent;
                            filenameInput.value = fileName;
                            this.currentNote.content = fileContent;
                            this.currentNote.filename = fileName;
                        }
                    }
                }
            }

            // Line 2757: Initialize Calculator App Method
            initializeCalculatorApp(content) {
                const display = content.querySelector('#calcDisplay');
                if (display) {
                    display.value = this.calculatorDisplay;
                }

                content.addEventListener('click', (e) => {
                    if (e.target.classList.contains('calc-btn')) {
                        const value = e.target.textContent;
                        this.handleCalculatorInput(value, display);
                    }
                });
            }

            // Line 2771: Handle Calculator Input Method
            handleCalculatorInput(value, display) {
                if (value === 'Clear') {
                    this.calculatorDisplay = '0';
                    this.calculatorOperand = null;
                    this.calculatorOperator = null;
                    this.calculatorWaitingForOperand = false;
                } else if ('+-Ã—Ã·'.includes(value)) {
                    this.handleCalculatorOperator(value);
                } else if (value === '=') {
                    this.calculateResult();
                } else {
                    this.inputCalculatorDigit(value);
                }

                if (display) {
                    display.value = this.calculatorDisplay;
                }
            }

            // Line 2789: Input Calculator Digit Method
            inputCalculatorDigit(digit) {
                if (this.calculatorWaitingForOperand) {
                    this.calculatorDisplay = digit;
                    this.calculatorWaitingForOperand = false;
                } else {
                    this.calculatorDisplay = this.calculatorDisplay === '0' ? digit : this.calculatorDisplay + digit;
                }
            }

            // Line 2799: Handle Calculator Operator Method
            handleCalculatorOperator(nextOperator) {
                const inputValue = parseFloat(this.calculatorDisplay);

                if (this.calculatorOperand === null) {
                    this.calculatorOperand = inputValue;
                } else if (this.calculatorOperator) {
                    const currentValue = this.calculatorOperand || 0;
                    const newValue = this.performCalculation(currentValue, inputValue, this.calculatorOperator);

                    this.calculatorDisplay = String(newValue);
                    this.calculatorOperand = newValue;
                }

                this.calculatorWaitingForOperand = true;
                this.calculatorOperator = nextOperator;
            }

            // Line 2816: Calculate Result Method
            calculateResult() {
                const inputValue = parseFloat(this.calculatorDisplay);

                if (this.calculatorOperand !== null && this.calculatorOperator) {
                    const newValue = this.performCalculation(this.calculatorOperand, inputValue, this.calculatorOperator);
                    this.calculatorDisplay = String(newValue);
                    this.calculatorOperand = null;
                    this.calculatorOperator = null;
                    this.calculatorWaitingForOperand = true;
                }
            }

            // Line 2828: Perform Calculation Method
            performCalculation(firstOperand, secondOperand, operator) {
                switch (operator) {
                    case '+':
                        return firstOperand + secondOperand;
                    case 'âˆ’':
                        return firstOperand - secondOperand;
                    case 'Ã—':
                        return firstOperand * secondOperand;
                    case 'Ã·':
                        return firstOperand / secondOperand;
                    default:
                        return secondOperand;
                }
            }




            // Line 2843: Initialize Browser App Method
            initializeBrowserApp(content) {
                const urlInput = content.querySelector('#browserUrl');
                const iframe = content.querySelector('#browserFrame');
                const backBtn = content.querySelector('#browserBack');
                const forwardBtn = content.querySelector('#browserForward');
                const goBtn = content.querySelector('#browserGo');

                if (backBtn) backBtn.addEventListener('click', () => this.browserBack(iframe, urlInput));
                if (forwardBtn) forwardBtn.addEventListener('click', () => this.browserForward(iframe, urlInput));
                if (goBtn) goBtn.addEventListener('click', () => this.browserNavigate(urlInput.value, iframe, urlInput));

                if (urlInput) {
                    urlInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            this.browserNavigate(urlInput.value, iframe, urlInput);
                        }
                    });
                }

                this.browserNavigate('https://example.com', iframe, urlInput);
            }

            // Line 2863: Browser Navigate Method
            browserNavigate(url, iframe, urlInput) {
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }

                try {
                    if (iframe) {
                        iframe.src = url;
                    }
                    if (urlInput) {
                        urlInput.value = url;
                    }

                    this.browserHistory = this.browserHistory.slice(0, this.browserCurrentIndex + 1);
                    this.browserHistory.push(url);
                    this.browserCurrentIndex = this.browserHistory.length - 1;
                } catch (error) {
                    alert('Unable to navigate to this URL');
                }
            }

            // Line 2882: Browser Back Method
            browserBack(iframe, urlInput) {
                if (this.browserCurrentIndex > 0) {
                    this.browserCurrentIndex--;
                    const url = this.browserHistory[this.browserCurrentIndex];
                    if (iframe) iframe.src = url;
                    if (urlInput) urlInput.value = url;
                }
            }

            // Line 2892: Browser Forward Method
            browserForward(iframe, urlInput) {
                if (this.browserCurrentIndex < this.browserHistory.length - 1) {
                    this.browserCurrentIndex++;
                    const url = this.browserHistory[this.browserCurrentIndex];
                    if (iframe) iframe.src = url;
                    if (urlInput) urlInput.value = url;
                }
            }

            // Line 2902: Initialize Task Manager App Method
            initializeTaskManagerApp(content) {
                this.updateTaskManagerDisplay(content);

                // Set up real-time updates for task manager
                this.taskManagerInterval = setInterval(() => {
                    this.updateSystemResources();
                    this.updateTaskManagerDisplay(content);
                }, 1000);

                // Handle process termination
                content.addEventListener('click', (e) => {
                    if (e.target.classList.contains('kill-process-btn')) {
                        const processId = e.target.dataset.processId;
                        this.killProcess(processId, content);
                    }
                });

                // Memory settings link
                const memorySettingsBtn = content.querySelector('#openMemorySettings');
                if (memorySettingsBtn) {
                    memorySettingsBtn.addEventListener('click', () => {
                        this.openApp('settings');
                        // Navigate to system settings after a brief delay
                        setTimeout(() => {
                            const systemTab = document.querySelector('[data-tab="system"]');
                            if (systemTab) systemTab.click();
                        }, 100);
                    });
                }
            }

            // Line 2928: Update Task Manager Display Method
            updateTaskManagerDisplay(content) {
                const processesContainer = content.querySelector('#processesContainer');
                const cpuUsage = content.querySelector('#cpuUsage');
                const memoryUsage = content.querySelector('#memoryUsage');
                const diskUsage = content.querySelector('#diskUsage');
                const networkUsage = content.querySelector('#networkUsage');

                if (cpuUsage) cpuUsage.textContent = `${this.systemResources.cpu.usage}%`;
                if (memoryUsage) memoryUsage.textContent = `${this.systemResources.memory.used}MB / ${this.allowedMemory}MB`;
                if (diskUsage) diskUsage.textContent = `${Math.round((this.systemResources.disk.used / this.systemResources.disk.total) * 100)}%`;
                if (networkUsage) networkUsage.textContent = `â†“${this.systemResources.network.download} KB/s â†‘${this.systemResources.network.upload} KB/s`;

                if (processesContainer) {
                    let processesHTML = `
                        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 1rem; padding: 0.5rem; background: #f0f0f0; border-radius: 8px; font-weight: 600; margin-bottom: 0.5rem;">
                            <div>Process Name</div>
                            <div>PID</div>
                            <div>CPU %</div>
                            <div>Memory</div>
                            <div>Action</div>
                        </div>
                    `;

                    this.runningProcesses.forEach(process => {
                        processesHTML += `
                            <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 1rem; padding: 0.5rem; border-bottom: 1px solid #eee; align-items: center;">
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.2rem;">${process.icon}</span>
                                    <span>${process.name}</span>
                                </div>
                                <div>${process.pid}</div>
                                <div>${process.cpu}%</div>
                                <div>${process.memory}MB</div>
                                <div>
                                    ${process.critical ? 
                                        '<span style="color: #999; font-size: 0.8rem;">System</span>' : 
                                        `<button class="btn kill-process-btn" data-process-id="${process.pid}" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">End</button>`
                                    }
                                </div>
                            </div>
                        `;
                    });

                    processesContainer.innerHTML = processesHTML;
                }
            }

            // Line 2970: Kill Process Method
            killProcess(processId, content) {
                const processIndex = this.runningProcesses.findIndex(p => p.pid == processId);
                if (processIndex !== -1) {
                    const process = this.runningProcesses[processIndex];
                    if (process.critical) {
                        alert('Cannot terminate system process');
                        return;
                    }

                    if (confirm(`Are you sure you want to end ${process.name}?`)) {
                        // Close the app window if it's open
                        if (process.appId && this.openWindows.has(process.appId)) {
                            this.closeWindow(process.appId);
                        }

                        this.runningProcesses.splice(processIndex, 1);
                        this.updateTaskManagerDisplay(content);

                        // Free up some memory
                        this.systemResources.memory.used -= process.memory;
                        this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;
                    }
                }
            }

            // Line 2996: Update System Resources Method (Enhanced)
            updateSystemResources() {
                // CPU usage simulation with more realistic patterns
                const processCount = this.runningProcesses ? this.runningProcesses.length : 4;
                const baseLoad = 5 + (processCount * 2);
                const randomVariation = Math.random() * 20 - 10;
                this.systemResources.cpu.usage = Math.max(0, Math.min(100, baseLoad + randomVariation));

                // Memory usage based on running processes
                let totalProcessMemory = this.runningProcesses.reduce((sum, process) => sum + process.memory, 0);
                this.systemResources.memory.used = Math.min(totalProcessMemory, this.allowedMemory);
                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;

                // Network activity simulation
                this.systemResources.network.download = Math.floor(Math.random() * 1000);
                this.systemResources.network.upload = Math.floor(Math.random() * 500);

                // Disk usage grows slowly over time
                if (Math.random() < 0.1) { // 10% chance per update
                    this.systemResources.disk.used += Math.floor(Math.random() * 10);
                    this.systemResources.disk.available = this.systemResources.disk.total - this.systemResources.disk.used;
                }

                // Update process CPU and memory usage
                if (this.runningProcesses) {
                    this.runningProcesses.forEach(process => {
                        if (!process.critical) {
                            process.cpu = Math.max(0, process.cpu + (Math.random() * 4 - 2));
                            process.memory = Math.max(10, process.memory + (Math.random() * 2 - 1));
                        }
                    });
                }
            }

            // Line 3024: Get Base Memory Usage Method
            getBaseMemoryUsage() {
                if (!this.runningProcesses) return 640; // Base OS memory
                return this.runningProcesses
                    .filter(p => p.critical)
                    .reduce((sum, process) => sum + process.memory, 0);
            }

            // Line 3031: Add Process Method
            addProcess(name, appId, icon = 'ðŸ“±', memory = 50) {
                if (!this.runningProcesses) {
                    this.runningProcesses = this.initializeProcesses();
                }

                // Determine base CPU usage based on app type
                let baseCpu = 2;
                if (appId.includes('browser')) baseCpu = 8;
                else if (appId.includes('paint') || appId.includes('camera')) baseCpu = 6;
                else if (appId.includes('music') || appId.includes('photos')) baseCpu = 4;
                else if (appId.includes('terminal') || appId.includes('taskmanager')) baseCpu = 3;

                const newProcess = {
                    pid: Date.now() + Math.floor(Math.random() * 1000),
                    name: name,
                    appId: appId,
                    icon: icon,
                    cpu: baseCpu + Math.random() * 3,
                    memory: memory,
                    disk: Math.floor(Math.random() * 15),
                    network: Math.floor(Math.random() * 20),
                    priority: 'Normal',
                    status: 'Running',
                    startTime: Date.now(),
                    critical: false
                };
                this.runningProcesses.push(newProcess);
                this.systemResources.memory.used += memory;
                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;

                // Update all open apps with new process info
                this.updateAllAppsResourceInfo();

                return newProcess;
            }

            // Line 3047: Initialize Camera App Method
            initializeCameraApp(content) {
                const video = content.querySelector('#cameraVideo');
                const canvas = content.querySelector('#cameraCanvas');
                const captureBtn = content.querySelector('#capturePhoto');
                const gallery = content.querySelector('#photoGallery');

                if (video) {
                    this.startCamera(video);
                }

                if (captureBtn) {
                    captureBtn.addEventListener('click', () => {
                        this.capturePhoto(video, canvas, gallery);
                    });
                }

                // Load existing photos into gallery
                this.loadPhotoGallery(gallery);
            }

            // Line 2918: Start Camera Method
            async startCamera(video) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    video.srcObject = stream;
                } catch (error) {
                    video.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; background: #f0f0f0; color: #666;">Camera not available</div>';
                }
            }

            // Line 2928: Capture Photo Method
            capturePhoto(video, canvas, gallery) {
                if (!video || !canvas || !gallery) return;

                const context = canvas.getContext('2d');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                context.drawImage(video, 0, 0);

                const dataURL = canvas.toDataURL('image/jpeg', 0.9);
                const photoId = Date.now();
                const photoData = {
                    id: photoId,
                    dataURL: dataURL,
                    timestamp: new Date().toISOString(),
                    name: `photo_${photoId}.jpg`
                };

                // Save to file system
                this.savePhotoToFileSystem(photoData);

                // Add to gallery display
                this.addPhotoToGallery(photoData, gallery);

                // Show capture feedback
                this.showNotification('Photo captured!', 'success');
            }

            // Save photo to Pictures folder in file system
            savePhotoToFileSystem(photoData) {
                const picturesFolder = this.getDirectoryContents('/C:/Users/User/Pictures');
                if (picturesFolder && picturesFolder.children) {
                    picturesFolder.children[photoData.name] = {
                        type: 'file',
                        name: photoData.name,
                        content: photoData.dataURL,
                        size: Math.floor(photoData.dataURL.length * 0.75), // Approximate file size
                        created: photoData.timestamp,
                        modified: photoData.timestamp
                    };
                    picturesFolder.modified = photoData.timestamp;
                    this.saveFileSystem();

                    // Update C: drive usage
                    this.updateDriveUsage();

                    // Refresh Photos app if it's open
                    this.refreshPhotosApp();
                }
            }

            // Refresh Photos app in real-time
            refreshPhotosApp() {
                const photosWindow = this.openWindows.get('photos');
                if (photosWindow) {
                    const content = photosWindow.querySelector('.window-content');
                    if (content) {
                        this.initializePhotosApp(content);
                    }
                }
            }

            // Add photo to gallery display
            addPhotoToGallery(photoData, gallery) {
                const img = document.createElement('img');
                img.src = photoData.dataURL;
                img.style.cssText = `
                    width: 60px; 
                    height: 60px; 
                    object-fit: cover; 
                    border-radius: 8px; 
                    cursor: pointer; 
                    margin-right: 8px;
                    border: 2px solid white;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                `;
                img.title = `Taken on ${new Date(photoData.timestamp).toLocaleString()}`;
                img.onclick = () => this.openPhotoViewer(photoData);
                gallery.appendChild(img);
            }

            // Load existing photos from file system
            loadPhotoGallery(gallery) {
                if (!gallery) return;

                const picturesFolder = this.getDirectoryContents('/C:/Users/User/Pictures');
                if (picturesFolder && picturesFolder.children) {
                    let photoCount = 0;
                    for (const [fileName, file] of Object.entries(picturesFolder.children)) {
                        if (file.type === 'file' && fileName.includes('photo_') && file.content && file.content.startsWith('data:image/')) {
                            const photoData = {
                                id: fileName.replace(/[^0-9]/g, '') || Date.now() + photoCount,
                                dataURL: file.content,
                                timestamp: file.created,
                                name: fileName
                            };
                            this.addPhotoToGallery(photoData, gallery);
                            photoCount++;
                        }
                    }

                    // Show message if no photos found
                    if (photoCount === 0) {
                        gallery.innerHTML = '<div style="color: rgba(255,255,255,0.6); text-align: center; padding: 1rem; font-style: italic;">No photos yet. Take a photo with the camera button above.</div>';
                    }
                }
            }

            // Open photo in full view
            openPhotoViewer(photoData) {
                const viewer = document.createElement('div');
                viewer.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: rgba(0,0,0,0.9);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    backdrop-filter: blur(10px);
                `;

                viewer.innerHTML = `
                    <div style="text-align: center; color: white;">
                        <img src="${photoData.dataURL}" style="max-width: 90vw; max-height: 80vh; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.5);">
                        <div style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.8;">
                            ${photoData.name}<br>
                            Taken on ${new Date(photoData.timestamp).toLocaleString()}
                        </div>
                        <div style="margin-top: 1rem;">
                            <button style="background: var(--primary-blue); color: white; border: none; padding: 8px 16px; border-radius: 8px; margin: 0 4px; cursor: pointer;" onclick="this.parentElement.parentElement.parentElement.remove()">Close</button>
                            <button style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 8px; margin: 0 4px; cursor: pointer;" onclick="namchaos.downloadPhoto('${photoData.dataURL}', '${photoData.name}')">Download</button>
                        </div>
                    </div>
                `;

                viewer.addEventListener('click', (e) => {
                    if (e.target === viewer) viewer.remove();
                });

                document.body.appendChild(viewer);
            }

            // Download photo
            downloadPhoto(dataURL, filename) {
                const link = document.createElement('a');
                link.href = dataURL;
                link.download = filename;
                link.click();
            }

            // Line 2947: Initialize App Store App Method
            initializeAppStoreApp(content) {
                this.renderAppStore(content);
            }

            // Line 2952: Render App Store Method
            renderAppStore(content) {
                const storeContent = content.querySelector('#appStoreContent');
                if (!storeContent) return;

                const apps = [
                    { id: 'gamecenter', name: 'Game Center', icon: 'ðŸŽ®', description: 'Lorem ipsum dolor sit amet consectetur adipiscing elit. Dolor sit amet consectetur adipiscing elit quisque faucibus.', price: 'Free' },
                    { id: 'dataanalyzer', name: 'Data Analyzer', icon: 'ðŸ“Š', description: 'Lorem ipsum dolor sit amet consectetur adipiscing elit. Dolor sit amet consectetur adipiscing elit quisque faucibus.', price: 'Free' },
                    { id: 'chatapp', name: 'Chat App', icon: 'ðŸ’¬', description: 'Lorem ipsum dolor sit amet consectetur adipiscing elit. Dolor sit amet consectetur adipiscing elit quisque faucibus.', price: 'Free' },
                    { id: 'advancededitor', name: 'Code Editor', icon: 'ðŸ’»', description: 'Lorem ipsum dolor sit amet consectetur adipiscing elit. Dolor sit amet consectetur adipiscing elit quisque faucibus.', price: 'Free' },
                    { id: 'weatherapp', name: 'Weather App', icon: 'ðŸŒ¤ï¸', description: 'Lorem ipsum dolor sit amet consectetur adipiscing elit. Dolor sit amet consectetur adipiscing elit quisque faucibus.', price: 'Free' },
                    { id: 'testingapp', name: 'Testing App', icon: 'ðŸŽ', description: 'Lorem ipsum dolor sit amet consectetur adipiscing elit. Dolor sit amet consectetur adipiscing elit quisque faucibus.', price: 'Free' }
                ];

                let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">';

                for (const app of apps) {
                    const isInstalled = this.installedApps.includes(app.id);
                    html += `
                        <div style="background: #f9f9f9; border-radius: 16px; padding: 1.5rem; display: flex; align-items: center; gap: 1rem;">
                            <div style="font-size: 3rem;">${app.icon}</div>
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 0.5rem 0;">${app.name}</h4>
                                <p style="margin: 0 0 0.5rem 0; color: #666; font-size: 0.9rem;">${app.description}</p>
                                <p style="margin: 0; font-weight: 600; color: var(--primary-blue);">${app.price}</p>
                            </div>
                            <button class="btn ${isInstalled ? '' : 'btn-primary'}" 
                                    onclick="namchaos.installApp('${app.id}', this)" 
                                    ${isInstalled ? 'disabled' : ''}>
                                ${isInstalled ? 'Installed âœ“' : 'Install'}
                            </button>
                        </div>
                    `;
                }

                html += '</div>';
                storeContent.innerHTML = html;
            }

            // Line 3007: Install App Method
            installApp(appId, button) {
                if (this.installedApps.includes(appId)) {
                    return;
                }

                const originalText = button.textContent;
                button.textContent = 'Installing...';
                button.disabled = true;

                setTimeout(() => {
                    button.textContent = 'Installed âœ“';
                    button.style.background = '#4CAF50';
                    button.style.color = 'white';

                    this.installedApps.push(appId);
                    this.saveInstalledApps();

                    this.addAppToDesktop(appId);

                    setTimeout(() => {
                        alert(`${this.getAppNameById(appId)} has been installed successfully!`);
                    }, 500);
                }, 2000);
            }

            // Line 3019: Get App Name by ID Method
            getAppNameById(appId) {
                const names = {
                    'gamecenter': 'Game Center',
                    'dataanalyzer': 'Data Analyzer',
                    'chatapp': 'Chat App',
                    'advancededitor': 'Code Editor',
                    'weatherapp': 'Weather App',
                    'testingapp': 'Testing App'
                };
                return names[appId] || appId;
            }

            // Line 3031: Add App to Desktop Method
            addAppToDesktop(appId) {
                const homeScreen = document.getElementById('homeScreen');
                if (!homeScreen) return;

                const icons = {
                    'gamecenter': 'ðŸŽ®',
                    'dataanalyzer': 'ðŸ“Š',
                    'chatapp': 'ðŸ’¬',
                    'advancededitor': 'ðŸ’»',
                    'weatherapp': 'ðŸŒ¤ï¸',
                    'testingapp': 'ðŸŽ'
                };

                const appIcon = document.createElement('div');
                appIcon.className = 'app-icon';
                appIcon.setAttribute('data-app', appId);
                appIcon.innerHTML = `
                    <span>${icons[appId] || 'ðŸ“±'}</span>
                    <div class="app-label">${this.getAppNameById(appId)}</div>
                `;

                appIcon.addEventListener('click', () => this.openApp(appId));
                homeScreen.appendChild(appIcon);
            }

            // Line 3043: Initialize Downloader App Method
            initializeDownloaderApp(content) {
                this.renderDownloadManager(content);

                const downloadBtn = content.querySelector('#startDownloadBtn');
                const urlInput = content.querySelector('#downloadUrl');

                if (downloadBtn && urlInput) {
                    downloadBtn.addEventListener('click', () => {
                        this.startDownload(urlInput.value, content);
                    });

                    urlInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            this.startDownload(urlInput.value, content);
                        }
                    });
                }

                content.addEventListener('click', (e) => {
                    if (e.target.classList.contains('quick-download-btn')) {
                        const type = e.target.dataset.type;
                        this.quickDownload(type, content);
                    }
                });
            }

            // Line 3066: Render Download Manager Method
            renderDownloadManager(content) {
                const downloadContent = content.querySelector('#downloadContent');
                if (!downloadContent) return;

                let html = `
                    <h4>Download Queue</h4>
                    <div id="downloadQueue" style="margin: 1rem 0; display: flex; flex-direction: column; gap: 1rem;">
                `;

                for (const download of this.downloads) {
                    html += this.createDownloadItemHTML(download);
                }

                html += `
                    </div>
                    <h4>Quick Downloads</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <button class="quick-download-btn btn" data-type="sample-image" style="padding: 1rem; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ–¼ï¸</div>
                            <div>Sample Image</div>
                            <div style="font-size: 0.8rem; color: #666;">Download test image</div>
                        </button>
                        <button class="quick-download-btn btn" data-type="sample-document" style="padding: 1rem; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ“„</div>
                            <div>Sample Document</div>
                            <div style="font-size: 0.8rem; color: #666;">Download test PDF</div>
                        </button>
                        <button class="quick-download-btn btn" data-type="sample-archive" style="padding: 1rem; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ðŸ—œï¸</div>
                            <div>Sample Archive</div>
                            <div style="font-size: 0.8rem; color: #666;">Download test ZIP</div>
                        </button>
                    </div>
                `;

                downloadContent.innerHTML = html;
            }

            // Line 3103: Start Download Method
            startDownload(url, content) {
                if (!url) {
                    alert('Please enter a valid URL');
                    return;
                }

                const filename = this.extractFileName(url);
                const download = {
                    id: Date.now(),
                    filename: filename,
                    url: url,
                    progress: 0,
                    status: 'downloading',
                    size: Math.floor(Math.random() * 10) + 1 // Simulate size in MB
                };

                this.downloads.unshift(download);
                this.saveDownloads();
                this.renderDownloadManager(content);
                this.simulateDownload(download, content);
            }

            // Line 3123: Quick Download Method
            quickDownload(type, content) {
                const downloads = {
                    'sample-image': { name: 'sample-image.jpg', size: 1.2 },
                    'sample-document': { name: 'sample-document.pdf', size: 2.5 },
                    'sample-archive': { name: 'sample-archive.zip', size: 5.8 }
                };

                const downloadInfo = downloads[type];
                if (!downloadInfo) return;

                const download = {
                    id: Date.now(),
                    filename: downloadInfo.name,
                    url: 'quick-download',
                    progress: 0,
                    status: 'downloading',
                    size: downloadInfo.size
                };

                this.downloads.unshift(download);
                this.saveDownloads();
                this.renderDownloadManager(content);
                this.simulateDownload(download, content);
            }

            // Line 3147: Extract File Name Method
            extractFileName(url) {
                try {
                    const urlObj = new URL(url);
                    const path = urlObj.pathname;
                    const fileName = path.substring(path.lastIndexOf('/') + 1);
                    return fileName || 'downloaded-file';
                } catch (e) {
                    return 'downloaded-file';
                }
            }

            // Line 3158: Create Download Item HTML Method
            createDownloadItemHTML(download) {
                return `
                    <div style="background: #f9f9f9; border-radius: 12px; padding: 1rem;" data-download-id="${download.id}">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                            <span style="font-weight: 500;">${download.filename}</span>
                            <span class="download-status" style="color: ${download.status === 'completed' ? '#4CAF50' : 'var(--primary-blue)'};">
                                ${download.status === 'completed' ? 'Completed' : 'Downloading...'}
                            </span>
                        </div>
                        <div style="background: #e0e0e0; height: 6px; border-radius: 3px; overflow: hidden;">
                            <div style="background: ${download.status === 'completed' ? '#4CAF50' : 'var(--primary-blue)'}; height: 100%; width: ${download.progress}%; border-radius: 3px; transition: width 0.3s ease;"></div>
                        </div>
                        <div style="margin-top: 0.5rem; display: flex; justify-content: space-between; font-size: 0.8rem; color: #666;">
                            <span>${download.status === 'completed' ? download.size.toFixed(1) + ' MB' : (download.size * download.progress / 100).toFixed(1) + ' MB / ' + download.size.toFixed(1) + ' MB'}</span>
                            <span>${download.status === 'completed' ? 'Downloaded to /Downloads' : 'Downloading...'}</span>
                        </div>
                    </div>
                `;
            }

            // Line 3179: Simulate Download Method
            simulateDownload(download, content) {
                const interval = setInterval(() => {
                    download.progress += Math.floor(Math.random() * 15) + 5;

                    if (download.progress >= 100) {
                        download.progress = 100;
                        download.status = 'completed';
                        clearInterval(interval);

                        this.saveDownloadedFile(download);
                    }

                    this.saveDownloads();

                    const downloadElement = content.querySelector(`[data-download-id="${download.id}"]`);
                    if (downloadElement) {
                        downloadElement.outerHTML = this.createDownloadItemHTML(download);
                    }
                }, Math.floor(Math.random() * 500) + 200);
            }

            // Line 3199: Save Downloaded File Method
            saveDownloadedFile(download) {
                const downloadsFolder = this.getDirectoryContents('/Downloads');
                if (downloadsFolder && downloadsFolder.children) {
                    const now = new Date().toISOString();
                    downloadsFolder.children[download.filename] = {
                        type: 'file',
                        name: download.filename,
                        content: `Downloaded from: ${download.url}\nSize: ${download.size.toFixed(1)} MB\nDownloaded on: ${new Date().toLocaleString()}`,
                        size: Math.floor(download.size * 1024 * 1024),
                        created: now,
                        modified: now
                    };
                    downloadsFolder.modified = now;
                    this.saveFileSystem();
                }
            }

            // Line 3216: Initialize Terminal App Method
            initializeTerminalApp(content) {
                const output = content.querySelector('#terminalOutput');
                const input = content.querySelector('#terminalInput');

                if (input) {
                    input.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            const command = input.value;
                            this.executeTerminalCommand(command, output);
                            input.value = '';
                        }
                    });

                    input.focus();
                }
            }

            // Line 3232: Execute Terminal Command Method
            executeTerminalCommand(command, output) {
                const args = command.trim().split(' ');
                const cmd = args[0];
                const params = args.slice(1);

                output.innerHTML += `user@namchaos:~$ ${command}<br>`;

                if (cmd === 'clear') {
                    output.innerHTML = 'NamChaOS Terminal v1.0 Beta 2<br>Type \'help\' for available commands.<br><br>';
                    output.scrollTop = output.scrollHeight;
                    return;
                }

                let result = '';

                switch (cmd) {
                    case 'help':
                        result = `Available commands:
â€¢ help - Show this help
â€¢ ls [-la] [path] - List files and directories
â€¢ pwd - Show current directory
â€¢ cd [path] - Change directory
â€¢ mkdir [name] - Create directory
â€¢ touch [filename] - Create file
â€¢ rm [filename] - Remove file
â€¢ rmdir [dirname] - Remove directory
â€¢ cp [src] [dest] - Copy file
â€¢ mv [src] [dest] - Move/rename file
â€¢ cat [filename] - Display file content
â€¢ nano [filename] - Edit file (simulated)
â€¢ grep [pattern] [file] - Search in file
â€¢ find [name] - Find files by name
â€¢ ps - Show running processes
â€¢ kill [pid] - Kill process
â€¢ top - Show system processes
â€¢ df - Show disk usage
â€¢ du [path] - Show directory size
â€¢ free - Show memory usage
â€¢ uptime - Show system uptime
â€¢ uname [-a] - Show system info
â€¢ whoami - Show current user
â€¢ id - Show user ID info
â€¢ groups - Show user groups
â€¢ history - Show command history
â€¢ alias [name=command] - Create alias
â€¢ env - Show environment variables
â€¢ export [var=value] - Set environment variable
â€¢ which [command] - Show command location
â€¢ man [command] - Show manual (help)
â€¢ echo [text] - Display text
â€¢ date - Show current date/time
â€¢ cal - Show calendar
â€¢ bc - Basic calculator
â€¢ wc [file] - Count lines/words/chars
â€¢ head [file] - Show first lines
â€¢ tail [file] - Show last lines
â€¢ sort [file] - Sort file contents
â€¢ uniq [file] - Remove duplicates
â€¢ chmod [mode] [file] - Change permissions
â€¢ chown [user] [file] - Change owner
â€¢ ping [host] - Ping network host
â€¢ wget [url] - Download file
â€¢ curl [url] - Transfer data from server
â€¢ ssh [user@host] - Secure shell (simulated)
â€¢ scp [file] [dest] - Secure copy (simulated)
â€¢ tar [options] [file] - Archive files
â€¢ zip [archive] [files] - Create zip
â€¢ unzip [archive] - Extract zip
â€¢ mount - Show mounted filesystems
â€¢ fdisk -l - List disk partitions
â€¢ lsblk - List block devices
â€¢ ifconfig - Show network interfaces
â€¢ netstat - Show network connections
â€¢ iptables -L - Show firewall rules
â€¢ systemctl status - Show service status
â€¢ service [name] status - Check service
â€¢ crontab -l - List scheduled tasks
â€¢ jobs - Show active jobs
â€¢ bg - Put job in background
â€¢ fg - Bring job to foreground
â€¢ nohup [command] - Run command detached
â€¢ screen - Start screen session
â€¢ tmux - Start tmux session
â€¢ vim [file] - Vi editor (simulated)
â€¢ emacs [file] - Emacs editor (simulated)
â€¢ git status - Git repository status
â€¢ git log - Git commit history
â€¢ python - Python interpreter
â€¢ node - Node.js interpreter
â€¢ npm - Node package manager
â€¢ pip - Python package installer
â€¢ make - Build project
â€¢ gcc [file] - Compile C code
â€¢ javac [file] - Compile Java code
â€¢ java [class] - Run Java program
â€¢ taskmanager - Open task manager
â€¢ htop - Show system processes`;
                        break;

                    case 'ls':
                        if (params.includes('-la') || params.includes('-l')) {
                            result = `total 8
drwxr-xr-x  7 user user  224 ${new Date().toLocaleDateString()} Documents
drwxr-xr-x  2 user user   64 ${new Date().toLocaleDateString()} Pictures  
drwxr-xr-x  2 user user   64 ${new Date().toLocaleDateString()} Music     
drwxr-xr-x  2 user user   64 ${new Date().toLocaleDateString()} Downloads 
drwxr-xr-x  2 user user   64 ${new Date().toLocaleDateString()} Desktop   
-rw-r--r--  1 user user  220 ${new Date().toLocaleDateString()} .bashrc   
-rw-r--r--  1 user user  807 ${new Date().toLocaleDateString()} .profile  `;
                        } else {
                            result = 'Documents  Pictures  Music  Downloads  Desktop  .bashrc  .profile';
                        }
                        break;

                    case 'pwd':
                        result = '/C:/users/User';
                        break;

                    case 'cd':
                        result = params.length > 0 ? `Changed directory to ${params[0]}` : 'No directory specified';
                        break;

                    case 'mkdir':
                        result = params.length > 0 ? `Directory '${params[0]}' created` : 'mkdir: missing operand';
                        break;

                    case 'touch':
                        result = params.length > 0 ? `File '${params[0]}' created` : 'touch: missing operand';
                        break;

                    case 'rm':
                        result = params.length > 0 ? `File '${params[0]}' removed` : 'rm: missing operand';
                        break;

                    case 'rmdir':
                        result = params.length > 0 ? `Directory '${params[0]}' removed` : 'rmdir: missing operand';
                        break;

                    case 'cp':
                        result = params.length >= 2 ? `'${params[0]}' copied to '${params[1]}'` : 'cp: missing operand';
                        break;

                    case 'mv':
                        result = params.length >= 2 ? `'${params[0]}' moved to '${params[1]}'` : 'mv: missing operand';
                        break;

                    case 'cat':
                        result = params.length > 0 ? `Contents of ${params[0]}:\nSample file content...` : 'cat: missing operand';
                        break;

                    case 'nano':
                    case 'vim':
                    case 'emacs':
                        result = params.length > 0 ? `Opening ${params[0]} in ${cmd} (simulated)` : `${cmd}: missing filename`;
                        break;

                    case 'grep':
                        result = params.length >= 2 ? `Searching for '${params[0]}' in ${params[1]}...` : 'grep: missing operand';
                        break;

                    case 'find':
                        result = params.length > 0 ? `Searching for files named '${params[0]}'...` : 'find: missing operand';
                        break;

                    case 'ps':
                        result = `  PID TTY          TIME CMD
 1234 pts/0    00:00:01 bash
 5678 pts/0    00:00:00 namchaos
 9012 pts/0    00:00:00 ps`;
                        break;

                    case 'kill':
                        result = params.length > 0 ? `Process ${params[0]} terminated` : 'kill: missing PID';
                        break;

                    case 'top':
                    case 'htop':
                        result = `System Monitor:
CPU Usage: ${this.systemResources.cpu.usage}%
Memory: ${this.systemResources.memory.used}MB / ${this.allowedMemory}MB
Disk: ${Math.round((this.systemResources.disk.used / this.systemResources.disk.total) * 100)}%
Network: â†“${this.systemResources.network.download} KB/s â†‘${this.systemResources.network.upload} KB/s

Use 'taskmanager' command to open the graphical task manager.`;
                        break;

                    case 'taskmanager':
                        this.openApp('taskmanager');
                        result = 'Opening Task Manager...';
                        break;

                    case 'df':
                        result = `Filesystem     1K-blocks    Used Available Use% Mounted on
/dev/sda1       ${Math.floor(this.systemResources.disk.total/1024)}    ${Math.floor(this.systemResources.disk.used/1024)}   ${Math.floor(this.systemResources.disk.available/1024)}  ${Math.round((this.systemResources.disk.used / this.systemResources.disk.total) * 100)}% /`;
                        break;

                    case 'du':
                        result = params.length > 0 ? `${Math.floor(Math.random() * 1000)}K\t${params[0]}` : '1024K\t.';
                        break;

                    case 'free':
                        result = `              total        used        free      shared  buff/cache   available
Mem:           ${this.allowedMemory}        ${this.systemResources.memory.used}        ${this.systemResources.memory.available}           0           0        ${this.systemResources.memory.available}
Swap:             0           0           0`;
                        break;

                    case 'uptime':
                        const uptime = Math.floor(Math.random() * 24) + 1;
                        result = ` ${new Date().toTimeString().split(' ')[0]} up ${uptime}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}, 1 user, load average: 0.${Math.floor(Math.random() * 99)}, 0.${Math.floor(Math.random() * 99)}, 0.${Math.floor(Math.random() * 99)}`;
                        break;

                    case 'uname':
                        if (params.includes('-a')) {
                            result = 'NamChaOS namchaos-system 1.0-beta2 #1 SMP PREEMPT_DYNAMIC Wed Sep 12 2025 x86_64 GNU/Linux';
                        } else {
                            result = 'NamChaOS';
                        }
                        break;

                    case 'whoami':
                        result = `user`;
                        break;

                    case 'id':
                        result = 'uid=1000(user) gid=1000(user) groups=1000(user),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),120(lpadmin),131(lxd),132(sambashare)';
                        break;

                    case 'groups':
                        result = 'user adm cdrom sudo dip plugdev lpadmin lxd sambashare';
                        break;

                    case 'history':
                        result = `    1  ls -la
    2  cd Documents
    3  cat Welcome.txt
    4  pwd
    5  help
    6  history`;
                        break;

                    case 'env':
                        result = `PATH=/usr/local/bin:/usr/bin:/bin
HOME=/home/user
USER=user
SHELL=/bin/bash
PWD=/home/user
LANG=en_US.UTF-8
TERM=xterm-256color
NAMCHAOS_VERSION=1.0-beta2`;
                        break;

                    case 'which':
                        result = params.length > 0 ? `/usr/bin/${params[0]}` : 'which: missing operand';
                        break;

                    case 'man':
                        result = params.length > 0 ? `Manual page for ${params[0]} (simulated)` : 'What manual page do you want?';
                        break;

                    case 'date':
                        result = new Date().toString();
                        break;

                    case 'cal':
                        const now = new Date();
                        result = `    ${now.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}    
Su Mo Tu We Th Fr Sa
 1  2  3  4  5  6  7
 8  9 10 11 12 13 14
15 16 17 18 19 20 21
22 23 24 25 26 27 28
29 30 31`;
                        break;

                    case 'bc':
                        result = 'bc 1.07.1\nCopyright 1991-1994, 1997, 1998, 2000, 2004, 2006, 2008, 2012-2017 Free Software Foundation, Inc.\nFor interactive calculator, use the Calculator app.';
                        break;

                    case 'wc':
                        result = params.length > 0 ? `  42   168  1024 ${params[0]}` : 'wc: missing operand';
                        break;

                    case 'head':
                        result = params.length > 0 ? `First 10 lines of ${params[0]}...` : 'head: missing operand';
                        break;

                    case 'tail':
                        result = params.length > 0 ? `Last 10 lines of ${params[0]}...` : 'tail: missing operand';
                        break;

                    case 'ping':
                        result = params.length > 0 ? `PING ${params[0]} (127.0.0.1): 56 data bytes\n64 bytes from 127.0.0.1: icmp_seq=0 time=1.234ms\n(simulated)` : 'ping: missing host operand';
                        break;

                    case 'ifconfig':
                        result = `eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.1.100  netmask 255.255.255.0  broadcast 192.168.1.255
        inet6 fe80::1234:5678:9abc:def0  prefixlen 64  scopeid 0x20<link>`;
                        break;

                    case 'git':
                        if (params[0] === 'status') {
                            result = 'On branch main\nnothing to commit, working tree clean';
                        } else if (params[0] === 'log') {
                            result = `commit a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0
Author: User <user@namchaos.local>
Date:   ${new Date().toDateString()}

    Initial commit`;
                        } else {
                            result = 'git: command requires subcommand';
                        }
                        break;

                    case 'python':
                    case 'python3':
                        result = 'Python 3.9.2 (default, Feb 28 2021, 17:03:44)\nType "help", "copyright", "credits" or "license" for more information.\n>>> (interactive mode not available in web terminal)';
                        break;

                    case 'node':
                        result = 'Welcome to Node.js v16.14.0.\nType ".help" for more information.\n> (interactive mode not available in web terminal)';
                        break;

                    case 'npm':
                        result = params.length > 0 ? `npm ${params.join(' ')} (simulated)` : 'Usage: npm <command>';
                        break;

                    case 'exit':
                    case 'logout':
                        result = 'Terminal session ended. Close the terminal window.';
                        break;

                    case 'sudo':
                        result = params.length > 0 ? `[sudo] password for user: (permission granted)\n${params.join(' ')} executed with sudo` : 'sudo: a command must be specified';
                        break;

                    case 'echo':
                        result = params.join(' ');
                        break;

                    default:
                        if (command.startsWith('echo ')) {
                            result = command.substring(5);
                        } else if (command.trim()) {
                            result = `Command not found: ${command}`;
                        }
                        break;
                }

                if (result) {
                    output.innerHTML += result + '<br><br>';
                }

                output.scrollTop = output.scrollHeight;
            }

            // Line 3565: Initialize Paint App Method
            initializePaintApp(content) {
                const canvas = content.querySelector('#paintCanvas');
                const colorPicker = content.querySelector('#paintColor');
                const brushSize = content.querySelector('#brushSize');
                const brushSizeDisplay = content.querySelector('#brushSizeDisplay');
                const clearBtn = content.querySelector('#clearCanvas');
                const saveBtn = content.querySelector('#saveCanvas');
                const brushBtn = content.querySelector('#paintBrush');
                const eraserBtn = content.querySelector('#paintEraser');
                const lineBtn = content.querySelector('#paintLine');
                const rectBtn = content.querySelector('#paintRect');
                const circleBtn = content.querySelector('#paintCircle');

                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;

                let isDrawing = false;
                let currentTool = 'brush';
                let startX, startY;
                let imageData;

                // Tool selection
                const selectTool = (tool) => {
                    currentTool = tool;
                    document.querySelectorAll('#paintBrush, #paintEraser, #paintLine, #paintRect, #paintCircle').forEach(btn => {
                        btn.classList.remove('btn-primary');
                        btn.classList.add('btn');
                    });

                    const activeBtn = content.querySelector(`#paint${tool.charAt(0).toUpperCase() + tool.slice(1)}`);
                    if (activeBtn) {
                        activeBtn.classList.remove('btn');
                        activeBtn.classList.add('btn-primary');
                    }

                    canvas.style.cursor = tool === 'eraser' ? 'grab' : 'crosshair';
                };

                // Event listeners for tools
                brushBtn?.addEventListener('click', () => selectTool('brush'));
                eraserBtn?.addEventListener('click', () => selectTool('eraser'));
                lineBtn?.addEventListener('click', () => selectTool('line'));
                rectBtn?.addEventListener('click', () => selectTool('rect'));
                circleBtn?.addEventListener('click', () => selectTool('circle'));

                // Brush size display update
                brushSize?.addEventListener('input', (e) => {
                    if (brushSizeDisplay) {
                        brushSizeDisplay.textContent = e.target.value;
                    }
                });

                // Get coordinates relative to canvas
                const getCoords = (e, canvas) => {
                    const rect = canvas.getBoundingClientRect();
                    const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                    const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                    return {
                        x: clientX - rect.left,
                        y: clientY - rect.top
                    };
                };

                // Start drawing
                const startDrawing = (e) => {
                    e.preventDefault();
                    isDrawing = true;
                    const coords = getCoords(e, canvas);
                    startX = coords.x;
                    startY = coords.y;

                    if (currentTool === 'brush' || currentTool === 'eraser') {
                        ctx.beginPath();
                        ctx.moveTo(coords.x, coords.y);
                    } else {
                        imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    }
                };

                // Drawing
                const draw = (e) => {
                    if (!isDrawing) return;
                    e.preventDefault();

                    const coords = getCoords(e, canvas);
                    const color = colorPicker?.value || '#000000';
                    const size = brushSize?.value || 5;

                    ctx.lineWidth = size;
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';

                    switch (currentTool) {
                        case 'brush':
                            ctx.globalCompositeOperation = 'source-over';
                            ctx.strokeStyle = color;
                            ctx.lineTo(coords.x, coords.y);
                            ctx.stroke();
                            break;

                        case 'eraser':
                            ctx.globalCompositeOperation = 'destination-out';
                            ctx.lineTo(coords.x, coords.y);
                            ctx.stroke();
                            break;

                        case 'line':
                            ctx.putImageData(imageData, 0, 0);
                            ctx.globalCompositeOperation = 'source-over';
                            ctx.strokeStyle = color;
                            ctx.beginPath();
                            ctx.moveTo(startX, startY);
                            ctx.lineTo(coords.x, coords.y);
                            ctx.stroke();
                            break;

                        case 'rect':
                            ctx.putImageData(imageData, 0, 0);
                            ctx.globalCompositeOperation = 'source-over';
                            ctx.strokeStyle = color;
                            ctx.strokeRect(startX, startY, coords.x - startX, coords.y - startY);
                            break;

                        case 'circle':
                            ctx.putImageData(imageData, 0, 0);
                            ctx.globalCompositeOperation = 'source-over';
                            ctx.strokeStyle = color;
                            const radius = Math.sqrt(Math.pow(coords.x - startX, 2) + Math.pow(coords.y - startY, 2));
                            ctx.beginPath();
                            ctx.arc(startX, startY, radius, 0, 2 * Math.PI);
                            ctx.stroke();
                            break;
                    }
                };

                // Stop drawing
                const stopDrawing = (e) => {
                    if (!isDrawing) return;
                    e.preventDefault();
                    isDrawing = false;
                    ctx.beginPath();
                };

                // Mouse events
                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseout', stopDrawing);

                // Touch events for mobile
                canvas.addEventListener('touchstart', startDrawing);
                canvas.addEventListener('touchmove', draw);
                canvas.addEventListener('touchend', stopDrawing);
                canvas.addEventListener('touchcancel', stopDrawing);

                // Clear canvas
                if (clearBtn) {
                    clearBtn.addEventListener('click', () => {
                        if (confirm('Clear the entire canvas? This cannot be undone.')) {
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                        }
                    });
                }

                // Save canvas
                if (saveBtn) {
                    saveBtn.addEventListener('click', () => {
                        const dataURL = canvas.toDataURL('image/png');
                        const link = document.createElement('a');
                        link.download = `painting_${new Date().getTime()}.png`;
                        link.href = dataURL;
                        link.click();
                    });
                }

                // Initialize with brush tool
                selectTool('brush');
            }



            // Line 3613: Initialize Clock App Method
            initializeClockApp(content) {
                const digitalClock = content.querySelector('#digitalClock');
                const dateDisplay = content.querySelector('#dateDisplay');
                const stopwatchDisplay = content.querySelector('#stopwatch');
                let stopwatchInterval;
                let stopwatchSeconds = 0;

                const updateClockUI = () => {
                    const now = new Date();
                    digitalClock.textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                    dateDisplay.textContent = now.toLocaleDateString([], { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

                    const utcTime = now.toLocaleTimeString('en-US', { timeZone: 'UTC', hour12: false });
                    content.querySelector('#utcTime').textContent = utcTime;
                };

                updateClockUI();
                setInterval(updateClockUI, 1000);

                const startStopwatch = () => {
                    if (stopwatchInterval) clearInterval(stopwatchInterval);
                    stopwatchInterval = setInterval(() => {
                        stopwatchSeconds++;
                        const h = Math.floor(stopwatchSeconds / 3600);
                        const m = Math.floor((stopwatchSeconds % 3600) / 60);
                        const s = stopwatchSeconds % 60;
                        stopwatchDisplay.textContent = `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
                    }, 1000);
                };
                const stopStopwatch = () => clearInterval(stopwatchInterval);
                const resetStopwatch = () => {
                    stopwatchSeconds = 0;
                    stopwatchDisplay.textContent = '00:00:00';
                    stopStopwatch();
                };

                startStopwatch();

                content.addEventListener('click', (e) => {
                    if (e.target.id === 'stopwatch') {
                        if(stopwatchInterval) stopStopwatch(); else startStopwatch();
                    }
                });
            }

            // Line 3654: Initialize Contacts App Method
            initializeContactsApp(content) {
                const contactsList = content.querySelector('#contactsList');
                const addContactBtn = content.querySelector('#addContact');

                const renderContacts = () => {
                    contactsList.innerHTML = '';
                    if (this.contactList.length === 0) {
                        contactsList.innerHTML = '<div style="text-align: center; color: #999; padding: 2rem;">No contacts yet. Click "Add Contact" to get started.</div>';
                        return;
                    }

                    this.contactList.forEach((contact, index) => {
                        const contactEl = document.createElement('div');
                        contactEl.className = 'file-item';
                        contactEl.innerHTML = `
                            <div class="file-icon">ðŸ‘¤</div>
                            <div class="file-info">
                                <div class="file-name">${contact.name}</div>
                                <div class="file-details">${contact.phone} | ${contact.email}</div>
                            </div>
                            <button class="btn" data-action="edit" data-index="${index}">Edit</button>
                            <button class="btn" data-action="delete" data-index="${index}">Delete</button>
                        `;
                        contactsList.appendChild(contactEl);
                    });
                };

                addContactBtn.addEventListener('click', () => {
                    const name = prompt('Enter contact name:');
                    if (!name) return;
                    const phone = prompt('Enter contact phone:');
                    const email = prompt('Enter contact email:');

                    this.contactList.push({ name, phone: phone || '', email: email || '' });
                    this.saveContacts();
                    renderContacts();
                });

                contactsList.addEventListener('click', (e) => {
                    if (e.target.dataset.action === 'delete') {
                        const index = parseInt(e.target.dataset.index);
                        if (confirm('Are you sure you want to delete this contact?')) {
                            this.contactList.splice(index, 1);
                            this.saveContacts();
                            renderContacts();
                        }
                    } else if (e.target.dataset.action === 'edit') {
                        const index = parseInt(e.target.dataset.index);
                        const contact = this.contactList[index];
                        const newName = prompt('Edit name:', contact.name);
                        if (newName === null) return;
                        const newPhone = prompt('Edit phone:', contact.phone);
                        if (newPhone === null) return;
                        const newEmail = prompt('Edit email:', contact.email);
                        if (newEmail === null) return;

                        this.contactList[index] = { name: newName, phone: newPhone, email: newEmail };
                        this.saveContacts();
                        renderContacts();
                    }
                });

                renderContacts();
            }

            // Line 3710: Initialize Voice Recorder App Method
            initializeVoiceRecorderApp(content) {
                const startRecordBtn = content.querySelector('#startRecord');
                const stopRecordBtn = content.querySelector('#stopRecord');
                const playRecordBtn = content.querySelector('#playRecord');
                const recordingsList = content.querySelector('#recordingsList');

                // Initialize recordings array if not exists
                if (!this.recordings) {
                    this.recordings = this.loadRecordings();
                }

                // Load existing recordings
                this.renderRecordingsList(recordingsList);

                const handleStartRecord = async () => {
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });

                        // Check for MP3 support first
                        let mimeType;
                        let fileExtension;

                        if (MediaRecorder.isTypeSupported('audio/mp4;codecs=mp3')) {
                            mimeType = 'audio/mp4;codecs=mp3';
                            fileExtension = '.mp3';
                        } else if (MediaRecorder.isTypeSupported('audio/mpeg')) {
                            mimeType = 'audio/mpeg';
                            fileExtension = '.mp3';
                        } else if (MediaRecorder.isTypeSupported('audio/webm;codecs=opus')) {
                            mimeType = 'audio/webm;codecs=opus';
                            fileExtension = '.webm';
                        } else {
                            mimeType = 'audio/webm';
                            fileExtension = '.webm';
                        }

                        this.audioRecorder = new MediaRecorder(stream, { mimeType: mimeType });
                        this.audioChunks = [];
                        this.currentRecordingMimeType = mimeType;
                        this.currentRecordingExtension = fileExtension;

                        this.audioRecorder.ondataavailable = event => {
                            if (event.data.size > 0) {
                                this.audioChunks.push(event.data);
                            }
                        };

                        this.audioRecorder.onstop = () => {
                            this.audioBlob = new Blob(this.audioChunks, { type: mimeType });
                            this.saveRecording(this.audioBlob, mimeType, fileExtension);
                            this.renderRecordingsList(recordingsList);

                            // Stop all tracks to release microphone
                            stream.getTracks().forEach(track => track.stop());
                        };

                        this.audioRecorder.start();
                        startRecordBtn.disabled = true;
                        startRecordBtn.textContent = 'ðŸ”´ Recording...';
                        stopRecordBtn.disabled = false;
                        playRecordBtn.disabled = true;

                        this.showNotification('Recording started', 'info');
                    } catch (err) {
                        console.error('Error accessing microphone:', err);
                        this.showNotification('Could not access microphone. Please grant permission.', 'error');
                    }
                };

                const handleStopRecord = () => {
                    if (this.audioRecorder && this.audioRecorder.state !== 'inactive') {
                        this.audioRecorder.stop();
                        startRecordBtn.disabled = false;
                        startRecordBtn.textContent = 'ðŸ”´ Record';
                        stopRecordBtn.disabled = true;
                        playRecordBtn.disabled = false;

                        this.showNotification('Recording stopped', 'success');
                    }
                };

                const handlePlayRecord = () => {
                    if (this.audioBlob) {
                        this.playAudioBlob(this.audioBlob);
                    } else {
                        this.showNotification('No recording available', 'warning');
                    }
                };

                startRecordBtn.addEventListener('click', handleStartRecord);
                stopRecordBtn.addEventListener('click', handleStopRecord);
                playRecordBtn.addEventListener('click', handlePlayRecord);
            }

            // Save recording to storage and file system
            saveRecording(audioBlob, mimeType, fileExtension) {
                const recordingId = Date.now();
                const recordingData = {
                    id: recordingId,
                    blob: audioBlob,
                    timestamp: new Date().toISOString(),
                    name: `recording_${recordingId}${fileExtension}`, // Use determined extension
                    duration: '00:00', // Could be calculated if needed
                    size: audioBlob.size
                };

                // Convert blob to base64 for storage
                const reader = new FileReader();
                reader.onload = () => {
                    recordingData.dataURL = reader.result;

                    // Save to recordings array
                    if (!this.recordings) this.recordings = [];
                    this.recordings.unshift(recordingData);

                    // Keep only last 10 recordings to manage storage
                    if (this.recordings.length > 10) {
                        this.recordings.splice(10);
                    }

                    this.saveRecordings();

                    // Save to file system
                    this.saveRecordingToFileSystem(recordingData);
                };
                reader.readAsDataURL(audioBlob);
            }

            // Save recording to Documents folder
            saveRecordingToFileSystem(recordingData) {
                const documentsFolder = this.getDirectoryContents('/Documents');
                if (documentsFolder && documentsFolder.children) {
                    documentsFolder.children[recordingData.name] = {
                        type: 'file',
                        name: recordingData.name,
                        content: recordingData.dataURL,
                        size: recordingData.size,
                        created: recordingData.timestamp,
                        modified: recordingData.timestamp
                    };
                    documentsFolder.modified = recordingData.timestamp;
                    this.saveFileSystem();
                }
            }

            // Load recordings from storage
            loadRecordings() {
                const saved = localStorage.getItem('namchaos-recordings');
                return saved ? JSON.parse(saved) : [];
            }

            // Save recordings to storage
            saveRecordings() {
                localStorage.setItem('namchaos-recordings', JSON.stringify(this.recordings));
            }

            // Render recordings list
            renderRecordingsList(listElement) {
                if (!listElement) return;

                listElement.innerHTML = '<h4>Recordings</h4>';

                if (!this.recordings || this.recordings.length === 0) {
                    listElement.innerHTML += '<div style="text-align: center; color: #999; padding: 1rem;">No recordings yet</div>';
                    return;
                }

                this.recordings.forEach(recording => {
                    const recordingEl = document.createElement('div');
                    recordingEl.style.cssText = `
                        display: flex; align-items: center; justify-content: space-between;
                        padding: 0.75rem; background: rgba(255,255,255,0.1); border-radius: 12px; 
                        margin-bottom: 0.5rem; border: 1px solid rgba(255,255,255,0.2);
                    `;

                    recordingEl.innerHTML = `
                        <div style="color: white;">
                            <div style="font-weight: 500;">ðŸŽ™ï¸ ${recording.name}</div>
                            <div style="font-size: 0.8rem; opacity: 0.8;">
                                ${new Date(recording.timestamp).toLocaleString()} â€¢ ${this.formatFileSize(recording.size)}
                            </div>
                        </div>
                        <div>
                            <button class="btn btn-primary" onclick="namchaos.playRecordingById('${recording.id}')" style="margin-right: 0.5rem;">â–¶ï¸ Play</button>
                            <button class="btn" onclick="namchaos.downloadRecording('${recording.id}')">â¬‡ï¸</button>
                        </div>
                    `;

                    listElement.appendChild(recordingEl);
                });
            }

            // Play recording by ID
            playRecordingById(recordingId) {
                const recording = this.recordings.find(r => r.id.toString() === recordingId.toString());
                if (recording && recording.dataURL) {
                    // Convert data URL back to blob
                    fetch(recording.dataURL)
                        .then(res => res.blob())
                        .then(blob => this.playAudioBlob(blob))
                        .catch(err => {
                            console.error('Error playing recording:', err);
                            this.showNotification('Error playing recording', 'error');
                        });
                }
            }

            // Play audio blob with proper audio context
            playAudioBlob(audioBlob) {
                try {
                    // Create a temporary audio element for playback
                    const audio = document.createElement('audio');
                    audio.controls = false;
                    audio.volume = 0.8;

                    // Convert blob to base64 data URL for better compatibility
                    const reader = new FileReader();
                    reader.onload = () => {
                        audio.src = reader.result;

                        audio.onloadeddata = () => {
                            this.showNotification('Playing recording...', 'info');
                        };

                        audio.onended = () => {
                            this.showNotification('Playback finished', 'success');
                            audio.remove();
                        };

                        audio.onerror = (e) => {
                            console.error('Audio playback error:', e);
                            this.showNotification('Recording format not fully supported. Try using MP3 format.', 'warning');
                            audio.remove();
                        };

                        // Attempt to play with user interaction handling
                        const playPromise = audio.play();

                        if (playPromise !== undefined) {
                            playPromise
                                .then(() => {
                                    console.log('Audio playback started');
                                })
                                .catch(err => {
                                    console.error('Play failed:', err);
                                    if (err.name === 'NotAllowedError') {
                                        this.showNotification('Click anywhere to enable audio playback', 'info');
                                        // Add click handler to enable audio
                                        const enableAudio = () => {
                                            audio.play().catch(() => {
                                                this.showNotification('Audio playback not supported in this browser', 'error');
                                            });
                                            document.removeEventListener('click', enableAudio);
                                        };
                                        document.addEventListener('click', enableAudio, { once: true });
                                    } else {
                                        this.showNotification('Recording playback failed. WebM format may not be supported.', 'warning');
                                    }
                                    audio.remove();
                                });
                        }
                    };

                    reader.onerror = () => {
                        this.showNotification('Error reading audio data', 'error');
                    };

                    reader.readAsDataURL(audioBlob);

                } catch (error) {
                    console.error('Error creating audio:', error);
                    this.showNotification('Error playing recording', 'error');
                }
            }

            // Initialize Music App
            initializeMusicApp(content) {
                const importBtn = content.querySelector('#importMusicBtn');
                const fileInput = content.querySelector('#musicFileInput');
                const clearBtn = content.querySelector('#clearMusicBtn');
                const musicList = content.querySelector('#musicList');
                const musicPlayer = content.querySelector('#musicPlayer');
                const playPauseBtn = content.querySelector('#playPauseBtn');
                const prevBtn = content.querySelector('#prevBtn');
                const nextBtn = content.querySelector('#nextBtn');
                const volumeSlider = content.querySelector('#volumeSlider');
                const progressSlider = content.querySelector('#progressSlider');
                const currentSongTitle = content.querySelector('#currentSongTitle');
                const currentSongTime = content.querySelector('#currentSongTime');

                // Initialize music library
                if (!this.musicLibrary) {
                    this.musicLibrary = this.loadMusicLibrary();
                }

                this.currentAudio = null;
                this.currentSongIndex = -1;
                this.isPlaying = false;

                // Load existing music
                this.renderMusicLibrary(musicList);

                // Import music files
                if (importBtn && fileInput) {
                    importBtn.addEventListener('click', () => {
                        fileInput.click();
                    });

                    fileInput.addEventListener('change', (e) => {
                        const files = Array.from(e.target.files);
                        files.forEach(file => {
                            if (file.type.startsWith('audio/')) {
                                this.importMusicFile(file, musicList);
                            }
                        });
                        e.target.value = '';
                    });
                }

                // Clear music library
                if (clearBtn) {
                    clearBtn.addEventListener('click', () => {
                        if (confirm('Clear entire music library?')) {
                            this.musicLibrary = [];
                            this.saveMusicLibrary();
                            this.renderMusicLibrary(musicList);
                            if (musicPlayer) musicPlayer.style.display = 'none';
                        }
                    });
                }

                // Music player controls
                if (playPauseBtn) {
                    playPauseBtn.addEventListener('click', () => {
                        this.togglePlayPause();
                    });
                }

                if (prevBtn) {
                    prevBtn.addEventListener('click', () => {
                        this.playPreviousSong();
                    });
                }

                if (nextBtn) {
                    nextBtn.addEventListener('click', () => {
                        this.playNextSong();
                    });
                }

                if (volumeSlider) {
                    volumeSlider.addEventListener('input', (e) => {
                        if (this.currentAudio) {
                            this.currentAudio.volume = e.target.value / 100;
                        }
                    });
                }

                if (progressSlider) {
                    progressSlider.addEventListener('input', (e) => {
                        if (this.currentAudio) {
                            const time = (e.target.value / 100) * this.currentAudio.duration;
                            this.currentAudio.currentTime = time;
                        }
                    });
                }
            }

            // Import music file
            importMusicFile(file, musicList) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const musicData = {
                            id: Date.now() + Math.random(),
                            name: file.name,
                            size: file.size,
                            type: file.type,
                            dataURL: e.target.result,
                            dateAdded: new Date().toISOString()
                        };

                        this.musicLibrary.push(musicData);

                        // Limit library size to prevent quota issues
                        if (this.musicLibrary.length > 20) {
                            this.musicLibrary.splice(0, this.musicLibrary.length - 20);
                            this.showNotification('Music library limited to 20 songs to prevent storage issues', 'info');
                        }

                        this.saveMusicLibrary();
                        this.renderMusicLibrary(musicList);
                        this.showNotification(`Added "${file.name}" to music library`, 'success');
                    } catch (error) {
                        console.error('Error importing music:', error);
                        this.showNotification('Error importing music file. File may be too large.', 'error');
                    }
                };
                reader.readAsDataURL(file);
            }

            // Load music library from storage
            loadMusicLibrary() {
                try {
                    const saved = localStorage.getItem('namchaos-music-library');
                    return saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.error('Error loading music library:', error);
                    return [];
                }
            }

            // Save music library to storage
            saveMusicLibrary() {
                try {
                    localStorage.setItem('namchaos-music-library', JSON.stringify(this.musicLibrary));
                } catch (error) {
                    console.error('Error saving music library:', error);
                    if (error.name === 'QuotaExceededError') {
                        this.showNotification('Storage quota exceeded. Clear some music files.', 'error');
                        // Remove oldest songs to free space
                        this.musicLibrary.splice(0, Math.ceil(this.musicLibrary.length / 2));
                        this.saveMusicLibrary();
                    }
                }
            }

            // Render music library
            renderMusicLibrary(musicList) {
                if (!musicList) return;

                if (this.musicLibrary.length === 0) {
                    musicList.innerHTML = `
                        <div style="text-align: center; color: white; padding: 2rem;">
                            <div style="font-size: 4rem; margin-bottom: 1rem;">ðŸŽµ</div>
                            <h3 style="color: white;">Music Library</h3>
                            <p style="color: #ccc;">No music in your library</p>
                            <p style="color: #999; font-size: 0.9rem;">Click "Import Music" to add audio files</p>
                        </div>
                    `;
                    return;
                }

                let html = '';
                this.musicLibrary.forEach((song, index) => {
                    html += `
                        <div class="music-item" data-index="${index}" style="
                            display: flex; align-items: center; gap: 1rem; padding: 1rem;
                            background: var(--liquid-glass); backdrop-filter: blur(20px);
                            border-radius: 12px; cursor: pointer; transition: var(--transition);
                            border: 1px solid var(--glass-border);
                        " onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='var(--liquid-glass)'">
                            <div style="font-size: 2rem;">ðŸŽµ</div>
                            <div style="flex: 1; color: white;">
                                <div style="font-weight: 500; margin-bottom: 0.25rem;">${song.name}</div>
                                <div style="font-size: 0.8rem; opacity: 0.8;">
                                    ${this.formatFileSize(song.size)} â€¢ Added ${new Date(song.dateAdded).toLocaleDateString()}
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-primary" onclick="namchaos.playSong(${index})" style="padding: 0.5rem;">â–¶ï¸</button>
                                <button class="btn" onclick="namchaos.deleteSong(${index})" style="padding: 0.5rem;">ðŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });

                musicList.innerHTML = html;
            }

            // Play specific song
            playSong(index) {
                if (index < 0 || index >= this.musicLibrary.length) return;

                const song = this.musicLibrary[index];
                this.currentSongIndex = index;

                // Stop current audio if playing
                if (this.currentAudio) {
                    this.currentAudio.pause();
                    this.currentAudio = null;
                }

                // Create new audio element
                this.currentAudio = new Audio(song.dataURL);
                this.currentAudio.volume = 0.5;

                // Show music player
                const musicPlayer = document.querySelector('#musicPlayer');
                const currentSongTitle = document.querySelector('#currentSongTitle');
                const playPauseBtn = document.querySelector('#playPauseBtn');

                if (musicPlayer) musicPlayer.style.display = 'block';
                if (currentSongTitle) currentSongTitle.textContent = song.name;
                if (playPauseBtn) playPauseBtn.textContent = 'â¸ï¸';

                // Audio event listeners
                this.currentAudio.addEventListener('loadedmetadata', () => {
                    const progressSlider = document.querySelector('#progressSlider');
                    if (progressSlider) {
                        progressSlider.max = this.currentAudio.duration;
                    }
                });

                this.currentAudio.addEventListener('timeupdate', () => {
                    this.updatePlayerProgress();
                });

                this.currentAudio.addEventListener('ended', () => {
                    this.playNextSong();
                });

                // Play the song
                this.currentAudio.play().then(() => {
                    this.isPlaying = true;
                    this.showNotification(`Playing: ${song.name}`, 'info');
                }).catch(error => {
                    console.error('Playback error:', error);
                    this.showNotification('Error playing music file', 'error');
                });
            }

            // Toggle play/pause
            togglePlayPause() {
                if (!this.currentAudio) return;

                const playPauseBtn = document.querySelector('#playPauseBtn');

                if (this.isPlaying) {
                    this.currentAudio.pause();
                    this.isPlaying = false;
                    if (playPauseBtn) playPauseBtn.textContent = 'â–¶ï¸';
                } else {
                    this.currentAudio.play().then(() => {
                        this.isPlaying = true;
                        if (playPauseBtn) playPauseBtn.textContent = 'â¸ï¸';
                    }).catch(error => {
                        console.error('Playback error:', error);
                        this.showNotification('Error resuming playback', 'error');
                    });
                }
            }

            // Play next song
            playNextSong() {
                if (this.musicLibrary.length === 0) return;

                let nextIndex = this.currentSongIndex + 1;
                if (nextIndex >= this.musicLibrary.length) {
                    nextIndex = 0; // Loop back to first song
                }
                this.playSong(nextIndex);
            }

            // Play previous song
            playPreviousSong() {
                if (this.musicLibrary.length === 0) return;

                let prevIndex = this.currentSongIndex - 1;
                if (prevIndex < 0) {
                    prevIndex = this.musicLibrary.length - 1; // Loop to last song
                }
                this.playSong(prevIndex);
            }

            // Update player progress
            updatePlayerProgress() {
                if (!this.currentAudio) return;

                const progressSlider = document.querySelector('#progressSlider');
                const currentSongTime = document.querySelector('#currentSongTime');

                if (progressSlider && !progressSlider.matches(':active')) {
                    progressSlider.value = this.currentAudio.currentTime;
                }

                if (currentSongTime) {
                    const current = this.formatTime(this.currentAudio.currentTime);
                    const total = this.formatTime(this.currentAudio.duration || 0);
                    currentSongTime.textContent = `${current} / ${total}`;
                }
            }

            // Format time for display
            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }

            // Delete song from library
            deleteSong(index) {
                if (confirm('Delete this song from your library?')) {
                    // Stop if currently playing
                    if (index === this.currentSongIndex && this.currentAudio) {
                        this.currentAudio.pause();
                        this.currentAudio = null;
                        this.isPlaying = false;
                    }

                    this.musicLibrary.splice(index, 1);
                    this.saveMusicLibrary();

                    // Re-render music list
                    const musicList = document.querySelector('#musicList');
                    this.renderMusicLibrary(musicList);

                    // Hide player if no songs left
                    if (this.musicLibrary.length === 0) {
                        const musicPlayer = document.querySelector('#musicPlayer');
                        if (musicPlayer) musicPlayer.style.display = 'none';
                    }

                    this.showNotification('Song deleted from library', 'success');
                }
            }

            // Download recording
            downloadRecording(recordingId) {
                const recording = this.recordings.find(r => r.id.toString() === recordingId.toString());
                if (recording && recording.dataURL) {
                    const link = document.createElement('a');
                    link.href = recording.dataURL;
                    link.download = recording.name;
                    link.click();
                    this.showNotification('Recording downloaded', 'success');
                }
            }



            // Line 3773: Initialize Photos App Method
            initializePhotosApp(content) {
                const photosGallery = content.querySelector('#photosGallery');
                this.loadPhotosGallery(photosGallery);
            }

            // Load and display photos from Pictures folder
            loadPhotosGallery(galleryElement) {
                if (!galleryElement) return;

                const picturesFolder = this.getDirectoryContents('/C:/Users/User/Pictures');
                let photoCount = 0;
                let photosHtml = '';

                if (picturesFolder && picturesFolder.children) {
                    // Create a grid layout for photos
                    photosHtml = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; padding: 0.5rem;">';

                    for (const [fileName, file] of Object.entries(picturesFolder.children)) {
                        if (file.type === 'file' && fileName.includes('photo_') && file.content && file.content.startsWith('data:image/')) {
                            const photoData = {
                                id: fileName.replace(/[^0-9]/g, '') || Date.now() + photoCount,
                                dataURL: file.content,
                                timestamp: file.created,
                                name: fileName
                            };

                            photosHtml += `
                                <div style="
                                    background: white; 
                                    border-radius: 12px; 
                                    overflow: hidden; 
                                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                                    cursor: pointer;
                                    transition: transform 0.2s ease;
                                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'" onclick="namchaos.openPhotoViewer('${photoData.id}')">
                                    <img src="${file.content}" 
                                         style="width: 100%; height: 200px; object-fit: cover;" 
                                         alt="${fileName}"
                                         loading="lazy">
                                    <div style="padding: 0.75rem;">
                                        <div style="font-weight: 500; color: #333; font-size: 0.9rem; margin-bottom: 0.25rem;">${fileName}</div>
                                        <div style="font-size: 0.8rem; color: #666;">
                                            ${new Date(file.created).toLocaleDateString()}<br>
                                            ${this.formatFileSize(file.size || 0)}
                                        </div>
                                    </div>
                                </div>
                            `;
                            photoCount++;
                        }
                    }

                    photosHtml += '</div>';
                }

                if (photoCount === 0) {
                    galleryElement.innerHTML = `
                        <div style="text-align: center; color: white; padding: 3rem; height: 100%; display: flex; flex-direction: column; justify-content: center;">
                            <div style="font-size: 4rem; margin-bottom: 1rem;">ðŸ–¼ï¸</div>
                            <h3 style="color: white; margin-bottom: 1rem;">No Photos</h3>
                            <p style="color: #ccc; margin-bottom: 2rem;">Your photo library is empty. Take some photos to get started!</p>
                            <button class="btn btn-primary" onclick="namchaos.openApp('camera')" style="align-self: center;">Take Your First Photo</button>
                        </div>
                    `;
                } else {
                    galleryElement.innerHTML = `
                        <div style="margin-bottom: 1rem; color: white;">
                            <h4 style="margin: 0;">${photoCount} Photo${photoCount !== 1 ? 's' : ''}</h4>
                        </div>
                        ${photosHtml}
                    `;
                }
            }

            // Open photo viewer with photo ID
            openPhotoViewer(photoId) {
                const picturesFolder = this.getDirectoryContents('/C:/Users/User/Pictures');
                if (!picturesFolder || !picturesFolder.children) return;

                // Find the photo by ID
                let photoData = null;
                for (const [fileName, file] of Object.entries(picturesFolder.children)) {
                    if (fileName.includes('photo_') && file.content && file.content.startsWith('data:image/')) {
                        const id = fileName.replace(/[^0-9]/g, '') || Date.now();
                        if (id.toString() === photoId.toString()) {
                            photoData = {
                                id: id,
                                dataURL: file.content,
                                timestamp: file.created,
                                name: fileName,
                                size: file.size || 0
                            };
                            break;
                        }
                    }
                }

                if (!photoData) return;

                const viewer = document.createElement('div');
                viewer.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: rgba(0,0,0,0.95);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    backdrop-filter: blur(10px);
                `;

                viewer.innerHTML = `
                    <div style="text-align: center; color: white; max-width: 95vw; max-height: 95vh;">
                        <img src="${photoData.dataURL}" 
                             style="max-width: 90vw; max-height: 80vh; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.5);"
                             alt="${photoData.name}">
                        <div style="margin-top: 1rem; padding: 1rem;">
                            <h3 style="margin: 0 0 0.5rem 0; color: white;">${photoData.name}</h3>
                            <div style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 1rem;">
                                ðŸ“… ${new Date(photoData.timestamp).toLocaleString()}<br>
                                ðŸ“ ${this.formatFileSize(photoData.size)}
                            </div>
                            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                                <button style="background: var(--primary-blue); color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer;" onclick="this.parentElement.parentElement.parentElement.remove()">âœ• Close</button>
                                <button style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer;" onclick="namchaos.downloadPhoto('${photoData.dataURL}', '${photoData.name}')">â¬‡ï¸ Download</button>
                                <button style="background: #ff4757; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer;" onclick="namchaos.deletePhoto('${photoData.id}'); this.parentElement.parentElement.parentElement.remove();">ðŸ—‘ï¸ Delete</button>
                            </div>
                        </div>
                    </div>
                `;

                viewer.addEventListener('click', (e) => {
                    if (e.target === viewer) viewer.remove();
                });

                document.body.appendChild(viewer);
            }

            // Delete photo from Pictures folder
            deletePhoto(photoId) {
                if (!confirm('Are you sure you want to delete this photo?')) return;

                const picturesFolder = this.getDirectoryContents('/C:/Users/User/Pictures');
                if (!picturesFolder || !picturesFolder.children) return;

                // Find and delete the photo
                for (const [fileName, file] of Object.entries(picturesFolder.children)) {
                    if (fileName.includes('photo_') && file.content && file.content.startsWith('data:image/')) {
                        const id = fileName.replace(/[^0-9]/g, '') || Date.now();
                        if (id.toString() === photoId.toString()) {
                            delete picturesFolder.children[fileName];
                            picturesFolder.modified = new Date().toISOString();
                            this.saveFileSystem();

                            // Refresh photos app if open
                            const photosWindow = this.openWindows.get('photos');
                            if (photosWindow) {
                                const content = photosWindow.querySelector('.window-content');
                                if (content) {
                                    this.initializePhotosApp(content);
                                }
                            }

                            this.showNotification('Photo deleted successfully', 'success');
                            break;
                        }
                    }
                }
            }



            // Line 3833: Initialize Maps App Method
            initializeMapsApp(content) {
                const searchInput = content.querySelector('input[placeholder="Search for a place..."]');
                const searchBtn = content.querySelector('.toolbar button:not(#myLocation)');
                const myLocationBtn = content.querySelector('#myLocation');

                myLocationBtn.addEventListener('click', () => {
                    if (navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(
                            (position) => {
                                alert(`Your location: ${position.coords.latitude}, ${position.coords.longitude}`);
                            },
                            (error) => {
                                alert('Location access denied or unavailable');
                            }
                        );
                    } else {
                        alert('Geolocation is not supported by this browser');
                    }
                });

                searchBtn.addEventListener('click', () => {
                    const query = searchInput.value;
                    if (query) {
                        alert(`Searching for: ${query}`);
                    }
                });
            }

            // Line 3798: Make Draggable Method
            makeDraggable(element, handle) {
                handle.addEventListener('mousedown', (e) => {
                    // Don't start dragging if clicking on interactive elements
                    if (e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT' || e.target.tagName === 'CANVAS') {
                        return;
                    }

                    this.isDragging = true;
                    this.dragElement = element;
                    this.dragOffset.x = e.clientX - element.offsetLeft;
                    this.dragOffset.y = e.clientY - element.offsetTop;
                    element.style.zIndex = ++this.windowZIndex;
                    document.body.style.cursor = 'move';
                    e.preventDefault();
                    e.stopPropagation();
                });

                // Add touch support for mobile dragging
                handle.addEventListener('touchstart', (e) => {
                    // Don't start dragging if touching interactive elements
                    if (e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT' || e.target.tagName === 'CANVAS') {
                        return;
                    }

                    const touch = e.touches[0];
                    this.isDragging = true;
                    this.dragElement = element;
                    this.dragOffset.x = touch.clientX - element.offsetLeft;
                    this.dragOffset.y = touch.clientY - element.offsetTop;
                    element.style.zIndex = ++this.windowZIndex;
                    e.preventDefault();
                    e.stopPropagation();
                });
            }

            // Line 3810: Get App Icon Method
            getAppIcon(appName) {
                const icons = {
                    'files': 'appicons/files.jpeg',
                    'notes': 'ðŸ“',
                    'calculator': 'ðŸ§®',
                    'browser': 'ðŸŒ',
                    'settings': 'âš™ï¸',
                    'photos': 'ðŸ–¼ï¸',
                    'music': 'ðŸŽµ',
                    'camera': 'ðŸ“·',
                    'appstore': 'ðŸ›ï¸',
                    'downloader': 'â¬‡ï¸',
                    'terminal': 'ðŸ’»',
                    'paint': 'ðŸŽ¨',
                    'clock': 'ðŸ•',
                    'contacts': 'ðŸ‘¥',
                    'voice-recorder': 'ðŸŽ™ï¸',
                    'maps': 'ðŸ—ºï¸',
                    'mail': 'ðŸ“§',
                    'taskmanager': 'ðŸ“ˆ',
                    'nam-interpreter': 'ðŸ’»'
                };
                return icons[appName] || 'ðŸ“±';
            }

            // Line 3833: Close Window Method
            closeWindow(appName) {
                const window = this.openWindows.get(appName);
                if (window) {
                    window.remove();
                    this.openWindows.delete(appName);

                    // Remove process
                    const processIndex = this.runningProcesses.findIndex(p => p.appId === appName);
                    if (processIndex !== -1) {
                        const process = this.runningProcesses[processIndex];
                        this.systemResources.memory.used -= process.memory;
                        this.runningProcesses.splice(processIndex, 1);
                        this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;
                    }

                    const dockIcon = document.querySelector(`.dock-icon[data-app="${appName}"]`);
                    if (dockIcon) {
                        dockIcon.classList.remove('active');
                    }
                }
            }

            // Line 3823: Minimize Window Method
            minimizeWindow(appName) {
                const window = this.openWindows.get(appName);
                if (window) {
                    window.style.display = 'none';
                }
            }

            // Line 3831: Toggle Fullscreen Method
            toggleFullscreen(window) {
                window.classList.toggle('fullscreen');
            }

            // Line 3836: Toggle Start Menu Method
            toggleStartMenu() {
                const startMenu = document.getElementById('startMenu');
                startMenu.classList.toggle('show');
            }

            // Line 3842: Hide Start Menu Method
            hideStartMenu() {
                const startMenu = document.getElementById('startMenu');
                startMenu.classList.remove('show');
            }

            // Line 3848: Setup Swipe Gestures Method
            setupSwipeGestures() {
                let startY = 0;
                let currentY = 0;
                let isSwipeDown = false;

                document.addEventListener('touchstart', (e) => {
                    startY = e.touches[0].clientY;
                    isSwipeDown = startY < 100; // Only detect swipes from top area
                }, { passive: true });

                document.addEventListener('touchmove', (e) => {
                    if (!isSwipeDown) return;
                    currentY = e.touches[0].clientY;
                }, { passive: true });

                document.addEventListener('touchend', (e) => {
                    if (!isSwipeDown) return;

                    const deltaY = currentY - startY;

                    if (deltaY > 35) { // Swipe down threshold
                        this.showControlCenter();
                    }

                    isSwipeDown = false;
                    startY = 0;
                    currentY = 0;
                }, { passive: true });
            }

            // Line 3876: Show Control Center Method
            showControlCenter() {
                const controlCenter = document.getElementById('controlCenter');
                controlCenter.classList.add('show');
                this.hideStartMenu();
            }

            // Line 3883: Hide Control Center Method
            hideControlCenter() {
                const controlCenter = document.getElementById('controlCenter');
                controlCenter.classList.remove('show');
            }

            // Line 3889: Setup App Dragging Method
            setupAppDragging() {
                const homeScreen = document.getElementById('homeScreen');
                if (!homeScreen) return;

                homeScreen.addEventListener('mousedown', (e) => {
                    if (!this.isEditMode) return;
                    const appIcon = e.target.closest('.app-icon');
                    if (!appIcon) return;

                    e.preventDefault();
                    this.startDragApp(appIcon, e);
                });

                homeScreen.addEventListener('touchstart', (e) => {
                    if (!this.isEditMode) return;
                    const appIcon = e.target.closest('.app-icon');
                    if (!appIcon) return;

                    e.preventDefault();
                    const touch = e.touches[0];
                    this.startDragApp(appIcon, touch);
                }, { passive: false });
            }

            // Line 3910: Start Drag App Method
            startDragApp(appIcon, event) {
                this.draggedApp = appIcon.cloneNode(true);
                this.draggedApp.classList.add('dragging');

                // Create placeholder
                this.dragPlaceholder = document.createElement('div');
                this.dragPlaceholder.className = 'app-icon drag-placeholder';
                this.dragPlaceholder.style.width = appIcon.offsetWidth + 'px';
                this.dragPlaceholder.style.height = appIcon.offsetHeight + 'px';

                // Insert placeholder and hide original
                appIcon.parentNode.insertBefore(this.dragPlaceholder, appIcon);
                appIcon.style.opacity = '0';

                // Position dragged element
                this.draggedApp.style.left = (event.clientX - appIcon.offsetWidth / 2) + 'px';
                this.draggedApp.style.top = (event.clientY - appIcon.offsetHeight / 2) + 'px';

                document.body.appendChild(this.draggedApp);
                this.originalApp = appIcon;
            }

            // Line 3895: Setup Edit Mode Method
            setupEditMode() {
                const editToggle = document.getElementById('editModeToggle');
                editToggle.addEventListener('click', () => {
                    this.isEditMode = !this.isEditMode;
                    document.body.classList.toggle('edit-mode', this.isEditMode);
                    editToggle.classList.toggle('active', this.isEditMode);
                    editToggle.textContent = this.isEditMode ? 'Done' : 'Edit';
                });
            }

            // Line 3905: Drop App Method
            dropApp(event) {
                if (!this.draggedApp || !this.dragPlaceholder) return;

                const homeScreen = document.getElementById('homeScreen');
                const apps = Array.from(homeScreen.querySelectorAll('.app-icon:not(.drag-placeholder)'));

                // Find drop target
                let dropTarget = null;
                for (const app of apps) {
                    const rect = app.getBoundingClientRect();
                    if (event.clientX >= rect.left && event.clientX <= rect.right &&
                        event.clientY >= rect.top && event.clientY <= rect.bottom) {
                        dropTarget = app;
                        break;
                    }
                }

                // Perform the swap or reorder
                if (dropTarget && dropTarget !== this.originalApp) {
                    // Swap positions
                    const dropTargetParent = dropTarget.parentNode;
                    const dropTargetNext = dropTarget.nextSibling;
                    const originalNext = this.originalApp.nextSibling;

                    dropTargetParent.insertBefore(this.originalApp, dropTargetNext);
                    homeScreen.insertBefore(dropTarget, originalNext);
                }

                // Cleanup
                this.draggedApp.remove();
                this.dragPlaceholder.remove();
                this.originalApp.style.opacity = '';

                this.draggedApp = null;
                this.dragPlaceholder = null;
                this.originalApp = null;
            }

            // Line 3911: Handle Power Action Method
            handlePowerAction(action) {
                if (action === 'shutdown') {
                    if (confirm('Are you sure you want to shut down NamChaOS?')) {
                        this.showShutdownScreen();
                    }
                } else if (action === 'restart') {
                    if (confirm('Are you sure you want to restart NamChaOS?')) {
                        this.showRestartScreen();
                    }
                }
            }

            // Line 3925: Show Restart Screen Method
            showRestartScreen() {
                const restartScreen = document.getElementById('restartScreen');
                if (restartScreen) {
                    restartScreen.classList.remove('hidden');
                    setTimeout(() => {
                        location.reload();
                    }, 5000);
                }
            }

            // Line 3935: Show Shutdown Screen Method
            showShutdownScreen() {
                const shutdownScreen = document.getElementById('shutdownScreen');
                if (shutdownScreen) {
                    shutdownScreen.classList.remove('hidden');

                    // Add click/touch event to boot
                    const bootHandler = () => {
                        shutdownScreen.classList.add('hidden');
                        this.showBootScreen();
                        shutdownScreen.removeEventListener('click', bootHandler);
                        shutdownScreen.removeEventListener('touchstart', bootHandler);
                    };

                    shutdownScreen.addEventListener('click', bootHandler);
                    shutdownScreen.addEventListener('touchstart', bootHandler);
                }
            }

            // Line 3951: Show Boot Screen Method  
            showBootScreen() {
                const bootScreen = document.getElementById('bootScreen');
                const desktop = document.getElementById('desktop');
                const installScreen = document.getElementById('installScreen');

                if (bootScreen) {
                    bootScreen.classList.remove('hidden');
                    desktop.classList.add('hidden');
                    installScreen.classList.add('hidden');

                    setTimeout(() => {
                        if (this.isInstalled) {
                            if (this.lockScreenEnabled) {
                                this.showLockScreen();
                            } else {
                                this.showDesktop();
                            }
                        } else {
                            this.showInstallation();
                        }
                        bootScreen.classList.add('hidden');
                    }, 3000);
                }
            }

            // Line 3923: Toggle WiFi Method
            toggleWiFi() {
                const wifiControl = document.querySelector('.control-item[onclick="namchaos.toggleWiFi()"]');
                wifiControl.classList.toggle('active');
                const isActive = wifiControl.classList.contains('active');
                wifiControl.querySelector('.control-icon').textContent = isActive ? 'ðŸ“¶' : 'ðŸ“µ';
                console.log('WiFi', isActive ? 'enabled' : 'disabled');
            }

            // Line 3932: Toggle Bluetooth Method
            toggleBluetooth() {
                const bluetoothControl = document.querySelector('.control-item[onclick="namchaos.toggleBluetooth()"]');
                bluetoothControl.classList.toggle('active');
                const isActive = bluetoothControl.classList.contains('active');
                bluetoothControl.querySelector('.control-icon').textContent = isActive ? 'ðŸ”µ' : 'âš«';
                console.log('Bluetooth', isActive ? 'enabled' : 'disabled');
            }

            // Line 3941: Toggle Airplane Mode Method
            toggleAirplaneMode() {
                const airplaneControl = document.querySelector('.control-item[onclick="namchaos.toggleAirplaneMode()"]');
                airplaneControl.classList.toggle('active');
                const isActive = airplaneControl.classList.contains('active');
                console.log('Airplane mode', isActive ? 'enabled' : 'disabled');
            }

            // Line 3949: Toggle Dark Mode Method
            toggleDarkMode() {
                const darkModeControl = document.querySelector('.control-item[onclick="namchaos.toggleDarkMode()"]');
                darkModeControl.classList.toggle('active');
                document.body.classList.toggle('dark-mode');
                const isActive = document.body.classList.contains('dark-mode');
                console.log('Dark mode', isActive ? 'enabled' : 'disabled');
            }

            // Line 3958: Adjust Brightness Method
            adjustBrightness(value) {
                const brightness = value / 100;
                document.documentElement.style.filter = `brightness(${brightness})`;
                console.log('Brightness set to', value + '%');
            }

            // Line 3965: Adjust Volume Method
            adjustVolume(value) {
                console.log('Volume set to', value + '%');
                this.addNotification('Audio', `Volume set to ${value}%`, 'info');
            }

            // Line 3971: Toggle Hotspot Method
            toggleHotspot() {
                const hotspotControl = document.querySelector('.control-item[onclick="namchaos.toggleHotspot()"]');
                hotspotControl.classList.toggle('active');
                const isActive = hotspotControl.classList.contains('active');
                this.addNotification('Network', `Personal Hotspot ${isActive ? 'enabled' : 'disabled'}`, 'info');
            }

            // Line 3979: Toggle Auto Rotate Method
            toggleAutoRotate() {
                const rotateControl = document.querySelector('.control-item[onclick="namchaos.toggleAutoRotate()"]');
                rotateControl.classList.toggle('active');
                const isActive = rotateControl.classList.contains('active');
                this.addNotification('Display', `Auto-rotate ${isActive ? 'enabled' : 'disabled'}`, 'info');
            }

            // Line 3987: Toggle Do Not Disturb Method
            toggleDoNotDisturb() {
                const dndControl = document.querySelector('.control-item[onclick="namchaos.toggleDoNotDisturb()"]');
                dndControl.classList.toggle('active');
                const isActive = dndControl.classList.contains('active');
                dndControl.querySelector('.control-icon').textContent = isActive ? 'ðŸ”•' : 'ðŸ””';
                this.addNotification('Notifications', `Do Not Disturb ${isActive ? 'enabled' : 'disabled'}`, 'info');
            }

            // Line 3996: Toggle Flashlight Method
            toggleFlashlight() {
                const flashlightControl = document.querySelector('.control-item[onclick="namchaos.toggleFlashlight()"]');
                flashlightControl.classList.toggle('active');
                const isActive = flashlightControl.classList.contains('active');
                flashlightControl.querySelector('.control-icon').textContent = isActive ? 'ðŸ”¦' : 'ðŸ”…';
                this.addNotification('Tools', `Flashlight ${isActive ? 'on' : 'off'}`, 'info');
            }

            // Line 3965: Change Username Method
            changeUsername() {
                const input = document.getElementById('usernameInput');
                const newUsername = input.value.trim();
                if (newUsername) {
                    this.customSettings.username = newUsername;
                    this.saveCustomSettings();
                    document.getElementById('usernameDisplay').textContent = newUsername;
                    document.getElementById('currentUsername').textContent = newUsername;
                    localStorage.setItem('namchaos-username', newUsername);
                    alert('Username updated successfully!');
                }
            }

            // Line 3978: Change Background Method
            changeBackground() {
                const select = document.getElementById('backgroundSelect');
                const selectedBg = select.value;
                this.customSettings.background = selectedBg;
                this.saveCustomSettings();
                this.applyBackground(selectedBg);
                alert('Background applied successfully!');
            }

            // Line 3988: Apply Background Method
            applyBackground(bgType) {
                const backgrounds = {
                    'gradient1': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    'gradient2': 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                    'gradient3': 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
                    'gradient4': 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
                    'gradient5': 'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
                    'solid1': '#000000',
                    'solid2': '#1a1a2e'
                };

                const desktop = document.getElementById('desktop');
                if (desktop && backgrounds[bgType]) {
                    desktop.style.background = backgrounds[bgType];
                }
            }

            // Line 4005: Update Blur Intensity Method
            updateBlurIntensity(value) {
                document.documentElement.style.setProperty('--glass-blur', value + 'px');
                document.getElementById('blurValue').textContent = value + 'px';
            }

            // Line 4011: Update Glass Opacity Method
            updateGlassOpacity(value) {
                const opacity = value / 100;
                document.documentElement.style.setProperty('--liquid-glass', `rgba(255, 255, 255, ${opacity})`);
                document.getElementById('opacityValue').textContent = value + '%';
            }

            // Line 4018: Update Allowed Memory Method
            updateAllowedMemory(newMemory) {
                const oldMemory = this.allowedMemory;
                this.allowedMemory = parseInt(newMemory);

                // Update system resources
                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;

                // If reducing memory, check if current usage exceeds new limit
                if (this.systemResources.memory.used > this.allowedMemory) {
                    // Force close some non-critical processes to free memory
                    this.freeMemoryToLimit();
                }

                // Save the setting
                this.customSettings.allowedMemory = this.allowedMemory;
                this.saveCustomSettings();

                // Update any open task manager windows
                const taskManagerWindow = this.openWindows.get('taskmanager');
                if (taskManagerWindow) {
                    const content = taskManagerWindow.querySelector('.window-content');
                    if (content) {
                        this.updateTaskManagerDisplay(content);
                    }
                }

                alert(`Memory limit updated from ${oldMemory}MB to ${this.allowedMemory}MB`);
            }

            // Line 4044: Free Memory to Limit Method
            freeMemoryToLimit() {
                // Sort processes by memory usage (highest first) and close non-critical ones
                const nonCriticalProcesses = this.runningProcesses
                    .filter(p => !p.critical)
                    .sort((a, b) => b.memory - a.memory);

                while (this.systemResources.memory.used > this.allowedMemory && nonCriticalProcesses.length > 0) {
                    const processToKill = nonCriticalProcesses.shift();

                    // Close the app window if it's open
                    if (processToKill.appId && this.openWindows.has(processToKill.appId)) {
                        this.closeWindow(processToKill.appId);
                    }

                    // Remove from running processes
                    const processIndex = this.runningProcesses.findIndex(p => p.pid === processToKill.pid);
                    if (processIndex !== -1) {
                        this.runningProcesses.splice(processIndex, 1);
                        this.systemResources.memory.used -= processToKill.memory;
                    }
                }

                this.systemResources.memory.available = this.allowedMemory - this.systemResources.memory.used;
            }

            // Line 4068: Open Task Manager from Settings Method
            openTaskManagerFromSettings() {
                this.openApp('taskmanager');
            }

            // Line 4073: Trigger Update Method
            triggerUpdate() {
                document.getElementById('updateModal').classList.remove('hidden');
            }

            // Line 4023: Dismiss Update Method
            dismissUpdate() {
                document.getElementById('updateModal').classList.add('hidden');
            }

            // Line 4028: Install Update Method
            installUpdate() {
                alert('Update installation started. The system will restart when complete.');
                document.getElementById('updateModal').classList.add('hidden');
            }

            // Line 4034: Reset System Method
            resetSystem() {
                if (confirm('This will reset all settings and data. Are you sure?')) {
                    localStorage.clear();
                    location.reload();
                }
            }

            // Line 4080: Initialize Lock Screen Method
            initializeLockScreen() {
                const lockScreen = document.getElementById('lockScreen');
                const lockPasswordInput = document.getElementById('lockPasswordInput');
                const lockUnlockButton = document.getElementById('lockUnlockButton');
                const lockError = document.getElementById('lockError');

                // Update lock screen toggle in settings
                const lockToggle = document.getElementById('lockScreenToggle');
                if (lockToggle) {
                    lockToggle.checked = this.lockScreenEnabled;
                }

                // Set initial username
                const lockUsername = document.getElementById('lockUsername');
                if (lockUsername) {
                    lockUsername.textContent = this.customSettings.username || 'User';
                }

                const attemptUnlock = () => {
                    const password = lockPasswordInput.value;
                    if (password === this.systemPassword) {
                        this.hideLockScreen();
                        lockPasswordInput.value = '';
                        lockError.classList.add('hidden');
                    } else {
                        lockError.classList.remove('hidden');
                        lockPasswordInput.value = '';
                        lockPasswordInput.classList.add('shake');
                        setTimeout(() => lockPasswordInput.classList.remove('shake'), 500);
                    }
                };

                if (lockUnlockButton) {
                    lockUnlockButton.addEventListener('click', attemptUnlock);
                }

                if (lockPasswordInput) {
                    lockPasswordInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            attemptUnlock();
                        }
                    });
                }

                // Update lock screen time every second
                setInterval(() => {
                    this.updateLockScreenTime();
                }, 1000);
            }

            // Line 4130: Initialize Notification Center Method
            initializeNotificationCenter() {
                const notificationToggle = document.getElementById('notificationToggle');
                const notificationCenter = document.getElementById('notificationCenter');
                const clearAllButton = document.getElementById('clearAllNotifications');

                if (notificationToggle) {
                    notificationToggle.addEventListener('click', () => {
                        this.toggleNotificationCenter();
                    });
                }

                if (clearAllButton) {
                    clearAllButton.addEventListener('click', () => {
                        this.clearAllNotifications();
                    });
                }

                // Close notification center when clicking outside
                document.addEventListener('click', (e) => {
                    if (!notificationCenter.contains(e.target) && !notificationToggle.contains(e.target)) {
                        this.hideNotificationCenter();
                    }
                });
            }

            // Line 4160: Show Lock Screen Method
            showLockScreen() {
                const lockScreen = document.getElementById('lockScreen');
                if (lockScreen) {
                    lockScreen.classList.remove('hidden');
                    this.isLocked = true;
                    this.updateLockScreenTime();
                }
            }

            // Line 4170: Hide Lock Screen Method
            hideLockScreen() {
                const lockScreen = document.getElementById('lockScreen');
                if (lockScreen) {
                    lockScreen.classList.add('hidden');
                    this.isLocked = false;
                    if (this.isInstalled) {
                        this.showDesktop();
                    }
                }
            }

            // Line 4182: Update Lock Screen Time Method
            updateLockScreenTime() {
                const lockTime = document.getElementById('lockTime');
                const lockDate = document.getElementById('lockDate');

                if (lockTime && lockDate) {
                    const now = new Date();
                    lockTime.textContent = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    lockDate.textContent = now.toLocaleDateString([], { weekday: 'long', month: 'long', day: 'numeric' });
                }
            }

            // Line 4194: Toggle Lock Screen Method
            toggleLockScreen(enabled) {
                this.lockScreenEnabled = enabled;
                localStorage.setItem('namchaos-lock-enabled', enabled.toString());

                if (enabled) {
                    this.addNotification('Security', 'Lock screen enabled', 'info');
                } else {
                    this.addNotification('Security', 'Lock screen disabled', 'info');
                }
            }

            // Line 4205: Change Password Method
            changePassword() {
                const newPasswordInput = document.getElementById('newPasswordInput');
                if (newPasswordInput && newPasswordInput.value.trim()) {
                    this.systemPassword = newPasswordInput.value.trim();
                    localStorage.setItem('namchaos-password', this.systemPassword);
                    newPasswordInput.value = '';
                    this.addNotification('Security', 'Password changed successfully', 'success');
                }
            }

            // Line 4216: Lock Now Method
            lockNow() {
                if (this.lockScreenEnabled) {
                    this.showLockScreen();
                } else {
                    this.addNotification('Security', 'Lock screen is disabled. Enable it in settings first.', 'warning');
                }
            }

            // Line 4225: Toggle Notification Center Method
            toggleNotificationCenter() {
                const notificationCenter = document.getElementById('notificationCenter');
                if (notificationCenter) {
                    notificationCenter.classList.toggle('show');
                }
            }

            // Line 4233: Hide Notification Center Method
            hideNotificationCenter() {
                const notificationCenter = document.getElementById('notificationCenter');
                if (notificationCenter) {
                    notificationCenter.classList.remove('show');
                }
            }

            // Line 4241: Add Notification Method
            addNotification(title, message, type = 'info') {
                const notification = {
                    id: Date.now(),
                    title: title,
                    message: message,
                    type: type,
                    time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                };

                this.notifications.unshift(notification);

                // Keep only last 50 notifications
                if (this.notifications.length > 50) {
                    this.notifications.splice(50);
                }

                this.updateNotificationCenter();
                this.showNotificationToast(notification);
                this.updateNotificationBadge();
            }

            // Line 4261: Update Notification Center Method
            updateNotificationCenter() {
                const notificationList = document.getElementById('notificationList');
                if (!notificationList) return;

                if (this.notifications.length === 0) {
                    notificationList.innerHTML = '<div class="no-notifications">No notifications</div>';
                    return;
                }

                let html = '';
                this.notifications.forEach(notification => {
                    html += `
                        <div class="notification-item">
                            <div class="notification-title">${notification.title}</div>
                            <div class="notification-message">${notification.message}</div>
                            <div class="notification-time">${notification.time}</div>
                        </div>
                    `;
                });

                notificationList.innerHTML = html;
            }

            // Line 4283: Show Notification Toast Method
            showNotificationToast(notification) {
                const toast = document.createElement('div');
                toast.className = `notification-toast ${notification.type}`;
                toast.innerHTML = `
                    <div style="font-weight: 600; margin-bottom: 0.25rem;">${notification.title}</div>
                    <div style="font-size: 0.9rem;">${notification.message}</div>
                `;

                document.body.appendChild(toast);

                setTimeout(() => {
                    toast.style.animation = 'slideOutRight 0.3s ease';
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                }, 4000);
            }

            // Line 4303: Update Notification Badge Method
            updateNotificationBadge() {
                const notificationToggle = document.getElementById('notificationToggle');
                if (notificationToggle) {
                    const unreadCount = this.notifications.length;
                    if (unreadCount > 0) {
                        notificationToggle.textContent = `ðŸ””(${unreadCount > 99 ? '99+' : unreadCount})`;
                    } else {
                        notificationToggle.textContent = 'ðŸ””';
                    }
                }
            }

            // Line 4315: Clear All Notifications Method
            clearAllNotifications() {
                this.notifications = [];
                this.updateNotificationCenter();
                this.updateNotificationBadge();
            }

            // Line 4322: Launch NcApp Method
            launchNcApp(appConfig) {
                try {
                    // Create a custom app based on the .ncapp configuration
                    const appId = appConfig.appId || appConfig.name || `ncapp-${Date.now()}`;
                    const appTitle = appConfig.title || appConfig.name || 'Custom App';
                    const appIcon = appConfig.icon || 'ðŸ“±';

                    // Generate app content based on configuration
                    let appContent = '';

                    if (appConfig.type === 'web') {
                        // Web-based app
                        appContent = `
                            <div style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                                <div style="padding: 10px; background: #f5f5f5; border-bottom: 1px solid #ddd;">
                                    <strong>${appIcon} ${appTitle}</strong>
                                    <span style="float: right; font-size: 0.8rem; color: #666;">.ncapp</span>
                                </div>
                                <iframe src="${appConfig.url || 'about:blank'}" 
                                        style="flex: 1; border: none; width: 100%;" 
                                        sandbox="allow-scripts allow-same-origin allow-forms allow-popups">
                                </iframe>
                            </div>
                        `;
                    } else if (appConfig.type === 'text') {
                        // Text-based app
                        appContent = `
                            <div style="padding: 20px; height: 100%; overflow-y: auto; background: white;">
                                <div style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 20px;">
                                    <h2 style="margin: 0; display: flex; align-items: center; gap: 10px;">
                                        <span>${appIcon}</span>
                                        ${appTitle}
                                        <span style="font-size: 0.6em; background: #007AFF; color: white; padding: 2px 6px; border-radius: 4px;">.ncapp</span>
                                    </h2>
                                    ${appConfig.description ? `<p style="margin: 5px 0 0 0; color: #666;">${appConfig.description}</p>` : ''}
                                </div>
                                <div style="white-space: pre-wrap; font-family: system-ui; line-height: 1.6;">${appConfig.content || 'No content available.'}</div>
                            </div>
                        `;
                    } else if (appConfig.type === 'html') {
                        // HTML content app
                        appContent = `
                            <div style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                                <div style="padding: 10px; background: #f5f5f5; border-bottom: 1px solid #ddd;">
                                    <strong>${appIcon} ${appTitle}</strong>
                                    <span style="float: right; font-size: 0.8rem; color: #666;">.ncapp (HTML)</span>
                                </div>
                                <div style="flex: 1; overflow: hidden;">
                                    ${appConfig.content || '<p style="padding: 20px;">No HTML content available.</p>'}
                                </div>
                            </div>
                        `;
                    } else {
                        // Default app layout
                        appContent = `
                            <div style="padding: 20px; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center; background: white;">
                                <div style="font-size: 4rem; margin-bottom: 20px;">${appIcon}</div>
                                <h2 style="margin: 0 0 10px 0;">${appTitle}</h2>
                                <p style="color: #666; margin: 0 0 20px 0;">${appConfig.description || 'Custom NamChaOS Application'}</p>
                                <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; font-size: 0.9rem; color: #666;">
                                    <strong>App Type:</strong> ${appConfig.type || 'default'}<br>
                                    <strong>Version:</strong> ${appConfig.version || '1.0'}<br>
                                    <strong>Format:</strong> .ncapp
                                </div>
                            </div>
                        `;
                    }

                    this.openApp(appId, appTitle, appContent);
                    this.showNotification(`Launched ${appTitle}`, 'success');

                    // Add process for the launched app
                    this.addProcess(appTitle, appId, appIcon, 64);

                } catch (error) {
                    this.showNotification('Error launching .ncapp file', 'error');
                    console.error('NcApp launch error:', error);
                }
            }

            // Line 4089: Get App Title Method
            getAppTitle(appName) {
                const titles = {
                    'files': 'File Manager',
                    'notes': 'Notes',
                    'calculator': 'Calculator',
                    'browser': 'Safari',
                    'settings': 'System Preferences',
                    'photos': 'Photos',
                    'music': 'Music',
                    'camera': 'Camera',
                    'appstore': 'App Store',
                    'downloader': 'Download Manager',
                    'terminal': 'Terminal',
                    'paint': 'Paint',
                    'clock': 'Clock',
                    'contacts': 'Contacts',
                    'voice-recorder': 'Voice Recorder',
                    'maps': 'Maps',
                    'mail': 'Mail',
                    'taskmanager': 'Task Manager',
                    'nam-interpreter': 'NAM Interpreter',
                    'mytube': 'MyTube',
                    'admin': 'Admin Panel'
                };
                return titles[appName] || appName;
            }

            // Add NAM Interpreter app content
            initializeNamInterpreterApp(content) {
                content.innerHTML = `
                    <div style="height: 100%; display: flex; flex-direction: column;">
                        <div class="toolbar">
                            <h3 style="margin: 0; color: var(--text-primary);">NAM Interpreter</h3>
                            <button class="btn" id="namOpenFile">Open .nam</button>
                            <button class="btn" id="namOpenNcapp">Open .ncapp</button>
                            <button class="btn btn-primary" id="namSaveNcapp">Save as .ncapp</button>
                            <button class="btn" id="namRun">Run</button>
                        </div>
                        <div style="flex: 1; display: flex;">
                            <div style="flex: 1; display: flex; flex-direction: column; border-right: 1px solid #ddd;">
                                <div style="padding: 0.5rem; background: #f5f5f5; border-bottom: 1px solid #ddd; font-weight: 600;">NAM Code Editor</div>
                                <textarea id="namCodeEditor" style="flex: 1; border: none; padding: 1rem; font-family: 'Courier New', monospace; font-size: 14px; resize: none; outline: none;" placeholder="// Enter your NAM code here
// Example:
app MyApp {
    title: 'My Custom App'
    icon: 'ðŸš€'
    type: 'text'
    content: 'Hello from NAM!'
}"></textarea>
                            </div>
                            <div style="flex: 1; display: flex; flex-direction: column; background: #000; color: #00ff00; font-family: 'Courier New', monospace;">
                                <div style="padding: 0.5rem; background: #333; border-bottom: 1px solid #555; color: white; font-weight: 600;">Output Console</div>
                                <div style="flex: 1; padding: 1rem; overflow-y: auto;">
                                    <div id="namOutput">NAM Interpreter v1.0 - Ready<br><br></div>
                                    <div style="display: flex;">
                                        <span>> </span>
                                        <input type="text" id="namInput" style="flex: 1; background: transparent; border: none; outline: none; color: inherit; font-family: inherit;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                const namInput = content.querySelector('#namInput');
                const namOutput = content.querySelector('#namOutput');
                const namCodeEditor = content.querySelector('#namCodeEditor');
                const namOpenFile = content.querySelector('#namOpenFile');
                const namOpenNcapp = content.querySelector('#namOpenNcapp');
                const namSaveNcapp = content.querySelector('#namSaveNcapp');
                const namRun = content.querySelector('#namRun');

                // Command input handler
                if (namInput) {
                    namInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            const command = namInput.value;
                            namOutput.innerHTML += `<div>$ ${command.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</div>`;
                            this.executeNamCommand(command, namOutput);
                            namInput.value = '';
                            namOutput.scrollTop = namOutput.scrollHeight;
                        }
                    });
                }

                // Open .nam file
                if (namOpenFile) {
                    namOpenFile.addEventListener('click', () => {
                        const fileName = prompt('Enter .nam file name to open:');
                        if (fileName) {
                            const fileContent = this.getFileContent('/Documents', fileName);
                            if (fileContent !== '') {
                                namCodeEditor.value = fileContent;
                                namOutput.innerHTML += `<div>Loaded ${fileName}</div><br>`;
                            } else {
                                namOutput.innerHTML += `<div>Error: File ${fileName} not found</div><br>`;
                            }
                            namOutput.scrollTop = namOutput.scrollHeight;
                        }
                    });
                }

                // Open .ncapp file
                if (namOpenNcapp) {
                    namOpenNcapp.addEventListener('click', () => {
                        const fileName = prompt('Enter .ncapp file name to open:');
                        if (fileName) {
                            const fileContent = this.getFileContent('/Documents', fileName);
                            if (fileContent !== '') {
                                try {
                                    const appConfig = JSON.parse(fileContent);
                                    // Convert .ncapp back to NAM code (simplified)
                                    const namCode = `app ${appConfig.name || 'MyApp'} {
    title: '${appConfig.title || appConfig.name || 'My App'}'
    icon: '${appConfig.icon || 'ðŸ“±'}'
    type: '${appConfig.type || 'text'}'
    description: '${appConfig.description || ''}'
    content: '${(appConfig.content || '').replace(/'/g, "\\'")}'
}`;
                                    namCodeEditor.value = namCode;
                                    namOutput.innerHTML += `<div>Loaded ${fileName} and converted to NAM code</div><br>`;
                                } catch (error) {
                                    namOutput.innerHTML += `<div>Error: Invalid .ncapp file format</div><br>`;
                                }
                            } else {
                                namOutput.innerHTML += `<div>Error: File ${fileName} not found</div><br>`;
                            }
                            namOutput.scrollTop = namOutput.scrollHeight;
                        }
                    });
                }

                // Save as .ncapp
                if (namSaveNcapp) {
                    namSaveNcapp.addEventListener('click', () => {
                        const fileName = prompt('Enter .ncapp file name to save:');
                        if (fileName) {
                            const namCode = namCodeEditor.value;
                            const appConfig = this.parseNamCode(namCode);
                            if (appConfig) {
                                this.saveFileContent('/Documents', fileName.endsWith('.ncapp') ? fileName : fileName + '.ncapp', JSON.stringify(appConfig, null, 2));
                                namOutput.innerHTML += `<div>Saved ${fileName} as .ncapp file</div><br>`;
                            } else {
                                namOutput.innerHTML += `<div>Error: Invalid NAM code syntax</div><br>`;
                            }
                            namOutput.scrollTop = namOutput.scrollHeight;
                        }
                    });
                }

                // Run NAM code
                if (namRun) {
                    namRun.addEventListener('click', () => {
                        const namCode = namCodeEditor.value;
                        const appConfig = this.parseNamCode(namCode);
                        if (appConfig) {
                            namOutput.innerHTML += `<div>Compiling and running NAM code...</div><br>`;
                            setTimeout(() => {
                                this.launchNcApp(appConfig);
                                namOutput.innerHTML += `<div>Successfully launched ${appConfig.title || appConfig.name}</div><br>`;
                                namOutput.scrollTop = namOutput.scrollHeight;
                            }, 1000);
                        } else {
                            namOutput.innerHTML += `<div>Error: Invalid NAM code syntax</div><br>`;
                            namOutput.scrollTop = namOutput.scrollHeight;
                        }
                    });
                }
            }

            // Execute NAM command
            executeNamCommand(command, output) {
                const args = command.trim().split(' ');
                const cmd = args[0];

                switch (cmd) {
                    case 'help':
                        output.innerHTML += `NAM Interpreter Commands:
â€¢ help - Show this help
â€¢ clear - Clear console
â€¢ version - Show NAM version
â€¢ compile [code] - Compile NAM code
â€¢ run - Run current code in editor
â€¢ save [filename] - Save current code as .nam file
â€¢ load [filename] - Load .nam file into editor<br><br>`;
                        break;

                    case 'clear':
                        output.innerHTML = 'NAM Interpreter v1.0 - Ready<br><br>';
                        break;

                    case 'version':
                        output.innerHTML += 'NAM Language v1.0 - NamChaOS App Builder<br><br>';
                        break;

                    case 'compile':
                        output.innerHTML += 'Compiling NAM code... Use the Run button to execute.<br><br>';
                        break;

                    case 'run':
                        output.innerHTML += 'Use the Run button to execute NAM code.<br><br>';
                        break;

                    default:
                        if (command.trim()) {
                            output.innerHTML += `Unknown command: ${command}<br>Type 'help' for available commands.<br><br>`;
                        }
                        break;
                }
            }

            // Parse NAM code
            parseNamCode(namCode) {
                try {
                    // NAM parser
                    const appMatch = namCode.match(/app\s+(\w+)\s*\{([^}]+)\}/);
                    if (!appMatch) return null;

                    const appName = appMatch[1];
                    const appBody = appMatch[2];

                    const config = {
                        appId: appName.toLowerCase(),
                        name: appName
                    };

                    // Parse properties
                    const titleMatch = appBody.match(/title:\s*['"]([^'"]+)['"]/);
                    if (titleMatch) config.title = titleMatch[1];

                    const iconMatch = appBody.match(/icon:\s*['"]([^'"]+)['"]/);
                    if (iconMatch) config.icon = iconMatch[1];

                    const typeMatch = appBody.match(/type:\s*['"]([^'"]+)['"]/);
                    if (typeMatch) config.type = typeMatch[1];

                    const descMatch = appBody.match(/description:\s*['"]([^'"]+)['"]/);
                    if (descMatch) config.description = descMatch[1];

                    const contentMatch = appBody.match(/content:\s*['"]([^'"]+)['"]/);
                    if (contentMatch) config.content = contentMatch[1].replace(/\\'/g, "'");

                    const urlMatch = appBody.match(/url:\s*['"]([^'"]+)['"]/);
                    if (urlMatch) config.url = urlMatch[1];

                    return config;
                } catch (error) {
                    return null;
                }
            }
        }

        // Line 4110: Initialize NamChaOS 
        const namchaos = new NamChaOS();

        // Line 4113: Window Resize Handler
        window.addEventListener('resize', () => {
            namchaos.deviceType = namchaos.detectDevice();
            namchaos.updateDeviceInfo();
        });

        // Line 4119: Battery Simulation 
        setInterval(() => {
            const batteryElement = document.getElementById('batteryLevel');
            if (batteryElement && namchaos.deviceType !== 'Desktop') {
                // Simulate battery percentage, decreasing over time
                let currentBattery = parseInt(batteryElement.textContent.replace('%', '')) || 100;
                currentBattery = Math.max(0, currentBattery - 1); // Decrease by 1%
                batteryElement.textContent = `${currentBattery}%`;
            }
        }, 600000);
    </script>
</body>
</html>